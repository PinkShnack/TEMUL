

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API documentation &mdash; TEMUL Toolkit v0.1-alpha documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Masked FFT and iFFT" href="masked_fft_tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TEMUL Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                Version 0.1-alpha
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_temul.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html">Plotting Polarisation and Movement Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_map_tutorial.html">Plot Lattice Structure Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="masked_fft_tutorial.html">Masked FFT and iFFT</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-refiner">Model Refiner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.polarisation">Polarisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.element_tools">Element Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.intensity_tools">Intensity Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.model_creation">Model Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#image-simulation-functions">Image Simulation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_processing">Signal Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_plotting">Signal Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.io">Input/Output (io)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.dummy_data">Dummy Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.example_data">Example Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TEMUL Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<span id="api-doc"></span><h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-refiner">
<h3>Model Refiner<a class="headerlink" href="#model-refiner" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-temul.polarisation">
<span id="polarisation"></span><h3>Polarisation<a class="headerlink" href="#module-temul.polarisation" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.polarisation.angle_label">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">angle_label</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vector_rep</span><span class="o">=</span><span class="default_value">'magnitude'</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.angle_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.polarisation.atom_deviation_from_straight_line_fit">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">atom_deviation_from_straight_line_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">axis_number</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">save</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.atom_deviation_from_straight_line_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the atoms in an atom plane to a straight line and find the deviation
of each atom position from that straight line fit.
To plot all zones see <cite>plot_atom_deviation_from_all_zone_axes()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>axis_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The index of the zone axis (translation symmetry) found by the Atomap
function <cite>construct_zone_axes()</cite>.</p></li>
<li><p><strong>save</strong> (<em>string</em><em>, </em><em>default ''</em>) – If set to <cite>save=None</cite>, the array will not be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Four lists</strong> (<em>x, y, u, and v where x,y are the original atom position</em>)</p></li>
<li><p><em>coordinates (simply sublattice.x_position, sublattice.y_position) and</em></p></li>
<li><p><em>u,v are the polarisation vector components pointing to the new coordinate.</em></p></li>
<li><p>These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">atom_deviation_from_straight_line_fit</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">plot_polarisation_vectors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">atom_deviation_from_straight_line_fit</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.atom_to_atom_distance_grouped_mean">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">atom_to_atom_distance_grouped_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">zone_axis_index</span></em>, <em class="sig-param"><span class="n">aggregation_axis</span><span class="o">=</span><span class="default_value">'y'</span></em>, <em class="sig-param"><span class="n">slice_thickness</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.atom_to_atom_distance_grouped_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Average the atom to atom distances along the chosen zone_axis_index
parallel to the chosen axis (‘x’ or ‘y’).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axes you wish to average along.</p></li>
<li><p><strong>aggregation_axis</strong> (<em>string</em><em>, </em><em>default &quot;y&quot;</em>) – Axis parallel to which the atom to atom distances will be averaged.</p></li>
<li><p><strong>slice_thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 10</em>) – thickness of the slices used for aggregation.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Slice thickness groupings and means of each grouping. Groupings can be</em></p></li>
<li><p><em>thought of as bins in a histogram of grouped means.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">atomap.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">atom_to_atom_distance_grouped_mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">get_distorted_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">(</span><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupings</span><span class="p">,</span> <span class="n">grouped_means</span> <span class="o">=</span> <span class="n">atom_to_atom_distance_grouped_mean</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then plot these as below:
plt.figure()
plt.plot(groupings, grouped_means, ‘k.’)
plt.show()</p>
<p>Average parallel to the x axis instead:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">groupings</span><span class="p">,</span> <span class="n">grouped_means</span> <span class="o">=</span> <span class="n">atom_to_atom_distance_grouped_mean</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then plot these as below:
plt.figure()
plt.plot(groupings, grouped_means, ‘k.’)
plt.show()</p>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.combine_atom_deviations_from_zone_axes">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">combine_atom_deviations_from_zone_axes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">axes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">plot_style</span><span class="o">=</span><span class="default_value">'vector'</span></em>, <em class="sig-param"><span class="n">overlay</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">unit_vector</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">'atom_deviation'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'yellow'</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pivot</span><span class="o">=</span><span class="default_value">'middle'</span></em>, <em class="sig-param"><span class="n">angles</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale_units</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">headwidth</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">headlength</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">headaxislength</span><span class="o">=</span><span class="default_value">4.5</span></em>, <em class="sig-param"><span class="n">monitor_dpi</span><span class="o">=</span><span class="default_value">96</span></em>, <em class="sig-param"><span class="n">no_axis_info</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">scalebar</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.combine_atom_deviations_from_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the atom deviations of each atom for all zone axes.
Good for plotting vortexes and seeing the total deviation from a
perfect structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>the remaining parameters see plot_polarisation_vectors</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>For</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Four lists</strong> (<em>x, y, u, and v where x,y are the original atom position</em>)</p></li>
<li><p><em>coordinates (simply sublattice.x_position, sublattice.y_position) and</em></p></li>
<li><p><em>u,v are the polarisation vector components pointing to the new coordinate.</em></p></li>
<li><p>These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">plot_polarisation_vectors</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also choose the axes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.delete_atom_planes_from_sublattice">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">delete_atom_planes_from_sublattice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">zone_axis_index</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">divisible_by</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">offset_from_zero</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">opposite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.delete_atom_planes_from_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete atom_planes from a zone axis. Can choose whether to delete
every second, third etc. atom plane, and the offset from the zero index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The zone axis you wish to specify. You are indexing
sublattice.zones_axis_average_distances[zone_axis_index]</p></li>
<li><p><strong>atom_plane_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.5</em>) – float between 0.0 and 1.0. Closer to 1 means it will find more zones.
See sublattice.construct_zone_axes() for more information.</p></li>
<li><p><strong>divisible_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – If divisible_by is 2, every second atom_plane is deleted,
If divisible_by is 4, every fourth atom_plane is deleted, etc.</p></li>
<li><p><strong>offset_from_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The atom_plane from which you start deleting.
If offset_from_zero is 4, the fourth atom_plane will be
the first deleted.</p></li>
<li><p><strong>opposite</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the atom_plane specified by divisible_by
will be kept and all others deleted.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">delete_atom_planes_from_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zone_vec_list</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_all_atom_planes_by_zone_vector</span><span class="p">(</span><span class="n">zone_vec_list</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_atom_planes_from_sublattice</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">zone_axis_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">divisible_by</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset_from_zero</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_all_atom_planes_by_zone_vector</span><span class="p">(</span><span class="n">zone_vec_list</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.find_polarisation_vectors">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">find_polarisation_vectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom_positions_A</span></em>, <em class="sig-param"><span class="n">atom_positions_B</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.find_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the vectors from atom_positions_A to atom_positions_B.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_positions_A</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Atom positions list in the form [[x1,y1], [x2,y2], [x3,y3]…].</p></li>
<li><p><strong>atom_positions_B</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Atom positions list in the form [[x1,y1], [x2,y2], [x3,y3]…].</p></li>
<li><p><strong>save</strong> (<em>string</em><em>, </em><em>default None</em>) – If set to a string, the array will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>two lists</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>u and v components of the vector from A to B</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">find_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_B</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find_polarisation_vectors</span><span class="p">(</span><span class="n">pos_A</span><span class="p">,</span> <span class="n">pos_B</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>convert to the [[u1,v1], [u2,v2], [u3,v3]…] format</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_angles_from_uv">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_angles_from_uv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">angle_offset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_angles_from_uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the angle of a vector given the uv components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </p></li>
<li><p><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change between degrees and radian. Default is radian.</p></li>
<li><p><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Rotate the angles by the given amount. The function assumes that if you
set <cite>degrees=False</cite> then the provided <cite>angle_offset</cite> is in radians, and
if you set <cite>degrees=True</cite> then the provided <cite>angle_offset</cite> is in
degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D NumPy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_average_polarisation_in_regions">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_average_polarisation_in_regions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">divide_into</span><span class="o">=</span><span class="default_value">8</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_average_polarisation_in_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>This function splits the image into the given number of regions and
averages the polarisation of each region.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>image</strong> (<em>2D NumPy array</em>) – </p></li>
<li><p><strong>divide_into</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – The number used to divide the image up. If 8, then the image will be
split into an 8x8 grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Four lists</strong> (<em>x_new, y_new, u_new, v_new.</em>)</p></li>
<li><p><em>x_new and y_new are the central coordinates of the divided regions.</em></p></li>
<li><p><em>u_new and v_new are the averaged polarisation vectors.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">plot_polarisation_vectors</span><span class="p">,</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
</pre></div>
</div>
<p>Get and plot the original polarisation vectors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Actual Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Get and plot the new, averaged polarisation vectors</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">divide_into</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Vector Arrows&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_average_polarisation_in_regions_square">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_average_polarisation_in_regions_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">divide_into</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_average_polarisation_in_regions_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <cite>get_average_polarisation_in_regions()</cite> but works for non-square
(rectangular) images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>image</strong> (<em>2D NumPy array</em>) – </p></li>
<li><p><strong>divide_into</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – The number used to divide the image up. If 8, then the image will be
split into an 8x8 grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Four lists</strong> (<em>x_new, y_new, u_new, v_new.</em>)</p></li>
<li><p><em>x_new and y_new are the central coordinates of the divided regions.</em></p></li>
<li><p><em>u_new and v_new are the averaged polarisation vectors.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span> <span class="n">plot_polarisation_vectors</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">get_average_polarisation_in_regions_square</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
</pre></div>
</div>
<p>Get and plot the original polarisation vectors of a non-square image</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Actual Vector Arrows&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Get and plot the new, averaged polarisation vectors for a non-square image</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">get_average_polarisation_in_regions_square</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">divide_into</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Vector Arrows&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_divide_into">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_divide_into</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">averaging_by</span></em>, <em class="sig-param"><span class="n">sampling</span></em>, <em class="sig-param"><span class="n">zone_axis_index_A</span></em>, <em class="sig-param"><span class="n">zone_axis_index_B</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_divide_into" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <cite>divide_into</cite> required to get an averaging of <cite>averaging_by</cite>.
<cite>divide_into</cite> can then be used in
temul.polarisation.get_average_polarisation_in_regions.
Also finds unit cell size and the number of unit cells in the (square)
image along the x axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice</em>) – </p></li>
<li><p><strong>averaging_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – How many unit cells should be averaged. If <cite>averaging_by=2</cite>, 2x2 unit
cells will be averaged when passing <cite>divide_into</cite> to
temul.polarisation.get_average_polarisation_in_regions.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>zone_axis_index_A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Sublattice zone axis indices which should represent the sides of the
unit cell.</p></li>
<li><p><strong>zone_axis_index_B</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Sublattice zone axis indices which should represent the sides of the
unit cell.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>divide_into, unit_cell_size, num_unit_cells</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_divide_into</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">atomap.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_info</span> <span class="o">=</span> <span class="n">get_divide_into</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">averaging_by</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">zone_axis_index_A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zone_axis_index_B</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divide_into</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit_cell_size</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_unit_cells</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c1"># You can count the unit cells to check</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_strain_map">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_strain_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">zone_axis_index</span></em>, <em class="sig-param"><span class="n">theoretical_value</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'inferno'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">'Strain Map'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_x_y_z</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_strain_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the strain across a zone axis of a sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axis you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.</p></li>
<li><p><strong>theoretical_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The theoretical separation between the atoms across (not along) the
specified zone.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</p></li>
<li><p><strong>vmin</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Strain Map&quot;</em>) – </p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</p></li>
<li><p><strong>return_x_y_z</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the <cite>strain_signal</cite> (map), as well as separate
lists of the x, y, and strain values.</p></li>
<li><p><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Strain map as a Hyperspy Signal2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_strain_map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strain_map</span> <span class="o">=</span> <span class="n">get_strain_map</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">zone_axis_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">theoretical_value</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.get_vector_magnitudes">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">get_vector_magnitudes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_vector_magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnitude of a vector given the uv components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – If sampling is set, the vector magnitudes (in pix) will be scaled
by sampling (nm/pix).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D NumPy array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_vector_magnitudes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># list input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># numpy input also works</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling</span> <span class="o">=</span> <span class="mf">0.0321</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.plot_atom_deviation_from_all_zone_axes">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">plot_atom_deviation_from_all_zone_axes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">plot_style</span><span class="o">=</span><span class="default_value">'vector'</span></em>, <em class="sig-param"><span class="n">overlay</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">unit_vector</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">'atom_deviation'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'yellow'</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pivot</span><span class="o">=</span><span class="default_value">'middle'</span></em>, <em class="sig-param"><span class="n">angles</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale_units</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">headwidth</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">headlength</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">headaxislength</span><span class="o">=</span><span class="default_value">4.5</span></em>, <em class="sig-param"><span class="n">monitor_dpi</span><span class="o">=</span><span class="default_value">96</span></em>, <em class="sig-param"><span class="n">no_axis_info</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">scalebar</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_atom_deviation_from_all_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the atom deviation from a straight line fit for all zone axes
constructed by an Atomap sublattice object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>all other parameters see plot_polarisation_vectors</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>For</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_atom_deviation_from_all_zone_axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_atom_deviation_from_all_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.plot_polarisation_vectors">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">plot_polarisation_vectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">plot_style</span><span class="o">=</span><span class="default_value">'vector'</span></em>, <em class="sig-param"><span class="n">vector_rep</span><span class="o">=</span><span class="default_value">'magnitude'</span></em>, <em class="sig-param"><span class="n">overlay</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">unit_vector</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">angle_offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">'polarisation_image'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'yellow'</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">monitor_dpi</span><span class="o">=</span><span class="default_value">96</span></em>, <em class="sig-param"><span class="n">pivot</span><span class="o">=</span><span class="default_value">'middle'</span></em>, <em class="sig-param"><span class="n">angles</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale_units</span><span class="o">=</span><span class="default_value">'xy'</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">headwidth</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">headlength</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">headaxislength</span><span class="o">=</span><span class="default_value">4.5</span></em>, <em class="sig-param"><span class="n">no_axis_info</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">ticks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scalebar</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">antialiased</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">remove_vectors</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the polarisation vectors. These can be found with
<cite>find_polarisation_vectors()</cite> or Atomap’s
<cite>get_polarization_from_second_sublattice()</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matplotlib's quiver function for more details.</strong> (<em>See</em>) – </p></li>
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – xy coordinates on the image</p></li>
<li><p><strong>u</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – uv vector components</p></li>
<li><p><strong>image</strong> (<em>2D NumPy array</em>) – </p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units used to display the magnitude of the vectors.</p></li>
<li><p><strong>plot_style</strong> (<em>string</em><em>, </em><em>default &quot;vector&quot;</em>) – Options are “vector”, “colormap”, “contour”, “colorwheel”. Note that
“colorwheel” will automatically plot the colorbar as an angle.</p></li>
<li><p><strong>vector_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;magnitude&quot;</em>) – How the vectors are represented. This can be either their <cite>magnitude</cite>
or <cite>angle</cite>. One may want to use <cite>angle</cite> when plotting a contour map,
i.e., view the contours in terms of angles which can be useful for
visualising regions of different polarisation.</p></li>
<li><p><strong>overlay</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the <cite>image</cite> will be plotting behind the arrows</p></li>
<li><p><strong>unit_vector</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change the vectors magnitude to unit vectors for plotting purposes.
Magnitude will still be displayed correctly for colormaps etc.</p></li>
<li><p><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change between degrees and radian. Default is radian.
If <cite>plot_style=”colorwheel”</cite>, then setting <cite>degrees=True</cite> will convert
the angle unit to degree from the default radians.</p></li>
<li><p><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – If using <cite>vector_rep=”angle”</cite> or <cite>plot_style=”contour”</cite>, this angle
will rotate the vector angles displayed by the given amount. Useful
when you want to offset the angle of the atom planes relative to the
polarisation.</p></li>
<li><p><strong>save</strong> (<em>string</em><em>, </em><em>default &quot;polarisation_image&quot;</em>) – If set to <cite>save=None</cite>, the array will not be saved.</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;&quot;</em>) – Title of the plot.</p></li>
<li><p><strong>color</strong> (<em>string</em><em>, </em><em>default &quot;r&quot;</em>) – Color of the arrows when <a href="#id1"><span class="problematic" id="id2">`</span></a>plot_style=”vector” or “contour”.</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colormap</em><em>, </em><em>default &quot;viridis&quot;</em>) – </p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 1.0</em>) – Transparency of the matplotlib <cite>cmap</cite>. For <cite>plot_style=”colormap”</cite> and
<cite>plot_style=”colorwheel”</cite>, this alpha applies to the vector arrows.
For <cite>plot_style=”contour”</cite> this alpha applies to the tricontourf map.</p></li>
<li><p><strong>monitor_dpi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 96</em>) – The DPI of the monitor, generally 96 pixels. Used to scale the image
so that large images render correctly. Use a smaller value or
<cite>monitor_dpi=None</cite> to enlarge too-small images.</p></li>
<li><p><strong>no_axis_info</strong> (<em>Bool</em><em>, </em><em>default True</em>) – This will remove the x and y axis labels and ticks from the plot if set
to True.</p></li>
<li><p><strong>ticks</strong> (<em>colorbar ticks</em><em>, </em><em>default None</em>) – None or list of ticks or Locator If None, ticks are determined
automatically from the input.</p></li>
<li><p><strong>scalebar</strong> (<em>Bool</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>default False</em>) – Add a matplotlib-scalebar to the plot. If set to True the scalebar will
appear similar to that given by Hyperspy’s <cite>plot()</cite> function. A custom
scalebar can be included as a dictionary and more custom options can be
found in the matplotlib-scalebar package. See below for an example.</p></li>
<li><p><strong>antialiased</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Applies only to <cite>plot_style=”contour”</cite>. Essentially removes the
border between regions in the tricontourf map.</p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – Number of Matplotlib tricontourf levels to be used.</p></li>
<li><p><strong>remove_vectors</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Applies only to <cite>plot_style=”contour”</cite>. If set to True, do not plot
the vector arrows.</p></li>
<li><p><strong>matplotlib's quiver function for the remaining parameters.</strong> (<em>See</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_polarisation_dummy_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">get_polarisation_dummy_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeB</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">za0</span><span class="p">,</span> <span class="n">za1</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_polarization_from_second_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">za0</span><span class="p">,</span> <span class="n">za1</span><span class="p">,</span> <span class="n">sublatticeB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_list</span> <span class="o">=</span> <span class="n">s_p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">vector_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
</pre></div>
</div>
<p>vector plot with red arrows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with red arrows overlaid on the image:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis, with <cite>vector_rep=”angle”</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>colormap arrows with sampling applied and with scalebar:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sampling</span><span class="o">=</span><span class="mf">3.0321</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">scalebar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis and unit vectors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Change the vectors to unit vectors on a tricontourf map:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot a partly transparent angle tricontourf map with vector arrows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">remove_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot a partly transparent angle tricontourf map with no vector arrows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">remove_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>“colorwheel” plot of the vectors, useful for vortexes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">colorcet</span> <span class="k">as</span> <span class="nn">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s2">&quot;colorwheel&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with a custom scalebar, for example here we need it to be dark, see
matplotlib-scalebar for more custom features.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scbar_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dx&quot;</span><span class="p">:</span> <span class="mf">3.0321</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;pm&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s2">&quot;box_alpha&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;scale_loc&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sampling</span><span class="o">=</span><span class="mf">3.0321</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">scalebar</span><span class="o">=</span><span class="n">scbar_dict</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot a contourf for quadrant visualisation using a custom matplotlib cmap:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># make the -180 and 180 degree colour the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">expand_palette</span><span class="p">(</span><span class="n">zest</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">rgb_to_dec</span><span class="p">(</span><span class="n">expanded_zest</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.ratio_of_lattice_spacings">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">ratio_of_lattice_spacings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">zone_axis_index_A</span></em>, <em class="sig-param"><span class="n">zone_axis_index_B</span></em>, <em class="sig-param"><span class="n">ideal_ratio_one</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'inferno'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">'Spacings Map'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.ratio_of_lattice_spacings" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ratio map between two zone axes. Useful to see the tetragonality
or shearing of unit cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>zone_axis_index_A</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axes you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.
The signal created from zone_axis_index_A will be divided by the signal
created from zone_axis_index_B.</p></li>
<li><p><strong>zone_axis_index_B</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axes you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.
The signal created from zone_axis_index_A will be divided by the signal
created from zone_axis_index_B.</p></li>
<li><p><strong>ideal_ratio_one</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to true this will force negative ratio values to be positive.
Useful for seeing the overall tetragonality of a lattice.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</p></li>
<li><p><strong>vmin</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Spacings Map&quot;</em>) – </p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</p></li>
<li><p><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Ratio of lattice spacings map as a Hyperspy Signal2D. It will also plot the</em></p></li>
<li><p><em>two lattice spacing maps.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">ratio_of_lattice_spacings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_map</span> <span class="o">=</span> <span class="n">ratio_of_lattice_spacings</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <cite>ideal_ratio_one=False</cite> to view the direction of tetragonality</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_map</span> <span class="o">=</span> <span class="n">ratio_of_lattice_spacings</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">ideal_ratio_one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.polarisation.rotation_of_atom_planes">
<code class="sig-prename descclassname">temul.polarisation.</code><code class="sig-name descname">rotation_of_atom_planes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">zone_axis_index</span></em>, <em class="sig-param"><span class="n">angle_offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">degrees</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">'pix'</span></em>, <em class="sig-param"><span class="n">vmin</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vmax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'inferno'</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">'Rotation Map'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_x_y_z</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.rotation_of_atom_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a map of the angles between each atom along the atom planes of a
zone axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axis you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.</p></li>
<li><p><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The angle which can be considered zero degrees. Useful when the atomic
planes are at an angle.</p></li>
<li><p><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Setting to False will return angle values in radian. Setting to True
will return angle values in degrees.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</p></li>
<li><p><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</p></li>
<li><p><strong>vmin</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>vmax</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>cmap</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Rotation Map&quot;</em>) – </p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</p></li>
<li><p><strong>return_x_y_z</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the rotation_signal (map), as well as separate
lists of the x, y, and angle values.</p></li>
<li><p><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Rotation map as a Hyperspy Signal2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">rotation_of_atom_planes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <cite>angle_offset</cite> to effectively change the angle of the horizontal axis
when calculating angles:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">angle_offset</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the return_x_y_z parameter when you want to either plot with a
different style (e.g., contour map), or you want the angle information:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_x_y_z</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>  <span class="c1"># useful for offsetting polar. plots</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.element_tools">
<span id="element-tools"></span><h3>Element Tools<a class="headerlink" href="#module-temul.element_tools" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.element_tools.atomic_radii_in_pixels">
<code class="sig-prename descclassname">temul.element_tools.</code><code class="sig-name descname">atomic_radii_in_pixels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sampling</span></em>, <em class="sig-param"><span class="n">element_symbol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.atomic_radii_in_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic radius of an element in pixels, scaled by an image sampling</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – sampling of an image in units of nm/pix</p></li>
<li><p><strong>element_symbol</strong> (<em>string</em><em>, </em><em>default None</em>) – Symbol of an element from the periodic table of elements</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Half the colavent radius of the input element in pixels</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">atomic_radii_in_pixels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
</pre></div>
</div>
<p>pretend it is a 5x5 nm image</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_sampling</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># units nm/pix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span>
<span class="go">4.62</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span>
<span class="go">2.28</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.element_tools.combine_element_lists">
<code class="sig-prename descclassname">temul.element_tools.</code><code class="sig-name descname">combine_element_lists</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lists</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.combine_element_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce multiple element_lists into one list of strings from a list of
lists, useful for the <cite>Model Refiner</cite> <cite>flattened_element_list</cite>.</p>
</dd></dl>

<dl class="py function">
<dt id="temul.element_tools.get_and_return_element">
<code class="sig-prename descclassname">temul.element_tools.</code><code class="sig-name descname">get_and_return_element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element_symbol</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_and_return_element" title="Permalink to this definition">¶</a></dt>
<dd><p>From the elemental symbol, e.g., ‘H’ for Hydrogen, provides Hydrogen as
a periodictable.core.Element object for further use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element_symbol</strong> (<em>string</em>) – Symbol of an element from the periodic table of elements e.g., “C”, “H”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A periodictable.core.Element object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">get_and_return_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Moly</span> <span class="o">=</span> <span class="n">get_and_return_element</span><span class="p">(</span><span class="n">element_symbol</span><span class="o">=</span><span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
<span class="go">Mo</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">covalent_radius</span><span class="p">)</span>
<span class="go">1.54</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.element_tools.get_individual_elements_from_element_list">
<code class="sig-prename descclassname">temul.element_tools.</code><code class="sig-name descname">get_individual_elements_from_element_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">split_symbol</span><span class="o">=</span><span class="default_value">['_', '.']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_individual_elements_from_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>Single list</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.element_tools</span> <span class="k">as</span> <span class="nn">tml_el</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>some complex atomic_columns</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3.Re_7&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>multiple lists in element_list. Used in Model_Refiner if you have more than
one sublattice.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Ti_7_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2.Fe_8&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;B&#39;, &#39;Fe&#39;, &#39;Ge&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.element_tools.split_and_sort_element">
<code class="sig-prename descclassname">temul.element_tools.</code><code class="sig-name descname">split_and_sort_element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span></em>, <em class="sig-param"><span class="n">split_symbol</span><span class="o">=</span><span class="default_value">['_', '.']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.split_and_sort_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts info from input atomic column element configuration
Split an element and its count, then sort the element for
use with other functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> (<em>string</em><em>, </em><em>default None</em>) – element species and count must be separated by the
first string in the split_symbol list.
separate elements must be separated by the second
string in the split_symbol list.</p></li>
<li><p><strong>split_symbol</strong> (<em>list of strings</em><em>, </em><em>default</em><em> [</em><em>'_'</em><em>, </em><em>'.'</em><em>]</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string is used to split different elements in
an atomic column configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of a list with element_split, element_name, element_count, and</em></p></li>
<li><p><em>element_atomic_number.</em></p></li>
<li><p><em>See examples below</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">split_and_sort_element</span>
</pre></div>
</div>
<p>simple atomic column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;S_1&#39;</span><span class="p">)</span>
<span class="go">[[[&#39;S&#39;, &#39;1&#39;], &#39;S&#39;, 1, 16]]</span>
</pre></div>
</div>
<p>complex atomic column</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;O_6.Mo_3.Ti_5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.intensity_tools">
<span id="intensity-tools"></span><h3>Intensity Tools<a class="headerlink" href="#module-temul.intensity_tools" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.intensity_tools.get_pixel_count_from_image_slice">
<code class="sig-prename descclassname">temul.intensity_tools.</code><code class="sig-name descname">get_pixel_count_from_image_slice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">self</span></em>, <em class="sig-param"><span class="n">image_data</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_pixel_count_from_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Fid the number of pixels in an area when calling
_get_image_slice_around_atom()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_data</strong> (<em>Numpy 2D array</em>) – </p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The number of pixels in the image_slice</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">get_pixel_count_from_image_slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom0</span> <span class="o">=</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel_count</span> <span class="o">=</span> <span class="n">get_pixel_count_from_image_slice</span><span class="p">(</span><span class="n">atom0</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.intensity_tools.get_sublattice_intensity">
<code class="sig-prename descclassname">temul.intensity_tools.</code><code class="sig-name descname">get_sublattice_intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">intensity_type</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">remove_background_method</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">background_sub</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_points</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_sublattice_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the intensity for each atomic column using either max, mean,
min, total or all of them at once.</p>
<p>The intensity values are taken from the area defined by
percent_to_nn.</p>
<p>Results are stored in each Atom_Position object as
amplitude_max_intensity, amplitude_mean_intensity,
amplitude_min_intensity and/or amplitude_total_intensity
which can most easily be accessed through the sublattice object.
See the examples in get_atom_column_amplitude_max_intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities you are finding.</p></li>
<li><p><strong>intensity_type</strong> (<em>string</em><em>, </em><em>default &quot;max&quot;</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</p></li>
<li><p><strong>remove_background_method</strong> (<em>string</em><em>, </em><em>default None</em>) – Determines the method used to remove the background_sub
intensities from the image. Options are “average” and “local”.</p></li>
<li><p><strong>background_sub</strong> (<em>sublattice object</em><em>, </em><em>default None</em>) – The sublattice used if remove_background_method is used.</p></li>
<li><p><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sub</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array, shape depending on <cite>intensity_type</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">get_sublattice_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom with local background
subtraction:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total_local</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the maximum intensity around the atom with average background
subtraction:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max_average</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.intensity_tools.remove_average_background">
<code class="sig-prename descclassname">temul.intensity_tools.</code><code class="sig-name descname">remove_average_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">intensity_type</span></em>, <em class="sig-param"><span class="n">background_sub</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_average_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the average background from a sublattice intensity using
a background sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</p></li>
<li><p><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min” and “all”.</p></li>
<li><p><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the average background.</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.4</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array, shape depending on <cite>intensity_type</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">remove_average_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.intensity_tools.remove_local_background">
<code class="sig-prename descclassname">temul.intensity_tools.</code><code class="sig-name descname">remove_local_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">background_sub</span></em>, <em class="sig-param"><span class="n">intensity_type</span></em>, <em class="sig-param"><span class="n">num_points</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_local_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the local background from a sublattice intensity using
a background sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</p></li>
<li><p><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and “all”.</p></li>
<li><p><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the local backgrounds.</p></li>
<li><p><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – The number of nearest neighbour values averaged from
background_sub</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array, shape depending on <cite>intensity_type</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">remove_local_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.model_creation">
<span id="model-creation"></span><h3>Model Creation<a class="headerlink" href="#module-temul.model_creation" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.model_creation.assign_z_height">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">assign_z_height</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">lattice_type</span></em>, <em class="sig-param"><span class="n">material</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.assign_z_height_to_sublattice">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">assign_z_height_to_sublattice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">z_bond_length</span></em>, <em class="sig-param"><span class="n">material</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fractional_coordinates</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">atom_layout</span><span class="o">=</span><span class="default_value">'bot'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height_to_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the z_heights for each atom position in a sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>See example_scripts : Model Creation Example</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.auto_generate_sublattice_element_list">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">auto_generate_sublattice_element_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">material_type</span></em>, <em class="sig-param"><span class="n">elements</span><span class="o">=</span><span class="default_value">'Au'</span></em>, <em class="sig-param"><span class="n">max_number_atoms_z</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.auto_generate_sublattice_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="n">auto_generate_sublattice_element_list</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">material_type</span><span class="o">=</span><span class="s1">&#39;nanoparticle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">elements</span><span class="o">=</span><span class="s1">&#39;Au&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">max_number_atoms_z</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.change_sublattice_atoms_via_intensity">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">change_sublattice_atoms_via_intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">image_diff_array</span></em>, <em class="sig-param"><span class="n">darker_or_brighter</span></em>, <em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_atoms_via_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the elements in a sublattice object to a higher or lower combined
atomic (Z) number.
The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See image_difference_intensity()</p>
<p>Get the index in sublattice from the image_difference_intensity() output,
which is the image_diff_array input here.
Then, depending on whether the image_diff_array is for atoms that should
be brighter or darker, set a new element to that sublattice atom_position</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – the elements of this sublattice will be changed</p></li>
<li><p><strong>image_diff_array</strong> (<em>Numpy 2D array</em>) – Contains (p, x, y, intensity) where
p = index of Atom_Position in sublattice
x = Atom_Position.pixel_x
y = Atom_Position.pixel_y
intensity = calculated intensity of atom in sublattice.image</p></li>
<li><p><strong>darker_or_brighter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – if the element should have a lower combined atomic Z number,
darker_or_brighter = 0.
if the element should have a higher combined atomic Z number,
darker_or_brighter = 1
In other words, the image_diff_array will change the given
sublattice elements to darker or brighter spots by choosing 0 and 1,
respectively.</p></li>
<li><p><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations</p></li>
<li><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">change_sublattice_atoms_via_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_diff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will change the 5th atom in the sublattice to a lower atomic Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># number, i.e., &#39;H_0&#39; in the given element_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_sublattice_atoms_via_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">image_diff_array</span><span class="o">=</span><span class="n">image_diff_array</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">darker_or_brighter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.change_sublattice_pseudo_inplace">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">change_sublattice_pseudo_inplace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_atom_positions</span></em>, <em class="sig-param"><span class="n">old_sublattice</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_pseudo_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and return a new Sublattice object which is a copy of
old_sublattice except with extra atom positions set with
new_atom_positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_atom_positions</strong> (<em>NumPy array</em>) – In the form [[x0, y0], [x1, y1], [x2, y2], … ]</p></li>
<li><p><strong>old_sublattice</strong> (<em>Atomap Sublattice</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">change_sublattice_pseudo_inplace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.external.atomap_devel_012.api</span> <span class="kn">import</span> <span class="n">Sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">Sublattice</span><span class="p">(</span><span class="n">atom_positions</span><span class="p">,</span> <span class="n">image_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2, 4, 6], [5, 4, 3, 6]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2], [5, 4]]</span>
</pre></div>
</div>
<p>It also copies information such as elements</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span>
<span class="go">&#39;Ti_1&#39;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>An Atomap Sublattice object that combines the new_atom_positions with</em></p></li>
<li><p><em>the information from the old_sublattice.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.compare_count_atoms_in_sublattice_list">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">compare_count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">counter_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.compare_count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the count of atomap elements in two counter_lists gotten by
count_atoms_in_sublattice_list()</p>
<p>If the counters are the same, then the original atom_lattice is the
same as the refined atom_lattice. It will return the boolean value
True. This can be used to  stop refinement loops if neccessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>counter_list</strong> (<em>list of two Counter objects</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Boolean True if the counters are equal,</em></p></li>
<li><p><em>boolean False is the counters are not equal.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">count_atoms_in_sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">([</span><span class="n">added_atoms</span><span class="p">,</span> <span class="n">no_added_atoms</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This function can also be used to stop a refinement loop by using an
if break loop:
# &gt;&gt;&gt; if compare_count_atoms_in_sublattice_list(counter_list) is True:
# &gt;&gt;&gt;    break</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.convert_numpy_z_coords_to_z_height_string">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">convert_numpy_z_coords_to_z_height_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z_coords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.convert_numpy_z_coords_to_z_height_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from the output of return_z_coordinates(), which is a 1D numpy
array, to a long string, with which I have set up
sublattice.atom_list[i].z_height.</p>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import (
# …     return_z_coordinates,
# …     convert_numpy_z_coords_to_z_height_string)
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)
# &gt;&gt;&gt; Au_NP_z_height_string = convert_numpy_z_coords_to_z_height_string(
# …     Au_NP_z_coord)</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.correct_background_elements">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">correct_background_elements</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.correct_background_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.count_all_individual_elements">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">count_all_individual_elements</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">individual_element_list</span></em>, <em class="sig-param"><span class="n">dataframe</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_all_individual_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform count_element_in_pandas_df() for all elements in a dataframe.
Specify the elements you wish to count in the individual_element_list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>individual_element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – </p></li>
<li><p><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict object with each key=individual element and value=element count</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_all_individual_elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">individual_element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_count</span> <span class="o">=</span> <span class="n">count_all_individual_elements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">individual_element_list</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.count_atoms_in_sublattice_list">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the elements in a list of Atomap sublattices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_list</strong> (<em>list of atomap sublattice</em><em>(</em><em>s</em><em>)</em>) – </p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Counter object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_atoms_in_sublattice_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">])</span>
</pre></div>
</div>
<p>Compare before and after</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.count_element_in_pandas_df">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">count_element_in_pandas_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span></em>, <em class="sig-param"><span class="n">dataframe</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_element_in_pandas_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of a single element in a dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> (<em>string</em>) – element symbol</p></li>
<li><p><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Counter object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_element_in_pandas_df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span> <span class="o">=</span> <span class="n">count_element_in_pandas_df</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;Se&#39;</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span>
<span class="go">Counter({0: 9, 1: 8})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.create_dataframe_for_cif">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">create_dataframe_for_cif</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em>, <em class="sig-param"><span class="n">element_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.create_dataframe_for_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a dataframe from the inputted sublattice(s), which can then be
input to temul.io.write_cif_from_dataframe().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </p></li>
<li><p><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.find_middle_and_edge_intensities">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">find_middle_and_edge_intensities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">standard_element</span></em>, <em class="sig-param"><span class="n">scaling_exponent</span></em>, <em class="sig-param"><span class="n">largest_element_intensity</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">split_symbol</span><span class="o">=</span><span class="default_value">['_', '.']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list which represents the peak points of the
intensity distribution for each atom.</p>
<p>works for nanoparticles as well, doesn’t matter what
scaling_exponent you use for nanoparticle. Figure this out!</p>
<p>If the max_element_intensity is set, then the program assumes
that the standard element is the largest available element
combination, and scales the middle and limit intensity lists
so that the middle_intensity_list[-1] == max_element_intensity</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.find_middle_and_edge_intensities_for_background">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">find_middle_and_edge_intensities_for_background</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elements_from_sub1</span></em>, <em class="sig-param"><span class="n">elements_from_sub2</span></em>, <em class="sig-param"><span class="n">sub1_mode</span></em>, <em class="sig-param"><span class="n">sub2_mode</span></em>, <em class="sig-param"><span class="n">element_list_sub1</span></em>, <em class="sig-param"><span class="n">element_list_sub2</span></em>, <em class="sig-param"><span class="n">middle_intensity_list_sub1</span></em>, <em class="sig-param"><span class="n">middle_intensity_list_sub2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities_for_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.get_max_number_atoms_z">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">get_max_number_atoms_z</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_max_number_atoms_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.get_most_common_sublattice_element">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">get_most_common_sublattice_element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">'element'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_most_common_sublattice_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the most common element configuration in a sublattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Most common element configuration in the sublattice</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">get_most_common_sublattice_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_3&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6, 0.9&#39;</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
<span class="go">&#39;Ti_2&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;z_height&#39;</span><span class="p">)</span>
<span class="go">&#39;0.3, 0.6&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.get_positions_from_sublattices">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">get_positions_from_sublattices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_positions_from_sublattices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.image_difference_intensity">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">image_difference_intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">sim_image</span></em>, <em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">change_sublattice</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the differences in a sublattice’s atom_position intensities.
Change the elements of these atom_positions depending on this difference of
intensities.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – Elements of this sublattice will be refined</p></li>
<li><p><strong>sim_image</strong> (<em>HyperSpy 2D signal</em>) – The image you wish to refine with, usually an image simulation of the
sublattice.image</p></li>
<li><p><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations, used for refinement</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</p></li>
<li><p><strong>change_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If change_sublattice is set to True, all incorrect element assignments
will be corrected inplace.</p></li>
<li><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
<p>with some image noise and plotting the images</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.image_difference_position">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">image_difference_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">sim_image</span></em>, <em class="sig-param"><span class="n">pixel_threshold</span></em>, <em class="sig-param"><span class="n">comparison_sublattice_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_peaks</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Changes the sublattice inplace using change_sublattice_pseudo_inplace.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See also image_difference_intensity function and the Model_Refiner class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap sublattice object</em>) – </p></li>
<li><p><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </p></li>
<li><p><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</p></li>
<li><p><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</p></li>
<li><p><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</p></li>
<li><p><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</p></li>
<li><p><strong>inplace</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the input <cite>sublattice</cite> will be changed inplace and the
sublattice returned. If set to False, these changes will be output only
to a new sublattice.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Atomap Sublattice object if <cite>inplace=False</cite>. See the <cite>inplace</cite> parameter</p></li>
<li><p><em>for details.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">image_difference_position</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">change_sublattice_pseudo_inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">397</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">image_difference_position</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">400</span>
</pre></div>
</div>
<p>One can now sort these atom positions into elements.</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.image_difference_position_new_sub">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">image_difference_position_new_sub</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em>, <em class="sig-param"><span class="n">sim_image</span></em>, <em class="sig-param"><span class="n">pixel_threshold</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_peaks</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">add_sublattice</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sublattice_name</span><span class="o">=</span><span class="default_value">'sub_new'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position_new_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_list</strong> (<em>list of atomap sublattice objects</em>) – </p></li>
<li><p><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </p></li>
<li><p><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</p></li>
<li><p><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</p></li>
<li><p><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</p></li>
<li><p><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Atomap Sublattice object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check without adding a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if you have problems with mask_radius, increase it!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Just a gaussian fitting issue, could turn it off!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.print_sublattice_elements">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">print_sublattice_elements</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">number_of_lines</span><span class="o">=</span><span class="default_value">'all'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.print_sublattice_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.model_creation.return_xyz_coordinates">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">return_xyz_coordinates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">z_thickness</span></em>, <em class="sig-param"><span class="n">z_bond_length</span></em>, <em class="sig-param"><span class="n">number_atoms_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fractional_coordinates</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">atom_layout</span><span class="o">=</span><span class="default_value">'bot'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_xyz_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce xyz coordinates for an xy coordinate given the z-dimension
information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – atom position coordinates.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – atom position coordinates.</p></li>
<li><p><strong>other parameters see return_z_coordinates</strong><strong>(</strong><strong>)</strong> (<em>for</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D numpy array with columns x, y, z</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_xyz_coordinates
# &gt;&gt;&gt; x, y = 2, 3
# &gt;&gt;&gt; atom_coords = return_xyz_coordinates(x, y,
# …                         z_thickness=10,
# …                         z_bond_length=1.5,
# …                         number_atoms_z=5)</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.return_z_coordinates">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">return_z_coordinates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z_thickness</span></em>, <em class="sig-param"><span class="n">z_bond_length</span></em>, <em class="sig-param"><span class="n">number_atoms_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_number_atoms_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fractional_coordinates</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">atom_layout</span><span class="o">=</span><span class="default_value">'bot'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_z_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce fractional z-dimension coordinates for a given thickness and bond
length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z_thickness</strong> (<em>number</em>) – Size (Angstrom) of the z-dimension.</p></li>
<li><p><strong>z_bond_length</strong> (<em>number</em>) – Size (Angstrom) of the bond length between adjacent atoms in the
z-dimension.</p></li>
<li><p><strong>number_atoms_z</strong> (<em>integer</em><em>, </em><em>default None</em>) – number of atoms in the z-dimension. If this is set to an interger
value, it will override the use of z_thickness.</p></li>
<li><p><strong>centered_atoms</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the z_coordinates will be centered about 0.5.
If set to False, the z_coordinate will start at 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D numpy array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_z_coordinates
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)</p>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.scaling_z_contrast">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">scaling_z_contrast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">numerator_sublattice</span></em>, <em class="sig-param"><span class="n">numerator_element</span></em>, <em class="sig-param"><span class="n">denominator_sublattice</span></em>, <em class="sig-param"><span class="n">denominator_element</span></em>, <em class="sig-param"><span class="n">intensity_type</span></em>, <em class="sig-param"><span class="n">method</span></em>, <em class="sig-param"><span class="n">remove_background_method</span></em>, <em class="sig-param"><span class="n">background_sublattice</span></em>, <em class="sig-param"><span class="n">num_points</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">split_symbol</span><span class="o">=</span><span class="default_value">'_'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.scaling_z_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numerator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the numerator intensity will be calculated
according to Reference [1].</p></li>
<li><p><strong>numerator_element</strong> (<em>string</em>) – Element from which the numerator atomic number will be taken
according to Reference [1].</p></li>
<li><p><strong>denominator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the denominator intensity will be calculated
according to Reference [1].</p></li>
<li><p><strong>denominator_element</strong> (<em>string</em>) – Element from which the denominator atomic number will be taken
according to Reference [1].</p></li>
<li><p><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method used to calculate the intensity of the sublattices. Options are
“mean” or “mode”.</p></li>
<li><p><strong>remove_background_method</strong> (<em>string</em>) – Determines the method used to remove the background_sublattice
intensities from the image. Options are “average” and “local”.</p></li>
<li><p><strong>background_sub</strong> (<em>Sublattice object</em>) – The sublattice to be used if remove_background_method is used.</p></li>
<li><p><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sublattice.</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</p></li>
<li><p><strong>split_symbol</strong> (<em>string</em><em>, </em><em>default '_'</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string has not been implemented within this function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Four floats</em></p></li>
<li><p><em>scaling_ratio, scaling_exponent, sublattice0_intensity_method,</em></p></li>
<li><p><em>sublattice1_intensity_method</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span></dt>
<dd><p>Reference: Krivanek et al. Nature 464, 10.1038/nature08879, (2010)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
</pre></div>
</div>
<p>Check without adding a new sublattice</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Add a new sublattice</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.model_creation.sort_sublattice_intensities">
<code class="sig-prename descclassname">temul.model_creation.</code><code class="sig-name descname">sort_sublattice_intensities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">intensity_type</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">element_list</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">scalar_method</span><span class="o">=</span><span class="default_value">'mode'</span></em>, <em class="sig-param"><span class="n">middle_intensity_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">limit_intensity_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_background_method</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">background_sublattice</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_points</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">intensity_list_real</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.sort_sublattice_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="image-simulation-functions">
<h3>Image Simulation Functions<a class="headerlink" href="#image-simulation-functions" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="module-temul.signal_processing">
<span id="signal-processing"></span><h3>Signal Processing<a class="headerlink" href="#module-temul.signal_processing" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">calibrate_intensity_distance_with_sublattice_roi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">cropping_area</span></em>, <em class="sig-param"><span class="n">separation</span></em>, <em class="sig-param"><span class="n">reference_image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scalebar_true</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrates the intensity of an image by using the brightest sublattice.
The mean intensity of that sublattice is set to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to calibrate.</p></li>
<li><p><strong>cropping_area</strong> (<em>list of 2 floats</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</p></li>
<li><p><strong>separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – Pixel separation between atoms as used by Atomap.</p></li>
<li><p><strong>reference_image</strong> (<em>Hyperspy Signal2D</em>) – Image with which <cite>image</cite> is compared.</p></li>
<li><p><strong>scalebar_true</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the function assumes that <cite>image.axes_manager</cite> is
calibrated to a unit other than pixel.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask.</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.2</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>refine</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the atom positions found for the calibration will be
refined.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the image will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Nothing, but the mean intensity of the brightest sublattice is set to 1.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span><span class="n">choose_points_on_image</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">calibrate_intensity_distance_with_sublattice_roi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_a</span> <span class="o">=</span> <span class="n">choose_points_on_image</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># manually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span> <span class="c1">#use above line if trying yourself!</span>
</pre></div>
</div>
<p>calibrate_intensity_distance_with_sublattice_roi(image, crop_a, 10)
image.plot()</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.choose_mask_coordinates">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">choose_mask_coordinates</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">'log'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.choose_mask_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the mask locations for an FFT. See get_masked_ifft() for examples and
commit 5ba307b5af0b598bedc0284aa989d44e23fdde4d on Atomap for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Hyperspy 2D Signal</em>) – </p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;log&quot;</em>) – How to scale the intensity value for the displayed image.
Options are “linear” and “log”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of pixel coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.compare_two_image_and_create_filtered_image">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">compare_two_image_and_create_filtered_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_to_filter</span></em>, <em class="sig-param"><span class="n">reference_image</span></em>, <em class="sig-param"><span class="n">delta_image_filter</span></em>, <em class="sig-param"><span class="n">max_sigma</span><span class="o">=</span><span class="default_value">6</span></em>, <em class="sig-param"><span class="n">cropping_area</span><span class="o">=</span><span class="default_value">[[0, 0], [50, 50]]</span></em>, <em class="sig-param"><span class="n">separation</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.compare_two_image_and_create_filtered_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian blur an image for comparison with a reference image.
Good for finding the best gaussian blur for a simulation by
comparing to an experimental image.
See measure_image_errors() and load_and_compare_images().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_to_filter</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to automatically filter.</p></li>
<li><p><strong>reference_image</strong> (<em>Hyperspy Signal2D</em>) – Image with which <cite>image_to_filter</cite> is compared.</p></li>
<li><p><strong>delta_image_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The increment of the Gaussian sigma used.</p></li>
<li><p><strong>max_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 6</em>) – The largest (limiting) Gaussian sigma used.</p></li>
<li><p><strong>cropping_area</strong> (<em>list of 2 floats</em><em>, </em><em>default</em><em> [</em><em>[</em><em>0</em><em>,</em><em>0</em><em>]</em><em>, </em><em>[</em><em>50</em><em>,</em><em>50</em><em>]</em><em>]</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</p></li>
<li><p><strong>separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – Pixel separation between atoms as used by Atomap.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the plotted and filtered image will be saved.</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.4</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask. If set, then set <cite>percent_to_nn=None</cite>.</p></li>
<li><p><strong>refine</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the <cite>calibrate_intensity_distance_with_sublattice_roi</cite>
calibration will refine the atom positions for each calibration. May
make the function very slow depending on the size of <cite>image_to_filter</cite>
and <cite>cropping_area</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Hyperspy Signal2D (filtered image) and float (ideal Gaussian sigma)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.filters</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_two_image_and_create_filtered_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span> <span class="c1"># example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">experiment</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulation</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
</pre></div>
</div>
<dl class="simple">
<dt>filt_image, ideal_sigma = compare_two_image_and_create_filtered_image(</dt><dd><p>simulation, experiment, 0.25, cropping_area=[[5,5], [200, 200]],
separation=11, mask_radius=4, percent_to_nn=None, max_sigma=10)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.crop_image_hs">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">crop_image_hs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">cropping_area</span></em>, <em class="sig-param"><span class="n">scalebar_true</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.crop_image_hs" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop a Hyperspy Signal2D by providing the <cite>cropping_area</cite>. See the example
below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to crop</p></li>
<li><p><strong>cropping_area</strong> (<em>list of 2 floats</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</p></li>
<li><p><strong>scalebar_true</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the function assumes that <cite>image.axes_manager</cite> is
calibrated to a unit other than pixel.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the images and cropping variables will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Hyperspy Signal2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">choose_points_on_image</span><span class="p">,</span> <span class="n">crop_image_hs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropping_area</span> <span class="o">=</span> <span class="n">choose_points_on_image</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># choose two points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropping_area</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">]]</span> <span class="c1"># use above line if trying yourself!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image_cropped = crop_image_hs(image, cropping_area, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image_cropped.plot()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.distance_vector">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">distance_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x1</span></em>, <em class="sig-param"><span class="n">y1</span></em>, <em class="sig-param"><span class="n">x2</span></em>, <em class="sig-param"><span class="n">y2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.distance_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.double_gaussian_fft_filter">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">double_gaussian_fft_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">d_inner</span></em>, <em class="sig-param"><span class="n">d_outer</span></em>, <em class="sig-param"><span class="n">delta</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">units</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.double_gaussian_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter an image with an double Gaussian (band-pass) filter. The function
will automatically find the optimum magnitude of the negative inner
Gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image to be filtered.</p></li>
<li><p><strong>d_inner</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Inner diameter of the FFT spots. Effectively the diameter of the
negative Gaussian.</p></li>
<li><p><strong>d_outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Outer diameter of the FFT spots. Effectively the diameter of the
positive Gaussian.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.05</em>) – Increment of the automatic filtering with the negative Gaussian.
Setting this very small will slow down the function, but too high will
not allow the function to calculate negative Gaussians near zero.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – image sampling in units/pixel. If set to None, the image.axes_manager
will be used.</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Real space units. <cite>sampling</cite> should then be the value of
these units/pixel. If set to None, the image.axes_manager
will be used.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the following files will be plotted and saved:
negative Gaussian optimumisation, negative Gaussian, positive Gaussian,
double Gaussian, FFT and double Gaussian convolution, filtered image,
filtered variables table.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Hyperspy Signal2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">double_gaussian_fft_filter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span> <span class="o">=</span> <span class="n">double_gaussian_fft_filter</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="mf">7.48</span><span class="p">,</span> <span class="mf">14.96</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.fit_1D_gaussian_to_data">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">fit_1D_gaussian_to_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xdata</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.fit_1D_gaussian_to_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitting function for a single 1D gaussian distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xdata</strong> (<em>numpy 1D array</em>) – values input as the x coordinates of the gaussian distribution</p></li>
<li><p><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – amplitude of the gaussian in y-axis</p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – mean value of the gaussianin x-axis, corresponding to y-axis
amplitude.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – standard deviation of the gaussian distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gaussian distibution of xdata array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_xydata_from_list_of_intensities</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fit_1D_gaussian_to_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gauss_fit_01</span> <span class="o">=</span> <span class="n">fit_1D_gaussian_to_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.get_cell_image">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">get_cell_image</code><span class="sig-paren">(</span><em class="sig-param">s</em>, <em class="sig-param">points_x</em>, <em class="sig-param">points_y</em>, <em class="sig-param">method='Voronoi'</em>, <em class="sig-param">max_radius='Auto'</em>, <em class="sig-param">reduce_func=&lt;function amin&gt;</em>, <em class="sig-param">show_progressbar=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_cell_image" title="Permalink to this definition">¶</a></dt>
<dd><p>The same as atomap’s integrate, except instead of summing the
region around an atom, it removes the value from all pixels in
that region.
For example, with this you can remove the local background intensity
by setting reduce_func=np.min.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reduce_func</strong> (<em>ufunc</em><em>, </em><em>default np.min</em>) – function used to reduce the pixel values around each atom
to a float.</p></li>
<li><p><strong>the other parameters see Atomap's integrate function.</strong> (<em>For</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Numpy array with the same shape as s</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">get_cell_image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span> <span class="o">=</span> <span class="n">get_cell_image</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">x_position</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">y_position</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the <cite>cell_image</cite> which shows, in this case, the background intensity</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cell_image</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert it to a Hyperspy Signal2D object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">cell_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.get_fitting_tools_for_plotting_gaussians">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">get_fitting_tools_for_plotting_gaussians</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">scaled_middle_intensity_list</span></em>, <em class="sig-param"><span class="n">scaled_limit_intensity_list</span></em>, <em class="sig-param"><span class="n">fit_bright_first</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">gaussian_amp</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">gauss_sigma_division</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_fitting_tools_for_plotting_gaussians" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a list of parameters and details for fitting the intensities of a
sublattice with multiple Gaussians.</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.get_masked_ifft">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">get_masked_ifft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">mask_coords</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">image_space</span><span class="o">=</span><span class="default_value">'real'</span></em>, <em class="sig-param"><span class="n">keep_masked_area</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plot_masked_fft</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_masked_ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an inverse fast Fourier transform (iFFT) from an image and mask
coordinates. Use <cite>choose_mask_coordinates</cite> to manually choose mask
coordinates in the FFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>Hyperspy 2D Signal</em>) – </p></li>
<li><p><strong>mask_coords</strong> (<em>list of pixel coordinates</em>) – Pixel coordinates of the masking locations. See the example below for
two simple coordinates found using <cite>choose_mask_coordinates</cite>.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 10</em>) – Radius in pixels of the mask.</p></li>
<li><p><strong>image_space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;real&quot;</em>) – If the input image is in Fourier/diffraction/reciprocal space already,
set space=”fourier”.</p></li>
<li><p><strong>keep_masked_area</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If True, this will set the mask at the mask_coords.
If False, this will set the mask as everything other than the
mask_coords. Can be thought of as inversing the mask.</p></li>
<li><p><strong>plot_masked_fft</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If True, the mask used to filter the FFT will be plotted. Good for
checking that the mask is doing what you want. Can fail sometimes due
to matplotlib plotting issues.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Inverse FFT as a Hyperspy 2D Signal</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">choose_mask_coordinates</span><span class="p">,</span> <span class="n">get_masked_ifft</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_coords</span> <span class="o">=</span> <span class="n">choose_mask_coordinates</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="c1"># use this on the image!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">170.2</span><span class="p">,</span> <span class="mf">170.8</span><span class="p">],[</span><span class="mf">129.8</span><span class="p">,</span> <span class="mi">130</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the masked fft:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span> <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use unmasked fft area and plot the masked fft:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span> <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">keep_masked_area</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If the input image is already a Fourier transform:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">fft_image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image_space</span><span class="o">=</span><span class="s1">&#39;fourier&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.get_scaled_middle_limit_intensity_list">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">get_scaled_middle_limit_intensity_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">middle_intensity_list</span></em>, <em class="sig-param"><span class="n">limit_intensity_list</span></em>, <em class="sig-param"><span class="n">sublattice_scalar</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_scaled_middle_limit_intensity_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the middle and limit lists scaled to the actual intensities in the
sublattice. Useful for get_fitting_tools_for_plotting_gaussians().</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.get_xydata_from_list_of_intensities">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">get_xydata_from_list_of_intensities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_intensity_list</span></em>, <em class="sig-param"><span class="n">hist_bins</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_xydata_from_list_of_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Output x and y data for a histogram of intensities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_intensity_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – See get_subattice_intensity() for more information</p></li>
<li><p><strong>hist_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 100</em>) – number of bins to sort the intensities into
must be a better way of doing this? maybe automate the binning choice</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Two numpy 1D arrays corressponding to the x and y values of a histogram</em></p></li>
<li><p><em>of the sublattice intensities.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">get_xydata_from_list_of_intensities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.load_and_compare_images">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">load_and_compare_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageA</span></em>, <em class="sig-param"><span class="n">imageB</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.load_and_compare_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Load two images with hyperspy and compare their mean square error and
structural simularity index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageA</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>path to file</em>) – filename of the images to be loaded and compared</p></li>
<li><p><strong>imageB</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>path to file</em>) – filename of the images to be loaded and compared</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Two floats (mean standard error and structural simularity index)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.make_gaussian">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">make_gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">fwhm</span></em>, <em class="sig-param"><span class="n">center</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.make_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a square gaussian kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The length of a side of the square</p></li>
<li><p><strong>fwhm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The full-width-half-maximum of the Gaussian, which can be thought of as
an effective radius.</p></li>
<li><p><strong>center</strong> (<em>array</em><em>, </em><em>default None</em>) – The location of the center of the Gaussian. None will set it to the
center of the array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D Numpy array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">make_gaussian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">make_gaussian</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.mean_and_std_nearest_neighbour_distances">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">mean_and_std_nearest_neighbour_distances</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">nearest_neighbours</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">sampling</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mean_and_std_nearest_neighbour_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean and standard deviation of the distance from each atom to
its nearest neighbours.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>nearest_neighbours</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – The number of nearest neighbours used to calculate the mean distance
from an atom. As in atomap, choosing 5 gets the 4 nearest
neighbours.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The image sampling in units/pixel. If set to None then the values
returned are given in pixels.
This may be changed in future versions if Atomap’s Sublattice pixel
attribute is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Two lists</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of mean distances, list of standard deviations.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_scaled</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sampling</span><span class="o">=</span><span class="mf">0.0123</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.measure_image_errors">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">measure_image_errors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageA</span></em>, <em class="sig-param"><span class="n">imageB</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.measure_image_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the Mean Squared Error (mse) and Structural Similarity Index (ssm)
between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageA</strong> (<em>2D NumPy array</em><em>, </em><em>default None</em>) – Two images between which to measure mse and ssm</p></li>
<li><p><strong>imageB</strong> (<em>2D NumPy array</em><em>, </em><em>default None</em>) – Two images between which to measure mse and ssm</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – name with which the image will be saved</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>two floats (mse_number, ssm_number)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span> <span class="o">=</span> <span class="n">measure_image_errors</span><span class="p">(</span><span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">)</span>
</pre></div>
</div>
<p>Showing the ideal case of both images being exactly equal:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">imageA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span> <span class="o">=</span> <span class="n">measure_image_errors</span><span class="p">(</span><span class="n">imageA</span><span class="p">,</span> <span class="n">imageA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MSE: </span><span class="si">{}</span><span class="s2"> and SSM: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span><span class="p">))</span>
<span class="go">MSE: 0.0 and SSM: 1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.mse">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">mse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imageA</span></em>, <em class="sig-param"><span class="n">imageB</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mse" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the mean squared error between two images of the same shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageA</strong> (<em>array-like</em>) – The images must be the same shape.</p></li>
<li><p><strong>imageB</strong> (<em>array-like</em>) – The images must be the same shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Mean squared error</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.plot_gaussian_fit">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">plot_gaussian_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xdata</span></em>, <em class="sig-param"><span class="n">ydata</span></em>, <em class="sig-param"><span class="n">function</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">gauss_art</span><span class="o">=</span><span class="default_value">'r--'</span></em>, <em class="sig-param"><span class="n">gauss_label</span><span class="o">=</span><span class="default_value">'Gauss Fit'</span></em>, <em class="sig-param"><span class="n">plot_data</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">data_art</span><span class="o">=</span><span class="default_value">'ko'</span></em>, <em class="sig-param"><span class="n">data_label</span><span class="o">=</span><span class="default_value">'Data Points'</span></em>, <em class="sig-param"><span class="n">plot_fill</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">facecolor</span><span class="o">=</span><span class="default_value">'r'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fit" title="Permalink to this definition">¶</a></dt>
<dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">plot_gaussian_fit</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">return_fitting_of_1D_gaussian</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt_gauss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">return_fitting_of_1D_gaussian</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_gaussian_fit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">amp</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>          <span class="n">gauss_art</span><span class="o">=</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">gauss_label</span><span class="o">=</span><span class="s1">&#39;Gauss Fit&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_art</span><span class="o">=</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.plot_gaussian_fitting_for_multiple_fits">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">plot_gaussian_fitting_for_multiple_fits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sub_ints_all</span></em>, <em class="sig-param"><span class="n">fitting_tools_all_subs</span></em>, <em class="sig-param"><span class="n">element_list_all_subs</span></em>, <em class="sig-param"><span class="n">marker_list</span></em>, <em class="sig-param"><span class="n">hist_bins</span><span class="o">=</span><span class="default_value">150</span></em>, <em class="sig-param"><span class="n">plotting_style</span><span class="o">=</span><span class="default_value">'hist'</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'Fit of Intensities'</span></em>, <em class="sig-param"><span class="n">mpl_cmaps_list</span><span class="o">=</span><span class="default_value">['viridis']</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fitting_for_multiple_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>plots Gaussian distributions for intensities of a sublattice, over the
given parameters (fitting tools).</p>
<p class="rubric">Examples</p>
<p>sub_ints_all = [sub1_ints, sub2_ints]
marker_list = [[‘Sub1’, ‘.’],[‘Sub2’, ‘x’]]</p>
<dl class="simple">
<dt>middle_intensity_list_real_sub1, limit_intensity_list_real_sub1 =         make_middle_limit_intensity_list_real(</dt><dd><p>sublattice=sub1,
middle_intensity_list=middle_intensity_list_sub1,
limit_intensity_list=limit_intensity_list_sub1,
method=method,
sublattice_scalar=sub1_mode)</p>
</dd>
<dt>middle_intensity_list_real_sub2, limit_intensity_list_real_sub2 =         make_middle_limit_intensity_list_real(</dt><dd><p>sublattice=sub2,
middle_intensity_list=middle_intensity_list_sub2,
limit_intensity_list=limit_intensity_list_sub2,
method=method,
sublattice_scalar=sub2_mode)</p>
</dd>
</dl>
<p>element_list_all_subs = [element_list_sub1, element_list_sub2]</p>
<dl class="simple">
<dt>fitting_tools_all_subs = [</dt><dd><dl class="simple">
<dt>get_fitting_tools_for_plotting_gaussians(</dt><dd><p>element_list_sub1,
middle_intensity_list_real_sub1,
limit_intensity_list_real_sub1),</p>
</dd>
<dt>get_fitting_tools_for_plotting_gaussians(</dt><dd><p>element_list_sub2,
middle_intensity_list_real_sub2,
limit_intensity_list_real_sub2)
]</p>
</dd>
</dl>
</dd>
<dt>plot_gaussian_fitting_for_multiple_fits(sub_ints_all,</dt><dd><p>fitting_tools_all_subs,
element_list_all_subs,
marker_list,
hist_bins=500,
filename=’Fit of Intensities900’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.remove_image_intensity_in_data_slice">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">remove_image_intensity_in_data_slice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em>, <em class="sig-param"><span class="n">image_data</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.remove_image_intensity_in_data_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove intensity from the area around an atom in a
sublattice</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.return_fitting_of_1D_gaussian">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">return_fitting_of_1D_gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span></em>, <em class="sig-param"><span class="n">xdata</span></em>, <em class="sig-param"><span class="n">ydata</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">sigma</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.return_fitting_of_1D_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use the initially found centre (mean/mode) value of a sublattice
histogram (e.g., Mo_1 in an Mo sublattice) as an input mean for a
gaussian fit of the data.</p>
<p>xdata, ydata : see scipy.optimize.curve_fit
amp, mu, sigma : see fit_1D_gaussian_to_data() for more details</p>
<p>optimised parameters (popt) and estimated covariance (pcov) of the
fitted gaussian function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_xydata_from_list_of_intensities</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">return_fitting_of_1D_gaussian</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fit_1D_gaussian_to_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt_gauss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">return_fitting_of_1D_gaussian</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<p># print(“Calculated Mean: ” + str(round(np.mean(xdata),3))
# + “</p>
</div></blockquote>
<p>Fitted Mean: ” + str(round(popt_gauss[1],3)))</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_processing.toggle_atom_refine_position_automatically">
<code class="sig-prename descclassname">temul.signal_processing.</code><code class="sig-name descname">toggle_atom_refine_position_automatically</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">min_cut_off_percent</span></em>, <em class="sig-param"><span class="n">max_cut_off_percent</span></em>, <em class="sig-param"><span class="n">range_type</span><span class="o">=</span><span class="default_value">'internal'</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'mode'</span></em>, <em class="sig-param"><span class="n">percent_to_nn</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">mask_radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.toggle_atom_refine_position_automatically" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the ‘refine_position’ attribute of each Atom Position in a
sublattice using a range of intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </p></li>
<li><p><strong>min_cut_off_percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The lower end of the intensity range is defined as
<cite>min_cut_off_percent</cite> * <cite>method</cite> value of max intensity list of
<cite>sublattice</cite>.</p></li>
<li><p><strong>max_cut_off_percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The upper end of the intensity range is defined as
<cite>max_cut_off_percent</cite> * <cite>method</cite> value of max intensity list of
<cite>sublattice</cite>.</p></li>
<li><p><strong>range_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default 'internal'</em>) – “internal” provides the <cite>refine_position</cite> attribute for each
<cite>Atom Position</cite> as True if the intensity of that Atom Position
lies between the lower and upper limits defined by
<cite>min_cut_off_percent</cite> and <cite>max_cut_off_percent</cite>.
“external” provides the <cite>refine_position</cite> attribute for each
<cite>Atom Position</cite> as True if the intensity of that Atom Position
lies outside the lower and upper limits defined by
<cite>min_cut_off_percent</cite> and <cite>max_cut_off_percent</cite>.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default 'mode'</em>) – The method used to aggregate the intensity of the sublattice positions
max intensity list. Options are “mode” and “mean”</p></li>
<li><p><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.05</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</p></li>
<li><p><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the Atomap <cite>refine_position</cite> image will be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of the <cite>AtomPosition.refine_position=False</cite> attribute.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">toggle_atom_refine_position_automatically</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_cut_off_percent</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_cut_off_percent</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_list_sublattice</span> <span class="o">=</span>  <span class="n">toggle_atom_refine_position_automatically</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="p">,</span> <span class="n">min_cut_off_percent</span><span class="p">,</span> <span class="n">max_cut_off_percent</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">range_type</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">percent_to_nn</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">false_list_sublattice</span><span class="p">)</span> <span class="c1"># check how many atoms will not be refined</span>
<span class="go">12</span>
</pre></div>
</div>
<p>Visually check which atoms will not be refined (red dots)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">toggle_atom_refine_position_with_gui</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.signal_plotting">
<span id="signal-plotting"></span><h3>Signal Plotting<a class="headerlink" href="#module-temul.signal_plotting" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity">
<em class="property">class </em><code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">Sublattice_Hover_Intensity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">sublattice</span></em>, <em class="sig-param"><span class="n">sublattice_positions</span></em>, <em class="sig-param"><span class="n">background_sublattice</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>User can hover over sublattice overlaid on STEM image to display the
x,y location and intensity of that point.</p>
<dl class="py method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.scaled">
<code class="sig-name descname">scaled</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">points</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.scaled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation">
<code class="sig-name descname">setup_annotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw and hide the annotation box.</p>
</dd></dl>

<dl class="py method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.snap">
<code class="sig-name descname">snap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value in self.tree closest to x, y.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.color_palettes">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">color_palettes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pallette</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.color_palettes" title="Permalink to this definition">¶</a></dt>
<dd><p>Color sequences that are useful for creating matplotlib colormaps.
Info on “zesty” and other options:
venngage.com/blog/color-blind-friendly-palette/
Info on “r_safe”:
Google: r-plot-color-combinations-that-are-colorblind-accessible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Options are “zesty” (4 colours), and “r_safe” (12 colours).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of hex colours</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.compare_images_line_profile_one_image">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">compare_images_line_profile_one_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">line_profile_positions</span></em>, <em class="sig-param"><span class="n">linewidth</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">image_sampling</span><span class="o">=</span><span class="default_value">'Auto'</span></em>, <em class="sig-param"><span class="n">arrow</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linetrace</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_one_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on one image with the line profile intensities
in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>2D Hyperspy signal</em>) – </p></li>
<li><p><strong>line_profile_positions</strong> (<em>list of lists</em>) – two line profile coordinates. Use atomap’s am.add_atoms_with_gui()
function to get these. The first two dots will trace the first line
profile etc.
Could be extended to n positions with a basic loop.</p></li>
<li><p><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</p></li>
<li><p><strong>image_sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'Auto'</em>) – <dl class="simple">
<dt>if set to ‘Auto’ the function will attempt to find the sampling of</dt><dd><p>image from image.axes_manager[0].scale.</p>
</dd>
<dt>arrow<span class="classifier">string, default None</span></dt><dd><p>If set, arrows will be plotting on the image. Options are ‘h’ and
‘v’ for horizontal and vertical arrows, respectively.</p>
</dd>
</dl>
</p></li>
<li><p><strong>linetrace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – If set, the line profile will be plotted on the image.
The thickness of the linetrace will be linewidth*linetrace.
Name could be improved maybe.</p></li>
<li><p><strong>kwargs</strong> (<em>Matplotlib keyword arguments passed to imshow</em><em>(</em><em>)</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.compare_images_line_profile_two_images">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">compare_images_line_profile_two_images</code><span class="sig-paren">(</span><em class="sig-param">imageA</em>, <em class="sig-param">imageB</em>, <em class="sig-param">line_profile_positions</em>, <em class="sig-param">reduce_func=&lt;function mean&gt;</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">linewidth=1</em>, <em class="sig-param">image_sampling='auto'</em>, <em class="sig-param">scale_units='nm'</em>, <em class="sig-param">crop_offset=20</em>, <em class="sig-param">title='Intensity Profile'</em>, <em class="sig-param">marker_A='v'</em>, <em class="sig-param">marker_B='o'</em>, <em class="sig-param">arrow_markersize=10</em>, <em class="sig-param">figsize=(10</em>, <em class="sig-param">3)</em>, <em class="sig-param">imageB_intensity_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_two_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on two images separately with the line
profile intensities in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imageA</strong> (<em>2D Hyperspy signal</em>) – </p></li>
<li><p><strong>imageB</strong> (<em>2D Hyperspy signal</em>) – </p></li>
<li><p><strong>line_profile_positions</strong> (<em>list of lists</em>) – one line profile coordinate. Use atomap’s am.add_atoms_with_gui()
function to get these. The two dots will trace the line profile.
See Examples below for example.</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – If this is set to a name (string), the image will be saved with that
name.</p></li>
<li><p><strong>reduce_func</strong> (<em>ufunc</em><em>, </em><em>default np.mean</em>) – See skimage’s <cite>profile_line</cite> reduce_func parameter for details.</p></li>
<li><p><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</p></li>
<li><p><strong>image_sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'auto'</em>) – if set to ‘auto’ the function will attempt to find the sampling of
image from image.axes_manager[0].scale.</p></li>
<li><p><strong>scale_units</strong> (<em>string</em><em>, </em><em>default 'nm'</em>) – </p></li>
<li><p><strong>crop_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – number of pixels away from the <cite>line_profile_positions</cite> coordinates the
image crop will be taken.</p></li>
<li><p><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Intensity Profile&quot;</em>) – Title of the plot</p></li>
<li><p><strong>marker_A</strong> (<em>Matplotlib marker</em>) – </p></li>
<li><p><strong>marker_B</strong> (<em>Matplotlib marker</em>) – </p></li>
<li><p><strong>arrow_markersize</strong> (<em>Matplotlib markersize</em>) – </p></li>
<li><p><strong>figsize</strong> (<em>see Matplotlib for details</em>) – </p></li>
<li><p><strong>imageB_intensity_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0</em>) – Adds a y axis offset for comparison purposes.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_plotting</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_images_line_profile_two_images</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># line_profile_positions = am.add_atoms_with_gui(imageA)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">81.58</span><span class="p">,</span> <span class="mf">69.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">193.10</span><span class="p">,</span> <span class="mf">184.08</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">image_sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the new skimage functionality try the <cite>reduce_func</cite> parameter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span> <span class="c1"># can be any ufunc!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">image_sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">image_sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Offseting the y axis of the second image can sometimes be useful:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">301.42</span><span class="p">,</span> <span class="mf">318.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">535.92</span><span class="p">,</span> <span class="mf">500.82</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">imageB_intensity_offset</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.expand_palette">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">expand_palette</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">palette</span></em>, <em class="sig-param"><span class="n">expand_list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.expand_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Essentially multiply the palette so that it has the number of instances of
each color that you want.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Color palette in hex, rgb or dec</p></li>
<li><p><strong>expand_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of integers that will be used to duplicate colours in the palette.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List of expanded palette</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_palette</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">expand_palette</span><span class="p">(</span><span class="n">zest</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.get_cropping_area">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">get_cropping_area</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_profile_positions</span></em>, <em class="sig-param"><span class="n">crop_offset</span><span class="o">=</span><span class="default_value">20</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.get_cropping_area" title="Permalink to this definition">¶</a></dt>
<dd><p>By inputting the top-left and bottom-right coordinates of a rectangle, this
function will add a border buffer (<cite>crop_offset</cite>) which can be used for
cropping of regions in a plot.
See <cite>compare_images_line_profile_two_images</cite> for use-case</p>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.hex_to_rgb">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">hex_to_rgb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hex_values</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.hex_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Change from hexidecimal color values to rgb color values.
Grabs starting two, middle two, last two values in hex, multiplies by
16^1 and 16^0 for the first and second, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hex_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list of hexidecimal color values as strings e.g., ‘#F5793A’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="go">[(245, 121, 58), (169, 90, 161), (133, 192, 249), (15, 32, 128)]</span>
</pre></div>
</div>
<p>Create a matplotlib cmap from a palette with the help of
matplotlib.colors.from_levels_and_colors()</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># make the top and bottom colour the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">rgb_to_dec</span><span class="p">(</span><span class="n">zest</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.plot_atom_energies">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">plot_atom_energies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em>, <em class="sig-param"><span class="n">image</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vac_or_implants</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">elements_dict_other</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'energy_map'</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'plasma'</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">colorbar_fontsize</span><span class="o">=</span><span class="default_value">16</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.plot_atom_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to plot the energies of atomic column configurations above 0 as
calculated by DFT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_list</strong> (<em>list of Atomap Sublattices</em>) – </p></li>
<li><p><strong>image</strong> (<em>array-like</em><em>, </em><em>default None</em>) – The first sublattice image is used if <cite>image=None</cite>.</p></li>
<li><p><strong>vac_or_implants</strong> (<em>string</em><em>, </em><em>default None</em>) – <cite>vac_or_implants</cite> options are “implants” and “vac”.</p></li>
<li><p><strong>elements_dict_other</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>default None</em>) – A dictionary of {element_config1: energy1, element_config2: energy2, }
The default is Se antisites in monolayer MoS2.</p></li>
<li><p><strong>filename</strong> (<em>string</em><em>, </em><em>default &quot;energy_map&quot;</em>) – Name with which to save the plot.</p></li>
<li><p><strong>cmap</strong> (<em>Matplotlib colormap</em><em>, </em><em>default &quot;plasma&quot;</em>) – </p></li>
<li><p><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – Number of Matplotlib contour map levels.</p></li>
<li><p><strong>colorbar_fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 16</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>The x and y coordinates of the atom positions and the</em></p></li>
<li><p><em>atom energy.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.signal_plotting.rgb_to_dec">
<code class="sig-prename descclassname">temul.signal_plotting.</code><code class="sig-name descname">rgb_to_dec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rgb_values</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.rgb_to_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Change RGB color values to decimal color values (between 0 and 1).
Required for use with matplotlib. See Example in <cite>hex_to_rgb</cite> below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rgb_values</strong> (<em>list of tuples</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Decimal color values (RGB but scaled from 0 to 1 rather than 0 to 255)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-temul.io">
<span id="input-output-io"></span><h3>Input/Output (io)<a class="headerlink" href="#module-temul.io" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.io.batch_convert_emd_to_image">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">batch_convert_emd_to_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">extension_to_save</span></em>, <em class="sig-param"><span class="n">top_level_directory</span></em>, <em class="sig-param"><span class="n">glob_search</span><span class="o">=</span><span class="default_value">'**/*'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.batch_convert_emd_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all .emd files to the chosen extension_to_save file format in the
specified directory and all subdirectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>extension_to_save</strong> (<em>string</em>) – the image file extension to be used for saving the image.
See Hyperspy documentation for information on file writing extensions
available: <a class="reference external" href="http://hyperspy.org/hyperspy-doc/current/user_guide/io.html">http://hyperspy.org/hyperspy-doc/current/user_guide/io.html</a></p></li>
<li><p><strong>top_level_directory</strong> (<em>string</em>) – The top-level directory in which the emd files exist. The default
glob_search will search this directory and all subdirectories.</p></li>
<li><p><strong>glob_search</strong> (string, default “<a href="#id4"><span class="problematic" id="id5">**</span></a>/<a href="#id6"><span class="problematic" id="id7">*</span></a>”) – Glob search string, see glob for more details:
<a class="reference external" href="https://docs.python.org/2/library/glob.html">https://docs.python.org/2/library/glob.html</a>
Default will search this directory and all subdirectories.</p></li>
<li><p><strong>overwrite</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Overwrite if the extension_to_save file already exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.io.convert_vesta_xyz_to_prismatic_xyz">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">convert_vesta_xyz_to_prismatic_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vesta_xyz_filename</span></em>, <em class="sig-param"><span class="n">prismatic_xyz_filename</span></em>, <em class="sig-param"><span class="n">delimiter</span><span class="o">=</span><span class="default_value">'   |    |  '</span></em>, <em class="sig-param"><span class="n">header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skiprows</span><span class="o">=</span><span class="default_value">[0, 1]</span></em>, <em class="sig-param"><span class="n">engine</span><span class="o">=</span><span class="default_value">'python'</span></em>, <em class="sig-param"><span class="n">occupancy</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">rms_thermal_vib</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">edge_padding</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">header_comment</span><span class="o">=</span><span class="default_value">&quot;Let's make a file!&quot;</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.convert_vesta_xyz_to_prismatic_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from Vesta outputted xyz file format to the prismatic-style xyz
format.
Lose some information from the .cif or .vesta file but okay for now.
Develop your own converter if you need rms and occupancy! Lots to do.</p>
<p>delimiter=’      |       |  ‘ # ase xyz
delimiter=’   |    |  ‘ # vesta xyz</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vesta_xyz_filename</strong> (<em>string</em>) – name of the vesta outputted xyz file. See vesta &gt; export &gt; xyz</p></li>
<li><p><strong>prismatic_xyz_filename</strong> (<em>string</em>) – name to be given to the outputted prismatic xyz file</p></li>
<li><p><strong>delimiter</strong> (<em>pandas.read_csv input parameters</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</p></li>
<li><p><strong>header</strong> (<em>pandas.read_csv input parameters</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</p></li>
<li><p><strong>skiprows</strong> (<em>pandas.read_csv input parameters</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</p></li>
<li><p><strong>engine</strong> (<em>pandas.read_csv input parameters</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</p></li>
<li><p><strong>occupancy</strong> (<em>see prismatic documentation</em>) – if you want a file format that will retain these atomic attributes,
use a format other than vesta xyz. Maybe .cif or .vesta keeps these?</p></li>
<li><p><strong>rms_thermal_vib</strong> (<em>see prismatic documentation</em>) – if you want a file format that will retain these atomic attributes,
use a format other than vesta xyz. Maybe .cif or .vesta keeps these?</p></li>
<li><p><strong>header_comment</strong> (<em>string</em>) – header comment for the file.</p></li>
<li><p><strong>save</strong> (<em>Bool</em><em>, </em><em>default True</em>) – whether to output the file as a prismatic formatted xyz file with the
name of the file given by “prismatic_xyz_filename”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The converted file format as a pandas dataframe</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>See example_data for the vesta xyz file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="kn">import</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prismatic_xyz</span> <span class="o">=</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/example_MoS2_vesta_xyz.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/MoS2_hex_prismatic.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;   |    |  &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rms_thermal_vib</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">header_comment</span><span class="o">=</span><span class="s2">&quot;Let&#39;s do this!&quot;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.io.create_dataframe_for_xyz">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">create_dataframe_for_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sublattice_list</span></em>, <em class="sig-param"><span class="n">element_list</span></em>, <em class="sig-param"><span class="n">x_size</span></em>, <em class="sig-param"><span class="n">y_size</span></em>, <em class="sig-param"><span class="n">z_size</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">header_comment</span><span class="o">=</span><span class="default_value">'top_level_comment'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.create_dataframe_for_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Pandas Dataframe and a .xyz file (usable with Prismatic) from the
inputted sublattice(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </p></li>
<li><p><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</p></li>
<li><p><strong>x_size</strong> (<em>floats</em>) – Dimensions of the x,y,z axes in Angstrom.</p></li>
<li><p><strong>y_size</strong> (<em>floats</em>) – Dimensions of the x,y,z axes in Angstrom.</p></li>
<li><p><strong>z_size</strong> (<em>floats</em>) – Dimensions of the x,y,z axes in Angstrom.</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – Name with which the .xyz file will be saved.</p></li>
<li><p><strong>header_comment</strong> (<em>string</em><em>, </em><em>default 'top_level_comment'</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">create_dataframe_for_xyz</span><span class="p">([</span><span class="n">sublattice</span><span class="p">],</span> <span class="n">element_list</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span><span class="p">,</span> <span class="n">z_size</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">header_comment</span><span class="o">=</span><span class="s1">&#39;Here is an Example&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.io.dm3_stack_to_tiff_stack">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">dm3_stack_to_tiff_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loading_file</span></em>, <em class="sig-param"><span class="n">loading_file_extension</span><span class="o">=</span><span class="default_value">'.dm3'</span></em>, <em class="sig-param"><span class="n">saving_file_extension</span><span class="o">=</span><span class="default_value">'.tif'</span></em>, <em class="sig-param"><span class="n">crop</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">crop_start</span><span class="o">=</span><span class="default_value">20.0</span></em>, <em class="sig-param"><span class="n">crop_end</span><span class="o">=</span><span class="default_value">80.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.dm3_stack_to_tiff_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an image stack filetype to a different filetype, e.g., dm3 to tiff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – Name of the image stack file</p></li>
<li><p><strong>loading_file_extension</strong> (<em>string</em>) – file extension of the filename</p></li>
<li><p><strong>saving_file_extension</strong> (<em>string</em>) – file extension you wish to save as</p></li>
<li><p><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – if True, the image will be cropped in the navigation space,
defined by the frames given in crop_start and crop_end</p></li>
<li><p><strong>crop_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 20.0</em><em>, </em><em>80.0</em>) – the start and end frame of the crop</p></li>
<li><p><strong>crop_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 20.0</em><em>, </em><em>80.0</em>) – the start and end frame of the crop</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.io.load_data_and_sampling">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">load_data_and_sampling</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">file_extension</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">invert_image</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_image</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_data_and_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="temul.io.load_prismatic_mrc_with_hyperspy">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">load_prismatic_mrc_with_hyperspy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prismatic_mrc_filename</span></em>, <em class="sig-param"><span class="n">save_name</span><span class="o">=</span><span class="default_value">'calibrated_data_'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_prismatic_mrc_with_hyperspy" title="Permalink to this definition">¶</a></dt>
<dd><p>We are aware this is currently producing errors with new versions of
Prismatic.</p>
<p>Open a prismatic .mrc file and save as a hyperspy object.
Also plots saves a png.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>prismatic_mrc_filename</strong> (<em>string</em>) – name of the outputted prismatic .mrc file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Hyperspy Signal 2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="kn">import</span> <span class="n">load_prismatic_mrc_with_hyperspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_prismatic_mrc_with_hyperspy</span><span class="p">(</span><span class="s2">&quot;temul/example_data/prismatic/&quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;prism_2Doutput_prismatic_simulation.mrc&quot;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1182, 773)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.io.save_individual_images_from_image_stack">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">save_individual_images_from_image_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_stack</span></em>, <em class="sig-param"><span class="n">output_folder</span><span class="o">=</span><span class="default_value">'individual_images'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.save_individual_images_from_image_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save each image in an image stack. The images are saved in a new folder.
Useful for after running an image series through Rigid Registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_stack</strong> (<em>rigid registration image stack object</em>) – </p></li>
<li><p><strong>output_folder</strong> (<em>string</em>) – Name of the folder in which all individual images from
the stack will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="temul.io.write_cif_from_dataframe">
<code class="sig-prename descclassname">temul.io.</code><code class="sig-name descname">write_cif_from_dataframe</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataframe</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">chemical_name_common</span></em>, <em class="sig-param"><span class="n">cell_length_a</span></em>, <em class="sig-param"><span class="n">cell_length_b</span></em>, <em class="sig-param"><span class="n">cell_length_c</span></em>, <em class="sig-param"><span class="n">cell_angle_alpha</span><span class="o">=</span><span class="default_value">90</span></em>, <em class="sig-param"><span class="n">cell_angle_beta</span><span class="o">=</span><span class="default_value">90</span></em>, <em class="sig-param"><span class="n">cell_angle_gamma</span><span class="o">=</span><span class="default_value">90</span></em>, <em class="sig-param"><span class="n">space_group_name_H_M_alt</span><span class="o">=</span><span class="default_value">'P 1'</span></em>, <em class="sig-param"><span class="n">space_group_IT_number</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.write_cif_from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a cif file from a Pandas Dataframe. This Dataframe can be created
with temul.model_creation.create_dataframe_for_cif().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> (<em>dataframe object</em>) – pandas dataframe containing rows of atomic position information</p></li>
<li><p><strong>chemical_name_common</strong> (<em>string</em>) – name of chemical</p></li>
<li><p><strong>cell_length_a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice dimensions in angstrom</p></li>
<li><p><strong>_cell_length_b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice dimensions in angstrom</p></li>
<li><p><strong>_cell_length_c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice dimensions in angstrom</p></li>
<li><p><strong>cell_angle_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice angles in degrees</p></li>
<li><p><strong>cell_angle_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice angles in degrees</p></li>
<li><p><strong>cell_angle_gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – lattice angles in degrees</p></li>
<li><p><strong>space_group_name_H-M_alt</strong> (<em>string</em>) – space group name</p></li>
<li><p><strong>space_group_IT_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-temul.dummy_data">
<span id="dummy-data"></span><h3>Dummy Data<a class="headerlink" href="#module-temul.dummy_data" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.dummy_data.get_distorted_cubic_signal_adjustable">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_distorted_cubic_signal_adjustable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">y_offset</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_signal_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a distorted cubic atomic structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</p></li>
<li><p><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HyperSpy Signal2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_signal_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">get_distorted_cubic_signal_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.get_distorted_cubic_sublattice_adjustable">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_distorted_cubic_sublattice_adjustable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">y_offset</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_sublattice_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a distorted cubic atomic structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</p></li>
<li><p><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Atomap Sublattice object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.get_polarisation_dummy_dataset">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_polarisation_dummy_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarisation_dummy_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an Atom Lattice with two sublattices resembling a perovskite film.</p>
<p>Similar to a perovskite oxide thin film, where the B cations
are shifted in the film.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>simple_atom_lattice</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Atom_Lattice object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_polarisation_dummy_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">get_polarisation_dummy_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeB</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">za0</span><span class="p">,</span> <span class="n">za1</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_polarization_from_second_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">za0</span><span class="p">,</span> <span class="n">za1</span><span class="p">,</span> <span class="n">sublatticeB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_list</span> <span class="o">=</span> <span class="n">s_p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">vector_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>You can they use the plot_polarisation_vectors function to visualise:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.get_simple_cubic_signal">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_simple_cubic_signal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">amplitude</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">with_vacancies</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a simple cubic atomic structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</p></li>
<li><p><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</p></li>
<li><p><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>signal</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>HyperSpy 2D</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_simple_cubic_sublattice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">amplitude</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">with_vacancies</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a simple cubic atomic structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</p></li>
<li><p><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</p></li>
<li><p><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Atomap Sublattice object</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If you want different atom amplitudes, use <cite>amplitude</cite></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>Do not set <cite>amplitude</cite> to two consecutive numbers, as only amplitudes of
the lower number (2 below) will be set, see numpy.random.randint for info.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">get_simple_cubic_sublattice_positions_on_vac</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_noise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simple cubic structure similar to <cite>get_simple_cubic_sublattice</cite>
above but the atom positions are also overlaid on the vacancy positions.</p>
</dd></dl>

<dl class="py function">
<dt id="temul.dummy_data.polarisation_colorwheel_test_dataset">
<code class="sig-prename descclassname">temul.dummy_data.</code><code class="sig-name descname">polarisation_colorwheel_test_dataset</code><span class="sig-paren">(</span><em class="sig-param">cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em class="sig-param">plot_XY=True</em>, <em class="sig-param">degrees=False</em>, <em class="sig-param">normalise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.polarisation_colorwheel_test_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Check how the arrows will be plotted on a colorwheel.
Note that for STEM images, the y axis is reversed. This is taken into
account in the plot_polarisation_vectors function, but not here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">polarisation_colorwheel_test_dataset</span>
</pre></div>
</div>
<p>Use a cyclic colormap for better understanding of vectors</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more cyclic colormap options (and better colormaps), use colorcet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">colorcet</span> <span class="k">as</span> <span class="nn">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with degrees rather than the default radians</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the top and bottom arrows as “diverging” the middle of the
colormap should be the same as the edges, such as colorcet’s CET_C4.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the left and right arrows as “diverging” the halfway points of
the colormap should be the same as the edges, such as colorcet’s CET_C4s.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4s</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.example_data">
<span id="example-data"></span><h3>Example Data<a class="headerlink" href="#module-temul.example_data" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="temul.example_data.load_Se_implanted_MoS2_data">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">load_Se_implanted_MoS2_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an ADF image of Se implanted monolayer MoS2.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.example_data.load_Se_implanted_MoS2_simulation">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">load_Se_implanted_MoS2_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the simulated image of an MoS2 monolayer</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_simulation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.example_data.load_example_Au_nanoparticle">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">load_example_Au_nanoparticle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Au_nanoparticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the emd STEM image of an example Au nanoparticle</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Au_nanoparticle</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.example_data.load_example_Cu_nanoparticle_sim">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">load_example_Cu_nanoparticle_sim</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Cu_nanoparticle_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hspy simulated image of an example Cu nanoparticle</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Cu_nanoparticle_sim</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.example_data.path_to_example_data_MoS2_hex_prismatic">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">path_to_example_data_MoS2_hex_prismatic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_hex_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the xyz file for monolayer MoS2</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_xyz_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_hex_prismatic</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="temul.example_data.path_to_example_data_MoS2_vesta_xyz">
<code class="sig-prename descclassname">temul.example_data.</code><code class="sig-name descname">path_to_example_data_MoS2_vesta_xyz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_vesta_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the vesta xyz file for bilayer MoS2</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_vesta_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_vesta_xyz</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="masked_fft_tutorial.html" class="btn btn-neutral float-left" title="Masked FFT and iFFT" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Eoghan O&#39;Connell

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>