

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API documentation &mdash; TEMUL Toolkit v0.1.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'v0.1.2',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Interactive Image Filtering" href="dg_visualiser_tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> TEMUL Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                Version 0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_temul.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html">Finding Polarisation Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html#plotting-polarisation-and-movement-vectors">Plotting Polarisation and Movement Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_map_tutorial.html">Plot Lattice Structure Maps</a></li>
<li class="toctree-l1"><a class="reference internal" href="masked_fft_tutorial.html">Masked FFT and iFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="line_profile_tutorial.html">Line Intensity Profile Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg_visualiser_tutorial.html">Interactive Image Filtering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#model-refiner">Model Refiner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.polarisation">Polarisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.element_tools">Element Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.intensity_tools">Intensity Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.model_creation">Model Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.simulations">Image Simulation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_processing">Signal Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.signal_plotting">Signal Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.io">Input/Output (io)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.dummy_data">Dummy Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-temul.example_data">Example Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TEMUL Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>API documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api_doc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="api-documentation">
<span id="api-doc"></span><h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="model-refiner">
<h3>Model Refiner<a class="headerlink" href="#model-refiner" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="temul.model_refiner.Model_Refiner">
<em class="property">class </em><code class="descclassname">temul.model_refiner.</code><code class="descname">Model_Refiner</code><span class="sig-paren">(</span><em>sublattice_and_elements_dict</em>, <em>comparison_image=None</em>, <em>sampling=None</em>, <em>thickness=10</em>, <em>name=''</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="temul.model_refiner.Model_Refiner.calibrate_comparison_image">
<code class="descname">calibrate_comparison_image</code><span class="sig-paren">(</span><em>filename=None</em>, <em>percent_to_nn=None</em>, <em>mask_radius='auto'</em>, <em>refine=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.calibrate_comparison_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.combine_individual_and_element_counts_as_dataframe">
<code class="descname">combine_individual_and_element_counts_as_dataframe</code><span class="sig-paren">(</span><em>split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.combine_individual_and_element_counts_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.compare_latest_element_counts">
<code class="descname">compare_latest_element_counts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.compare_latest_element_counts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.create_simulation">
<code class="descname">create_simulation</code><span class="sig-paren">(</span><em>sublattices='all'</em>, <em>filter_image=False</em>, <em>calibrate_image=True</em>, <em>xyz_sizes=None</em>, <em>header_comment='example'</em>, <em>filename='refiner_simulation'</em>, <em>reference_image='auto'</em>, <em>probeStep=1.0</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>detectorAngleStep=0.001</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>cellDimXYZ=None</em>, <em>tileXYZ=None</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>numThreads=2</em>, <em>algorithm='prism'</em>, <em>delta_image_filter=0.5</em>, <em>max_sigma=6</em>, <em>mask_radius='auto'</em>, <em>percent_to_nn=None</em>, <em>refine=True</em>, <em>sigma_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.create_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and simulate a .xyz file from the sublattice information.
Uses the pyprismatic prism algorithm by default.</p>
<p>Note: The error resulting from filter=True with percent_to_nn set can
be fixed by setting mask_radius instead of percent_to_nn.
Error is: “TypeError: ‘NoneType’ object is not iterable”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattices</strong> (<em>Atomap Sublattices</em><em>, </em><em>default 'all'</em>) – If set to ‘all’, sublattices that exist in the <cite>Model_Refiner</cite> will
all be used. The <cite>sublattice</cite> indexes can be specified in a list.
For example [0, 2] will select the first and third sublattices.
A list of <cite>sublattice</cite> objects can instead be used.</li>
<li><strong>filter_image</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Choose whether to filter the simulation with a Gaussian to match
the <cite>reference_image</cite>.</li>
<li><strong>calibrate_image</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Choose whether to calibrate the simulation with a set
<cite>calibration_area</cite> and <cite>calibration_separation</cite>.</li>
<li><strong>xyz_sizes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>default None</em>) – List of the x, y, z physical size of the reference_image in
angstrom. If None is set, the sizes will be automatically taken
from the <cite>image_xyz_sizes</cite> attribute.</li>
<li><strong>header_comment</strong> (<em>string</em><em>, </em><em>default 'example'</em>) – The first line comment for the .xyz file.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default 'refiner_simulation'</em>) – filename with which the .xyz file and simulated .mrc file will be
saved.</li>
<li><strong>delta_image_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.5</em>) – The change in sigma for the <cite>filter</cite> Gaussian filter. Small values
will slow the <cite>filter</cite> down.</li>
<li><strong>max_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 6</em>) – The maximum sigma used for the <cite>filter</cite> Gaussian filter. Large
values will slow the <cite>filter</cite> down.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The percentage distance to the nearest neighbour atom used for
atomap atom position refinement.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'auto'</em>) – The pixel distance to the nearest neighbour atom used for atomap
atom position refinement</li>
<li><strong>refine</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Whether to refine the atom positions for the <cite>calibrate</cite> parameter.</li>
<li><strong>Note</strong> (<em>The error resulting from filter=True with percent_to_nn set can</em>) – </li>
<li><strong>fixed by setting mask_radius instead of percent_to_nn.</strong> (<em>be</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Updates the comparison_image attribute with the newly simulated model.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="temul.model_refiner.Model_Refiner.element_count">
<code class="descname">element_count</code><a class="headerlink" href="#temul.model_refiner.Model_Refiner.element_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.get_element_count_as_dataframe">
<code class="descname">get_element_count_as_dataframe</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.get_element_count_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to view the element count as a Pandas Dataframe.
See <cite>image_difference_intensity_model_refiner</cite> for an example.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Pandas Dataframe</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.get_individual_elements_as_dataframe">
<code class="descname">get_individual_elements_as_dataframe</code><span class="sig-paren">(</span><em>split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.get_individual_elements_as_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner">
<code class="descname">image_difference_intensity_model_refiner</code><span class="sig-paren">(</span><em>sublattices='all'</em>, <em>comparison_image='default'</em>, <em>change_sublattice=True</em>, <em>filename=None</em>, <em>verbose=False</em>, <em>refinement_method='Intensity'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.image_difference_intensity_model_refiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the elements for sublattice atom positions that don’t match with
comparison_image.</p>
<p>See image_difference_intensity for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image_difference_intensity for parameter information.</strong> (<em>See</em>) – </li>
<li><strong>refinement_method</strong> (<em>string</em><em>, </em><em>default &quot;Intensity&quot;</em>) – Name passed to self.refinement_history for tracking purposes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_refiner</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_model_refiner_with_12_vacancies_refined</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span> <span class="o">=</span> <span class="n">get_model_refiner_with_12_vacancies_refined</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Changing some atoms</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">history</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">element_count_history_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">history_df</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">get_element_count_as_dataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">combine_individual_and_element_counts_as_dataframe</span><span class="p">()</span>
<span class="go">                 Ti_0  Ti_1   Ti_2  Ti_3  Ti_4  Ti_5     Ti</span>
<span class="go">0 Initial State   0.0   0.0  400.0   0.0   0.0   0.0  800.0</span>
<span class="go">1 Intensity       0.0  12.0  388.0   0.0   0.0   0.0  788.0</span>
<span class="go">2 Intensity      12.0   0.0  388.0   0.0   0.0   0.0  776.0</span>
<span class="go">3 Intensity      12.0   0.0  388.0   0.0   0.0   0.0  776.0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>Flip the view of the data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">comparison_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.image_difference_position_model_refiner">
<code class="descname">image_difference_position_model_refiner</code><span class="sig-paren">(</span><em>chosen_sublattice</em>, <em>sublattices='all'</em>, <em>comparison_sublattice_list='auto'</em>, <em>comparison_image='default'</em>, <em>pixel_threshold=5</em>, <em>num_peaks=5</em>, <em>inplace=True</em>, <em>filename=None</em>, <em>refinement_method='Position'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.image_difference_position_model_refiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atom positions that were perhaps missed by the initial
position finding steps. Each sublattice will be updated with new atom
positions if new atom positions are found.</p>
<p>See image_difference_position for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image_difference_position for parameter information.</strong> (<em>See</em>) – </li>
<li><strong>refinement_method</strong> (<em>string</em><em>, </em><em>default &quot;Position&quot;</em>) – Name passed to self.refinement_history for tracking purposes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_refiner</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_model_refiner_one_sublattice_3_vacancies</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span> <span class="o">=</span> <span class="n">get_model_refiner_one_sublattice_3_vacancies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">comparison_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_position_model_refiner</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">chosen_sublattice</span><span class="o">=</span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Combination of Refinements (cont.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_intensity_model_refiner</span><span class="p">()</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">image_difference_intensity_model_refiner</span><span class="p">()</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">history_df</span> <span class="o">=</span> <span class="n">refiner</span><span class="o">.</span><span class="n">get_element_count_as_dataframe</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">refiner</span><span class="o">.</span><span class="n">plot_element_count_as_bar_chart</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_configs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">flip_colrows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_element_count_as_bar_chart">
<code class="descname">plot_element_count_as_bar_chart</code><span class="sig-paren">(</span><em>element_configs=0, flip_colrows=True, title='Refinement of Elements', fontsize=16, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_element_count_as_bar_chart" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows you to plot the element count as a bar chart.
See <cite>image_difference_intensity_model_refiner</cite> for an example.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>element_configs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – Change the plotted data.
<cite>element_configs=0</cite> will plot the element configuration counts,
<cite>element_configs=1</cite> will plot the individual element counts, and
<cite>element_configs=2</cite> will plot the both 0 and 1.</li>
<li><strong>flip_colrows</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Change how the data is plotted.
<cite>flip_colrows=True</cite> will take the transpose of the dataframe.</li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Refinement of Elements&quot;</em>) – Title of the bar chart.</li>
<li><strong>fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 16</em>) – </li>
<li><strong>split_symbol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>default</em><em> [</em><em>'_'</em><em>, </em><em>'.'</em><em>]</em>) – See temul.element_tools.split_and_sort_element for details.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_error_between_comparison_and_reference_image">
<code class="descname">plot_error_between_comparison_and_reference_image</code><span class="sig-paren">(</span><em>style='plot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_error_between_comparison_and_reference_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.plot_reference_and_comparison_images">
<code class="descname">plot_reference_and_comparison_images</code><span class="sig-paren">(</span><em>title_reference='Reference'</em>, <em>title_comparison='Comparison'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.plot_reference_and_comparison_images" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.repeating_intensity_refinement">
<code class="descname">repeating_intensity_refinement</code><span class="sig-paren">(</span><em>n=5</em>, <em>sublattices='all'</em>, <em>comparison_image='default'</em>, <em>change_sublattice=True</em>, <em>filename=None</em>, <em>verbose=False</em>, <em>ignore_element_count_comparison=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.repeating_intensity_refinement" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.revert_to_previous_refiner_instance">
<code class="descname">revert_to_previous_refiner_instance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.revert_to_previous_refiner_instance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_calibration_area">
<code class="descname">set_calibration_area</code><span class="sig-paren">(</span><em>manual_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_calibration_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Area that will be used to calibrate a simulation. The pixel separation
can be set with set_calibration_separation. The average intensity of
the atoms chosen by this separation within the area will be set to 1.
The idea is to calibrate the experimental and simulated images with a
known intensity (e.g., single Mo atom in MoS2 is relatively
consistant).</p>
<p>reference_image can be changed via the Model_refiner.reference_image
attribute.</p>
<p>manual_list must be a list of two lists, each of length two.
For example: [ [0,0], [50, 50] ]</p>
</dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_calibration_separation">
<code class="descname">set_calibration_separation</code><span class="sig-paren">(</span><em>pixel_separation</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_calibration_separation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_image_xyz_sizes">
<code class="descname">set_image_xyz_sizes</code><span class="sig-paren">(</span><em>xyz_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_image_xyz_sizes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.set_thickness">
<code class="descname">set_thickness</code><span class="sig-paren">(</span><em>thickness</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.set_thickness" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_element_count_and_refinement_history">
<code class="descname">update_element_count_and_refinement_history</code><span class="sig-paren">(</span><em>refinement_method</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_element_count_and_refinement_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_element_count_history">
<code class="descname">update_element_count_history</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_element_count_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_error_between_comparison_and_reference_image">
<code class="descname">update_error_between_comparison_and_reference_image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_error_between_comparison_and_reference_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_refinement_history">
<code class="descname">update_refinement_history</code><span class="sig-paren">(</span><em>refinement_method</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_refinement_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.model_refiner.Model_Refiner.update_sublattices_positions">
<code class="descname">update_sublattices_positions</code><span class="sig-paren">(</span><em>sublattice_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_refiner.Model_Refiner.update_sublattices_positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-temul.polarisation">
<span id="polarisation"></span><h3>Polarisation<a class="headerlink" href="#module-temul.polarisation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.polarisation.angle_label">
<code class="descclassname">temul.polarisation.</code><code class="descname">angle_label</code><span class="sig-paren">(</span><em>vector_rep='magnitude'</em>, <em>units='pix'</em>, <em>degrees=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.angle_label" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.polarisation.atom_deviation_from_straight_line_fit">
<code class="descclassname">temul.polarisation.</code><code class="descname">atom_deviation_from_straight_line_fit</code><span class="sig-paren">(</span><em>sublattice</em>, <em>axis_number</em>, <em>n</em>, <em>second_fit_rigid=True</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.atom_deviation_from_straight_line_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the atomic columns in an atom plane to two straight lines using the
first <cite>n</cite> and second (last) <cite>n</cite> atomic columns. Computes the distance of
each atomic column from the line halfway between the two fitted lines, as
described in [1]. This is done for every sublattice atom plane along the
chosen <cite>axis_number</cite>.</p>
<p>The slope of the first fitting will be used for the
second fitting. Setting <cite>second_fit_rigid</cite> = False will reverse this
behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>axis_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The index of the zone axis (translation symmetry) found by the Atomap
function <cite>construct_zone_axes()</cite>. For sublattices with heavily
deviating atomic columns, you may need to use
sublattice.construct_zone_axes(atom_plane_tolerance=1).</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of columns used at the beginning and end of each atom plane
to fit a straight line.</li>
<li><strong>second_fit_rigid</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Used to decide whether the first or second fitting’s slope will be
rigid during fitting. With <cite>second_fit_rigid=True</cite>, the slope of the
second fitting will be defined as the slope as the first fitting. The
y-intercept is free to move.</li>
<li><strong>plot</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Whether to plot the atom plane data, first and second fitting, and the
line constructed halfway between the two.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x, y, u, v</strong> – x, y are the original atom position coordinates <cite>sublattice.x_position</cite>
and <cite>sublattice.y_position</cite> for the coordinates included in the chosen
<cite>axis_number</cite>. u, v are the polarisation vector components pointing
towards the halfway line from the atom position coordinates.
These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lists of equal length</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#temul.polarisation.get_xyuv_from_line_fit" title="temul.polarisation.get_xyuv_from_line_fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_xyuv_from_line_fit()</span></code></a></dt>
<dd>uses <cite>_fit_line_clusters</cite> to get xyuv from arr</dd>
</dl>
</div>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Reference: Julie Gonnissen, Dmitry Batuk, Guillaume F. Nataf,
Lewys Jones, Artem M. Abakumov, Sandra Van Aert, Dominique
Schryvers, Ekhard K. H. Salje, Direct Observation of Ferroelectric
Domain Walls in LiNbO3: Wall‐Meanders, Kinks, and Local Electric
Charges, 26, 42, 2016, DOI: 10.1002/adfm.201603489</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.dummy_data</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">get_polarised_single_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">(</span><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Choose <cite>n</cite>: how many atom columns should be used to fit the line on each
side of the atom planes. If <cite>n</cite> is too large, the fitting will appear
incorrect.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">atom_deviation_from_straight_line_fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with angle and up/down. Note that the data ranges from -90 to +90
degrees, so the appropriate diverging cmap should be chosen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">vector_rep</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_coolwarm&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s look at some rotated data</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">get_polarised_single_sublattice_rotated</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">(</span><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># sublattice.plot_planes()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># plot the sublattice to see why 3 is suitable here!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">atom_deviation_from_straight_line_fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">vector_rep</span><span class="o">=</span><span class="s1">&#39;angle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_coolwarm&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.atom_to_atom_distance_grouped_mean">
<code class="descclassname">temul.polarisation.</code><code class="descname">atom_to_atom_distance_grouped_mean</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index</em>, <em>aggregation_axis='y'</em>, <em>slice_thickness=10</em>, <em>sampling=None</em>, <em>units='pix'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.atom_to_atom_distance_grouped_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Average the atom to atom distances along the chosen zone_axis_index
parallel to the chosen axis (‘x’ or ‘y’).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axes you wish to average along.</li>
<li><strong>aggregation_axis</strong> (<em>string</em><em>, </em><em>default &quot;y&quot;</em>) – Axis parallel to which the atom to atom distances will be averaged.</li>
<li><strong>slice_thickness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 10</em>) – thickness of the slices used for aggregation.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Slice thickness groupings and means of each grouping. Groupings can be</em></li>
<li><em>thought of as bins in a histogram of grouped means.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">atomap.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">atom_to_atom_distance_grouped_mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">get_distorted_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">(</span><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groupings</span><span class="p">,</span> <span class="n">grouped_means</span> <span class="o">=</span> <span class="n">atom_to_atom_distance_grouped_mean</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then plot these as below:
plt.figure()
plt.plot(groupings, grouped_means, ‘k.’)
plt.show()</p>
<p>Average parallel to the x axis instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">groupings</span><span class="p">,</span> <span class="n">grouped_means</span> <span class="o">=</span> <span class="n">atom_to_atom_distance_grouped_mean</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then plot these as below:
plt.figure()
plt.plot(groupings, grouped_means, ‘k.’)
plt.show()</p>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.combine_atom_deviations_from_zone_axes">
<code class="descclassname">temul.polarisation.</code><code class="descname">combine_atom_deviations_from_zone_axes</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image=None</em>, <em>axes=None</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>overlay=True</em>, <em>unit_vector=False</em>, <em>degrees=False</em>, <em>save='atom_deviation'</em>, <em>title=''</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em>, <em>monitor_dpi=96</em>, <em>no_axis_info=True</em>, <em>scalebar=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.combine_atom_deviations_from_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the atom deviations of each atom for all zone axes.
Good for plotting vortexes and seeing the total deviation from a
perfect structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>the remaining parameters see plot_polarisation_vectors</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>For</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>Four lists</strong> (<em>x, y, u, and v where x,y are the original atom position</em>)</li>
<li><em>coordinates (simply sublattice.x_position, sublattice.y_position) and</em></li>
<li><em>u,v are the polarisation vector components pointing to the new coordinate.</em></li>
<li>These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">plot_polarisation_vectors</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also choose the axes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.delete_atom_planes_from_sublattice">
<code class="descclassname">temul.polarisation.</code><code class="descname">delete_atom_planes_from_sublattice</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index=0</em>, <em>atom_plane_tolerance=0.5</em>, <em>divisible_by=3</em>, <em>offset_from_zero=0</em>, <em>opposite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.delete_atom_planes_from_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete atom_planes from a zone axis. Can choose whether to delete
every second, third etc. atom plane, and the offset from the zero index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The zone axis you wish to specify. You are indexing
sublattice.zones_axis_average_distances[zone_axis_index]</li>
<li><strong>atom_plane_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.5</em>) – float between 0.0 and 1.0. Closer to 1 means it will find more zones.
See sublattice.construct_zone_axes() for more information.</li>
<li><strong>divisible_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – If divisible_by is 2, every second atom_plane is deleted,
If divisible_by is 4, every fourth atom_plane is deleted, etc.</li>
<li><strong>offset_from_zero</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The atom_plane from which you start deleting.
If offset_from_zero is 4, the fourth atom_plane will be
the first deleted.</li>
<li><strong>opposite</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the atom_plane specified by divisible_by
will be kept and all others deleted.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">delete_atom_planes_from_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.dummy_data</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zone_vec_list</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_all_atom_planes_by_zone_vector</span><span class="p">(</span><span class="n">zone_vec_list</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_atom_planes_from_sublattice</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">zone_axis_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">divisible_by</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset_from_zero</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_all_atom_planes_by_zone_vector</span><span class="p">(</span><span class="n">zone_vec_list</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.find_polarisation_vectors">
<code class="descclassname">temul.polarisation.</code><code class="descname">find_polarisation_vectors</code><span class="sig-paren">(</span><em>atom_positions_A</em>, <em>atom_positions_B</em>, <em>save=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.find_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the vectors from atom_positions_A to atom_positions_B.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom_positions_B</strong> (<em>atom_positions_A</em><em>,</em>) – Atom positions list in the form [[x1,y1], [x2,y2], [x3,y3]…].</li>
<li><strong>save</strong> (<em>string</em><em>, </em><em>default None</em>) – If set to a string, the array will be saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>two lists</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">u and v components of the vector from A to B</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">find_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos_B</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">find_polarisation_vectors</span><span class="p">(</span><span class="n">pos_A</span><span class="p">,</span> <span class="n">pos_B</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>convert to the [[u1,v1], [u2,v2], [u3,v3]…] format</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.full_atom_plane_deviation_from_straight_line_fit">
<code class="descclassname">temul.polarisation.</code><code class="descname">full_atom_plane_deviation_from_straight_line_fit</code><span class="sig-paren">(</span><em>sublattice</em>, <em>axis_number: int = 0</em>, <em>save: str = ''</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.full_atom_plane_deviation_from_straight_line_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the atoms in an atom plane to a straight line and find the deviation
of each atom position from that straight line fit.
To plot all zones see <cite>plot_atom_deviation_from_all_zone_axes()</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>axis_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 0</em>) – The index of the zone axis (translation symmetry) found by the Atomap
function <cite>construct_zone_axes()</cite>.</li>
<li><strong>save</strong> (<em>string</em><em>, </em><em>default ''</em>) – If set to <cite>save=None</cite>, the array will not be saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>Four lists</strong> (<em>x, y, u, and v where x,y are the original atom position</em>)</li>
<li><em>coordinates (simply sublattice.x_position, sublattice.y_position) and</em></li>
<li><em>u,v are the polarisation vector components pointing to the new coordinate.</em></li>
<li>These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">full_atom_plane_deviation_from_straight_line_fit</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">plot_polarisation_vectors</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">full_atom_plane_deviation_from_straight_line_fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_angles_from_uv">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_angles_from_uv</code><span class="sig-paren">(</span><em>u</em>, <em>v</em>, <em>degrees=False</em>, <em>angle_offset=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_angles_from_uv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the angle of a vector given the uv components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>u</strong><strong>,</strong><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </li>
<li><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change between degrees and radian. Default is radian.</li>
<li><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Rotate the angles by the given amount. The function assumes that if you
set <cite>degrees=False</cite> then the provided <cite>angle_offset</cite> is in radians, and
if you set <cite>degrees=True</cite> then the provided <cite>angle_offset</cite> is in
degrees.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D NumPy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_average_polarisation_in_regions">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_average_polarisation_in_regions</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>u</em>, <em>v</em>, <em>image</em>, <em>divide_into=8</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_average_polarisation_in_regions" title="Permalink to this definition">¶</a></dt>
<dd><p>This function splits the image into the given number of regions and
averages the polarisation of each region.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>x</em><em>,</em>) – xy coordinates on the image</li>
<li><strong>v</strong> (<em>u</em><em>,</em>) – uv vector components</li>
<li><strong>image</strong> (<em>2D NumPy array</em>) – </li>
<li><strong>divide_into</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – The number used to divide the image up. If 8, then the image will be
split into an 8x8 grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x_new, y_new, u_new, v_new</strong> – x_new and y_new are the central coordinates of the divided regions.
u_new and v_new are the averaged polarisation vectors.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lists of equal length</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>   <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span>
<span class="gp">... </span>   <span class="n">plot_polarisation_vectors</span><span class="p">,</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
</pre></div>
</div>
<p>Get and plot the original polarisation vectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Actual Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Get and plot the new, averaged polarisation vectors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">get_average_polarisation_in_regions</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">divide_into</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Vector Arrows&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_average_polarisation_in_regions_square">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_average_polarisation_in_regions_square</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>u</em>, <em>v</em>, <em>image</em>, <em>divide_into=4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_average_polarisation_in_regions_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <cite>get_average_polarisation_in_regions()</cite> but works for non-square
(rectangular) images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>x</em><em>,</em>) – xy coordinates on the image</li>
<li><strong>v</strong> (<em>u</em><em>,</em>) – uv vector components</li>
<li><strong>image</strong> (<em>2D NumPy array</em>) – </li>
<li><strong>divide_into</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – The number used to divide the image up. If 8, then the image will be
split into an 8x8 grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x_new, y_new, u_new, v_new</strong> – x_new and y_new are the central coordinates of the divided regions.
u_new and v_new are the averaged polarisation vectors.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lists of equal length</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">,</span> <span class="n">plot_polarisation_vectors</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">get_average_polarisation_in_regions_square</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
</pre></div>
</div>
<p>Get and plot the original polarisation vectors of a non-square image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">combine_atom_deviations_from_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Actual Vector Arrows&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Get and plot the new, averaged polarisation vectors for a non-square image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">get_average_polarisation_in_regions_square</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">divide_into</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span> <span class="o">=</span> <span class="n">coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">,</span> <span class="n">u_new</span><span class="p">,</span> <span class="n">v_new</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Averaged Vector Arrows&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_divide_into">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_divide_into</code><span class="sig-paren">(</span><em>sublattice</em>, <em>averaging_by</em>, <em>sampling</em>, <em>zone_axis_index_A</em>, <em>zone_axis_index_B</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_divide_into" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <cite>divide_into</cite> required to get an averaging of <cite>averaging_by</cite>.
<cite>divide_into</cite> can then be used in
temul.polarisation.get_average_polarisation_in_regions.
Also finds unit cell size and the number of unit cells in the (square)
image along the x axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice</em>) – </li>
<li><strong>averaging_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – How many unit cells should be averaged. If <cite>averaging_by=2</cite>, 2x2 unit
cells will be averaged when passing <cite>divide_into</cite> to
temul.polarisation.get_average_polarisation_in_regions.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Pixel sampling of the image for calibration.</li>
<li><strong>zone_axis_index_B</strong> (<em>zone_axis_index_A</em><em>,</em>) – Sublattice zone axis indices which should represent the sides of the
unit cell.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">divide_into, unit_cell_size, num_unit_cells</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_divide_into</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">atomap.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_info</span> <span class="o">=</span> <span class="n">get_divide_into</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">averaging_by</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">zone_axis_index_A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">zone_axis_index_B</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divide_into</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit_cell_size</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_unit_cells</span> <span class="o">=</span> <span class="n">cell_info</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>  <span class="c1"># You can count the unit cells to check</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_strain_map">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_strain_map</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index</em>, <em>theoretical_value</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>cmap='inferno'</em>, <em>title='Strain Map'</em>, <em>filename=None</em>, <em>return_x_y_z=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_strain_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the strain across a zone axis of a sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axis you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.</li>
<li><strong>theoretical_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The theoretical separation between the atoms across (not along) the
specified zone.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</li>
<li><strong>vmax</strong><strong>, </strong><strong>cmap</strong> (<em>vmin</em><em>,</em>) – </li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Strain Map&quot;</em>) – </li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</li>
<li><strong>return_x_y_z</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the <cite>strain_signal</cite> (map), as well as separate
lists of the x, y, and strain values.</li>
<li><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Strain map as a Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_strain_map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strain_map</span> <span class="o">=</span> <span class="n">get_strain_map</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">zone_axis_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">theoretical_value</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_vector_magnitudes">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_vector_magnitudes</code><span class="sig-paren">(</span><em>u</em>, <em>v</em>, <em>sampling=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_vector_magnitudes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the magnitude of a vector given the uv components.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>u</strong><strong>,</strong><strong>v</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em> or </em><em>1D NumPy array</em>) – </li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – If sampling is set, the vector magnitudes (in pix) will be scaled
by sampling (nm/pix).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D NumPy array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">get_vector_magnitudes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># list input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="c1"># numpy input also works</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling</span> <span class="o">=</span> <span class="mf">0.0321</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_mags</span> <span class="o">=</span> <span class="n">get_vector_magnitudes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.get_xyuv_from_line_fit">
<code class="descclassname">temul.polarisation.</code><code class="descname">get_xyuv_from_line_fit</code><span class="sig-paren">(</span><em>arr</em>, <em>n</em>, <em>second_fit_rigid=True</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.get_xyuv_from_line_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the data in an array to two straight lines using the
first <cite>n</cite> and second (last) <cite>n</cite> array value pairs. Computes the distance of
each array value pair from the line halfway between the two fitted lines.</p>
<p>The slope of the first fitting will be used for the
second fitting. Setting <cite>second_fit_rigid</cite> = False will reverse this
behaviour.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arr</strong> (<em>2D array-like</em>) – Array-like (e.g., NumPy 2D array) in the form [[x1, y1], [x2, y2]…]</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of arr value pairs used at the beginning and end of the arr
to fit a straight line.</li>
<li><strong>second_fit_rigid</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Used to decide whether the first or second fitting’s slope will be
rigid during fitting. With <cite>second_fit_rigid=True</cite>, the slope of the
second fitting will be defined as the slope as the first fitting. The
y-intercept is free to move.</li>
<li><strong>plot</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Whether to plot the arr data, first and second fitting, and the
line constructed halfway between the two.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>x, y, u, v</strong> – x, y are the original arr coordinates. u, v are the vector components
pointing towards the halfway line from the arr coordinates.
These can be input to <cite>plot_polarisation_vectors()</cite> for visualisation.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">lists of equal length</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#temul.polarisation.atom_deviation_from_straight_line_fit" title="temul.polarisation.atom_deviation_from_straight_line_fit"><code class="xref py py-func docutils literal notranslate"><span class="pre">atom_deviation_from_straight_line_fit()</span></code></a></dt>
<dd>Gets xyuv for Sublattice object</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">get_xyuv_from_line_fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">second_fit_rigid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the lower (second) cluster to fit the data, making the first cluster
rigid</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">get_xyuv_from_line_fit</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">second_fit_rigid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.plot_atom_deviation_from_all_zone_axes">
<code class="descclassname">temul.polarisation.</code><code class="descname">plot_atom_deviation_from_all_zone_axes</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image=None</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>overlay=True</em>, <em>unit_vector=False</em>, <em>degrees=False</em>, <em>save='atom_deviation'</em>, <em>title=''</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em>, <em>monitor_dpi=96</em>, <em>no_axis_info=True</em>, <em>scalebar=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_atom_deviation_from_all_zone_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the atom deviation from a straight line fit for all zone axes
constructed by an Atomap sublattice object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>all other parameters see plot_polarisation_vectors</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>For</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_atom_deviation_from_all_zone_axes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_atom_deviation_from_all_zone_axes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.plot_polarisation_vectors">
<code class="descclassname">temul.polarisation.</code><code class="descname">plot_polarisation_vectors</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>u</em>, <em>v</em>, <em>image</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>plot_style='vector'</em>, <em>vector_rep='magnitude'</em>, <em>overlay=True</em>, <em>unit_vector=False</em>, <em>degrees=False</em>, <em>angle_offset=None</em>, <em>save='polarisation_image'</em>, <em>title=''</em>, <em>image_cmap='gray'</em>, <em>color='yellow'</em>, <em>cmap=None</em>, <em>alpha=1.0</em>, <em>monitor_dpi=96</em>, <em>pivot='middle'</em>, <em>angles='xy'</em>, <em>scale_units='xy'</em>, <em>scale=None</em>, <em>headwidth=3.0</em>, <em>headlength=5.0</em>, <em>headaxislength=4.5</em>, <em>no_axis_info=True</em>, <em>ticks=None</em>, <em>scalebar=False</em>, <em>antialiased=False</em>, <em>levels=20</em>, <em>remove_vectors=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.plot_polarisation_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the polarisation vectors. These can be found with
<cite>find_polarisation_vectors()</cite> or Atomap’s
<cite>get_polarization_from_second_sublattice()</cite> function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>matplotlib's quiver function for more details.</strong> (<em>See</em>) – </li>
<li><strong>y</strong> (<em>x</em><em>,</em>) – xy coordinates on the image</li>
<li><strong>v</strong> (<em>u</em><em>,</em>) – uv vector components</li>
<li><strong>image</strong> (<em>2D NumPy array</em>) – </li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units used to display the magnitude of the vectors.</li>
<li><strong>plot_style</strong> (<em>string</em><em>, </em><em>default &quot;vector&quot;</em>) – Options are “vector”, “colormap”, “contour”, “colorwheel”. Note that
“colorwheel” will automatically plot the colorbar as an angle.</li>
<li><strong>vector_rep</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;magnitude&quot;</em>) – How the vectors are represented. This can be either their <cite>magnitude</cite>
or <cite>angle</cite>. One may want to use <cite>angle</cite> when plotting a contour map,
i.e., view the contours in terms of angles which can be useful for
visualising regions of different polarisation.</li>
<li><strong>overlay</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the <cite>image</cite> will be plotting behind the arrows</li>
<li><strong>unit_vector</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change the vectors magnitude to unit vectors for plotting purposes.
Magnitude will still be displayed correctly for colormaps etc.</li>
<li><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Change between degrees and radian. Default is radian.
If <cite>plot_style=”colorwheel”</cite>, then setting <cite>degrees=True</cite> will convert
the angle unit to degree from the default radians.</li>
<li><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – If using <cite>vector_rep=”angle”</cite> or <cite>plot_style=”contour”</cite>, this angle
will rotate the vector angles displayed by the given amount. Useful
when you want to offset the angle of the atom planes relative to the
polarisation.</li>
<li><strong>save</strong> (<em>string</em><em>, </em><em>default &quot;polarisation_image&quot;</em>) – If set to <cite>save=None</cite>, the array will not be saved.</li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;&quot;</em>) – Title of the plot.</li>
<li><strong>image_cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default 'gray'</em>) – Matplotlib cmap that will be used for the overlay image.</li>
<li><strong>color</strong> (<em>string</em><em>, </em><em>default &quot;r&quot;</em>) – Color of the arrows when <a href="#id2"><span class="problematic" id="id3">`</span></a>plot_style=”vector” or “contour”.</li>
<li><strong>cmap</strong> (<em>matplotlib colormap</em><em>, </em><em>default &quot;viridis&quot;</em>) – </li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 1.0</em>) – Transparency of the matplotlib <cite>cmap</cite>. For <cite>plot_style=”colormap”</cite> and
<cite>plot_style=”colorwheel”</cite>, this alpha applies to the vector arrows.
For <cite>plot_style=”contour”</cite> this alpha applies to the tricontourf map.</li>
<li><strong>monitor_dpi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 96</em>) – The DPI of the monitor, generally 96 pixels. Used to scale the image
so that large images render correctly. Use a smaller value or
<cite>monitor_dpi=None</cite> to enlarge too-small images.</li>
<li><strong>no_axis_info</strong> (<em>Bool</em><em>, </em><em>default True</em>) – This will remove the x and y axis labels and ticks from the plot if set
to True.</li>
<li><strong>ticks</strong> (<em>colorbar ticks</em><em>, </em><em>default None</em>) – None or list of ticks or Locator If None, ticks are determined
automatically from the input.</li>
<li><strong>scalebar</strong> (<em>Bool</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>default False</em>) – Add a matplotlib-scalebar to the plot. If set to True the scalebar will
appear similar to that given by Hyperspy’s <cite>plot()</cite> function. A custom
scalebar can be included as a dictionary and more custom options can be
found in the matplotlib-scalebar package. See below for an example.</li>
<li><strong>antialiased</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Applies only to <cite>plot_style=”contour”</cite>. Essentially removes the
border between regions in the tricontourf map.</li>
<li><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – Number of Matplotlib tricontourf levels to be used.</li>
<li><strong>remove_vectors</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Applies only to <cite>plot_style=”contour”</cite>. If set to True, do not plot
the vector arrows.</li>
<li><strong>matplotlib's quiver function for the remaining parameters.</strong> (<em>See</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_polarisation_dummy_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">get_polarisation_dummy_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeB</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">za0</span><span class="p">,</span> <span class="n">za1</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_polarization_from_second_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">za0</span><span class="p">,</span> <span class="n">za1</span><span class="p">,</span> <span class="n">sublatticeB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_list</span> <span class="o">=</span> <span class="n">s_p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">vector_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
</pre></div>
</div>
<p>vector plot with red arrows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Vector Arrows&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with red arrows overlaid on the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;vector&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis, with <cite>vector_rep=”angle”</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>colormap arrows with sampling applied and with scalebar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sampling</span><span class="o">=</span><span class="mf">3.0321</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">scalebar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>vector plot with colormap viridis and unit vectors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Change the vectors to unit vectors on a tricontourf map:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgray&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">image_cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot a partly transparent angle tricontourf map with vector arrows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">remove_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
<p>Plot a partly transparent angle tricontourf map with no vector arrows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cet_colorwheel&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">remove_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>“colorwheel” plot of the vectors, useful for vortexes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">colorcet</span> <span class="k">as</span> <span class="nn">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s2">&quot;colorwheel&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with a custom scalebar, for example here we need it to be dark, see
matplotlib-scalebar for more custom features.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scbar_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dx&quot;</span><span class="p">:</span> <span class="mf">3.0321</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;pm&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s2">&quot;box_alpha&quot;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;scale_loc&quot;</span><span class="p">:</span> <span class="s2">&quot;top&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sampling</span><span class="o">=</span><span class="mf">3.0321</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;pm&#39;</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;colormap&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">scalebar</span><span class="o">=</span><span class="n">scbar_dict</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot a contourf for quadrant visualisation using a custom matplotlib cmap:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># make the -180 and 180 degree colour the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">expand_palette</span><span class="p">(</span><span class="n">zest</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">rgb_to_dec</span><span class="p">(</span><span class="n">expanded_zest</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s1">&#39;contour&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">cmap</span><span class="o">=</span><span class="n">custom_cmap</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">vector_rep</span><span class="o">=</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.ratio_of_lattice_spacings">
<code class="descclassname">temul.polarisation.</code><code class="descname">ratio_of_lattice_spacings</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index_A</em>, <em>zone_axis_index_B</em>, <em>ideal_ratio_one=True</em>, <em>sampling=1</em>, <em>units='pix'</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>cmap='inferno'</em>, <em>title='Spacings Map'</em>, <em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.ratio_of_lattice_spacings" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ratio map between two zone axes. Useful to see the tetragonality
or shearing of unit cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>zone_axis_index_B</strong> (<em>zone_axis_index_A</em><em>,</em>) – The zone axes you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.
The signal created from zone_axis_index_A will be divided by the signal
created from zone_axis_index_B.</li>
<li><strong>ideal_ratio_one</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to true this will force negative ratio values to be positive.
Useful for seeing the overall tetragonality of a lattice.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</li>
<li><strong>vmax</strong><strong>, </strong><strong>cmap</strong> (<em>vmin</em><em>,</em>) – </li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Spacings Map&quot;</em>) – </li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</li>
<li><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Ratio of lattice spacings map as a Hyperspy Signal2D. It will also plot the</em></li>
<li><em>two lattice spacing maps.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">ratio_of_lattice_spacings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_map</span> <span class="o">=</span> <span class="n">ratio_of_lattice_spacings</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <cite>ideal_ratio_one=False</cite> to view the direction of tetragonality</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ratio_map</span> <span class="o">=</span> <span class="n">ratio_of_lattice_spacings</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">ideal_ratio_one</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.polarisation.rotation_of_atom_planes">
<code class="descclassname">temul.polarisation.</code><code class="descname">rotation_of_atom_planes</code><span class="sig-paren">(</span><em>sublattice</em>, <em>zone_axis_index</em>, <em>angle_offset=None</em>, <em>degrees=False</em>, <em>sampling=None</em>, <em>units='pix'</em>, <em>vmin=None</em>, <em>vmax=None</em>, <em>cmap='inferno'</em>, <em>title='Rotation Map'</em>, <em>filename=None</em>, <em>return_x_y_z=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.polarisation.rotation_of_atom_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a map of the angles between each atom along the atom planes of a
zone axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>zone_axis_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The zone axis you wish to specify. You are indexing
<cite>sublattice.zones_axis_average_distances[zone_axis_index]</cite>.</li>
<li><strong>angle_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The angle which can be considered zero degrees. Useful when the atomic
planes are at an angle.</li>
<li><strong>degrees</strong> (<em>Bool</em><em>, </em><em>default False</em>) – Setting to False will return angle values in radian. Setting to True
will return angle values in degrees.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Pixel sampling of the image for calibration.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default &quot;pix&quot;</em>) – Units of the sampling.</li>
<li><strong>vmax</strong><strong>, </strong><strong>cmap</strong> (<em>vmin</em><em>,</em>) – </li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Rotation Map&quot;</em>) – </li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>optional</em>) – If filename is set, the strain signal and plot will be saved.</li>
<li><strong>return_x_y_z</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If this is set to True, the rotation_signal (map), as well as separate
lists of the x, y, and angle values.</li>
<li><strong>**kwargs</strong> (Matplotlib keyword arguments passed to <cite>imshow()</cite>.) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Rotation map as a Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">rotation_of_atom_planes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_polarization_film_atom_lattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">refine_atom_positions_using_center_of_mass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <cite>angle_offset</cite> to effectively change the angle of the horizontal axis
when calculating angles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span><span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">angle_offset</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the return_x_y_z parameter when you want to either plot with a
different style (e.g., contour map), or you want the angle information:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rotation_map</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">rotation_of_atom_planes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublatticeA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_x_y_z</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>  <span class="c1"># useful for offsetting polar. plots</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.element_tools">
<span id="element-tools"></span><h3>Element Tools<a class="headerlink" href="#module-temul.element_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.element_tools.atomic_radii_in_pixels">
<code class="descclassname">temul.element_tools.</code><code class="descname">atomic_radii_in_pixels</code><span class="sig-paren">(</span><em>sampling</em>, <em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.atomic_radii_in_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic radius of an element in pixels, scaled by an image sampling</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – sampling of an image in units of nm/pix</li>
<li><strong>element_symbol</strong> (<em>string</em><em>, </em><em>default None</em>) – Symbol of an element from the periodic table of elements</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Half the colavent radius of the input element in pixels</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">atomic_radii_in_pixels</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
</pre></div>
</div>
<p>pretend it is a 5x5 nm image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_sampling</span> <span class="o">=</span> <span class="mi">5</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1"># units nm/pix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_Mo</span>
<span class="go">4.62</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span> <span class="o">=</span> <span class="n">atomic_radii_in_pixels</span><span class="p">(</span><span class="n">image_sampling</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius_pix_S</span>
<span class="go">2.28</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.combine_element_lists">
<code class="descclassname">temul.element_tools.</code><code class="descname">combine_element_lists</code><span class="sig-paren">(</span><em>lists</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.combine_element_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce multiple element_lists into one list of strings from a list of
lists, useful for the <cite>Model Refiner</cite> <cite>flattened_element_list</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_and_return_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_and_return_element</code><span class="sig-paren">(</span><em>element_symbol</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_and_return_element" title="Permalink to this definition">¶</a></dt>
<dd><p>From the elemental symbol, e.g., ‘H’ for Hydrogen, provides Hydrogen as
a periodictable.core.Element object for further use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>element_symbol</strong> (<em>string</em>) – Symbol of an element from the periodic table of elements e.g., “C”, “H”</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A periodictable.core.Element object</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">get_and_return_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Moly</span> <span class="o">=</span> <span class="n">get_and_return_element</span><span class="p">(</span><span class="n">element_symbol</span><span class="o">=</span><span class="s1">&#39;Mo&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>
<span class="go">Mo</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">covalent_radius</span><span class="p">)</span>
<span class="go">1.54</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moly</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.get_individual_elements_from_element_list">
<code class="descclassname">temul.element_tools.</code><code class="descname">get_individual_elements_from_element_list</code><span class="sig-paren">(</span><em>element_list, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.get_individual_elements_from_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Examples</p>
<p>Single list</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.element_tools</span> <span class="k">as</span> <span class="nn">tml_el</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>some complex atomic_columns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_3.Re_7&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;Ge&#39;, &#39;Mo&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
<p>multiple lists in element_list. Used in Model_Refiner if you have more than
one sublattice.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;Ti_7_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Ti_9.Re_3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ge_2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B_9&#39;</span><span class="p">,</span> <span class="s1">&#39;B_2.Fe_8&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_individual_elements_from_element_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">element_list</span><span class="p">,</span> <span class="n">split_symbol</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">])</span>
<span class="go">[&#39;B&#39;, &#39;Fe&#39;, &#39;Ge&#39;, &#39;Re&#39;, &#39;Ti&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.element_tools.split_and_sort_element">
<code class="descclassname">temul.element_tools.</code><code class="descname">split_and_sort_element</code><span class="sig-paren">(</span><em>element, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.element_tools.split_and_sort_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts info from input atomic column element configuration
Split an element and its count, then sort the element for
use with other functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>element</strong> (<em>string</em><em>, </em><em>default None</em>) – element species and count must be separated by the
first string in the split_symbol list.
separate elements must be separated by the second
string in the split_symbol list.</li>
<li><strong>split_symbol</strong> (<em>list of strings</em><em>, </em><em>default</em><em> [</em><em>'_'</em><em>, </em><em>'.'</em><em>]</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string is used to split different elements in
an atomic column configuration.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>list of a list with element_split, element_name, element_count, and</em></li>
<li><em>element_atomic_number.</em></li>
<li><em>See examples below</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.element_tools</span> <span class="kn">import</span> <span class="n">split_and_sort_element</span>
</pre></div>
</div>
<p>simple atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;S_1&#39;</span><span class="p">)</span>
<span class="go">[[[&#39;S&#39;, &#39;1&#39;], &#39;S&#39;, 1, 16]]</span>
</pre></div>
</div>
<p>complex atomic column</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">split_and_sort_element</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;O_6.Mo_3.Ti_5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.intensity_tools">
<span id="intensity-tools"></span><h3>Intensity Tools<a class="headerlink" href="#module-temul.intensity_tools" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.intensity_tools.get_pixel_count_from_image_slice">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_pixel_count_from_image_slice</code><span class="sig-paren">(</span><em>self</em>, <em>image_data</em>, <em>percent_to_nn=0.4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_pixel_count_from_image_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Fid the number of pixels in an area when calling
_get_image_slice_around_atom()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_data</strong> (<em>Numpy 2D array</em>) – </li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The number of pixels in the image_slice</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">get_pixel_count_from_image_slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom0</span> <span class="o">=</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pixel_count</span> <span class="o">=</span> <span class="n">get_pixel_count_from_image_slice</span><span class="p">(</span><span class="n">atom0</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.get_sublattice_intensity">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">get_sublattice_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type='max'</em>, <em>remove_background_method=None</em>, <em>background_sub=None</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.get_sublattice_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the intensity for each atomic column using either max, mean,
min, total or all of them at once.</p>
<p>The intensity values are taken from the area defined by
percent_to_nn.</p>
<p>Results are stored in each Atom_Position object as
amplitude_max_intensity, amplitude_mean_intensity,
amplitude_min_intensity and/or amplitude_total_intensity
which can most easily be accessed through the sublattice object.
See the examples in get_atom_column_amplitude_max_intensity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities you are finding.</li>
<li><strong>intensity_type</strong> (<em>string</em><em>, </em><em>default &quot;max&quot;</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</li>
<li><strong>remove_background_method</strong> (<em>string</em><em>, </em><em>default None</em>) – Determines the method used to remove the background_sub
intensities from the image. Options are “average” and “local”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em><em>, </em><em>default None</em>) – The sublattice used if remove_background_method is used.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sub</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">get_sublattice_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the summed intensity around the atom with local background
subtraction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total_local</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the maximum intensity around the atom with average background
subtraction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max_average</span> <span class="o">=</span> <span class="n">get_sublattice_intensity</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">remove_background_method</span><span class="o">=</span><span class="s2">&quot;average&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_average_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_average_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type</em>, <em>background_sub</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_average_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the average background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min” and “all”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the average background.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.4</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">remove_average_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_all</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_average_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.intensity_tools.remove_local_background">
<code class="descclassname">temul.intensity_tools.</code><code class="descname">remove_local_background</code><span class="sig-paren">(</span><em>sublattice</em>, <em>background_sub</em>, <em>intensity_type</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.intensity_tools.remove_local_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the local background from a sublattice intensity using
a background sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>sublattice object</em>) – The sublattice whose intensities are of interest.</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and “all”.</li>
<li><strong>background_sub</strong> (<em>sublattice object</em>) – The sublattice used to find the local backgrounds.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 3</em>) – The number of nearest neighbour values averaged from
background_sub</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array, shape depending on <cite>intensity_type</cite></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.intensity_tools</span> <span class="kn">import</span> <span class="n">remove_local_background</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_total</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intensities_max</span> <span class="o">=</span> <span class="n">remove_local_background</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="p">,</span> <span class="n">intensity_type</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">background_sub</span><span class="o">=</span><span class="n">sublattice</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.model_creation">
<span id="model-creation"></span><h3>Model Creation<a class="headerlink" href="#module-temul.model_creation" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.model_creation.assign_z_height">
<code class="descclassname">temul.model_creation.</code><code class="descname">assign_z_height</code><span class="sig-paren">(</span><em>sublattice</em>, <em>lattice_type</em>, <em>material</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.assign_z_height_to_sublattice">
<code class="descclassname">temul.model_creation.</code><code class="descname">assign_z_height_to_sublattice</code><span class="sig-paren">(</span><em>sublattice</em>, <em>z_bond_length</em>, <em>material=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.assign_z_height_to_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the z_heights for each atom position in a sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See example_scripts : Model Creation Example</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.auto_generate_sublattice_element_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">auto_generate_sublattice_element_list</code><span class="sig-paren">(</span><em>material_type</em>, <em>elements='Au'</em>, <em>max_number_atoms_z=10</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.auto_generate_sublattice_element_list" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="n">auto_generate_sublattice_element_list</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">material_type</span><span class="o">=</span><span class="s1">&#39;nanoparticle&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">elements</span><span class="o">=</span><span class="s1">&#39;Au&#39;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">max_number_atoms_z</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.change_sublattice_atoms_via_intensity">
<code class="descclassname">temul.model_creation.</code><code class="descname">change_sublattice_atoms_via_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>image_diff_array</em>, <em>darker_or_brighter</em>, <em>element_list</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_atoms_via_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the elements in a sublattice object to a higher or lower combined
atomic (Z) number.
The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See image_difference_intensity()</p>
<p>Get the index in sublattice from the image_difference_intensity() output,
which is the image_diff_array input here.
Then, depending on whether the image_diff_array is for atoms that should
be brighter or darker, set a new element to that sublattice atom_position</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – the elements of this sublattice will be changed</li>
<li><strong>image_diff_array</strong> (<em>Numpy 2D array</em>) – Contains (p, x, y, intensity) where
p = index of Atom_Position in sublattice
x = Atom_Position.pixel_x
y = Atom_Position.pixel_y
intensity = calculated intensity of atom in sublattice.image</li>
<li><strong>darker_or_brighter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – if the element should have a lower combined atomic Z number,
darker_or_brighter = 0.
if the element should have a higher combined atomic Z number,
darker_or_brighter = 1
In other words, the image_diff_array will change the given
sublattice elements to darker or brighter spots by choosing 0 and 1,
respectively.</li>
<li><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations</li>
<li><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">change_sublattice_atoms_via_intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_diff_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># This will change the 5th atom in the sublattice to a lower atomic Z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># number, i.e., &#39;H_0&#39; in the given element_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_sublattice_atoms_via_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">image_diff_array</span><span class="o">=</span><span class="n">image_diff_array</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">darker_or_brighter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
<span class="go">Changing some atoms</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.change_sublattice_pseudo_inplace">
<code class="descclassname">temul.model_creation.</code><code class="descname">change_sublattice_pseudo_inplace</code><span class="sig-paren">(</span><em>new_atom_positions</em>, <em>old_sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.change_sublattice_pseudo_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and return a new Sublattice object which is a copy of
old_sublattice except with extra atom positions set with
new_atom_positions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_atom_positions</strong> (<em>NumPy array</em>) – In the form [[x0, y0], [x1, y1], [x2, y2], … ]</li>
<li><strong>old_sublattice</strong> (<em>Atomap Sublattice</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">change_sublattice_pseudo_inplace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.external.atomap_devel_012.api</span> <span class="kn">import</span> <span class="n">Sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">Sublattice</span><span class="p">(</span><span class="n">atom_positions</span><span class="p">,</span> <span class="n">image_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_atom_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_B</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2, 4, 6], [5, 4, 3, 6]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_positions</span>
<span class="go">[[1, 2], [5, 4]]</span>
</pre></div>
</div>
<p>It also copies information such as elements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span> <span class="o">=</span> <span class="n">change_sublattice_pseudo_inplace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">new_atom_positions</span><span class="p">,</span> <span class="n">sublattice_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice_A</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span>
<span class="go">&#39;Ti_1&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>An Atomap Sublattice object that combines the new_atom_positions with</em></li>
<li><em>the information from the old_sublattice.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.compare_count_atoms_in_sublattice_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">compare_count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em>counter_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.compare_count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare the count of atomap elements in two counter_lists gotten by
count_atoms_in_sublattice_list()</p>
<p>If the counters are the same, then the original atom_lattice is the
same as the refined atom_lattice. It will return the boolean value
True. This can be used to  stop refinement loops if neccessary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>counter_list</strong> (<em>list of two Counter objects</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Boolean True if the counters are equal,</em></li>
<li><em>boolean False is the counters are not equal.</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">count_atoms_in_sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">compare_count_atoms_in_sublattice_list</span><span class="p">([</span><span class="n">added_atoms</span><span class="p">,</span> <span class="n">no_added_atoms</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This function can also be used to stop a refinement loop by using an
if break loop:
# &gt;&gt;&gt; if compare_count_atoms_in_sublattice_list(counter_list) is True:
# &gt;&gt;&gt;    break</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.convert_numpy_z_coords_to_z_height_string">
<code class="descclassname">temul.model_creation.</code><code class="descname">convert_numpy_z_coords_to_z_height_string</code><span class="sig-paren">(</span><em>z_coords</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.convert_numpy_z_coords_to_z_height_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from the output of return_z_coordinates(), which is a 1D numpy
array, to a long string, with which I have set up
sublattice.atom_list[i].z_height.</p>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import (
# …     return_z_coordinates,
# …     convert_numpy_z_coords_to_z_height_string)
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)
# &gt;&gt;&gt; Au_NP_z_height_string = convert_numpy_z_coords_to_z_height_string(
# …     Au_NP_z_coord)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.correct_background_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">correct_background_elements</code><span class="sig-paren">(</span><em>sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.correct_background_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_all_individual_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_all_individual_elements</code><span class="sig-paren">(</span><em>individual_element_list</em>, <em>dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_all_individual_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform count_element_in_pandas_df() for all elements in a dataframe.
Specify the elements you wish to count in the individual_element_list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>individual_element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – </li>
<li><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict object with each key=individual element and value=element count</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_all_individual_elements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">individual_element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_count</span> <span class="o">=</span> <span class="n">count_all_individual_elements</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">individual_element_list</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_atoms_in_sublattice_list">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_atoms_in_sublattice_list</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_atoms_in_sublattice_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the elements in a list of Atomap sublattices</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of atomap sublattice</em><em>(</em><em>s</em><em>)</em>) – </li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Counter object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_atoms_in_sublattice_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub1</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sub2</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Cl_1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sub1</span><span class="p">,</span> <span class="n">sub2</span><span class="p">])</span>
</pre></div>
</div>
<p>Compare before and after</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">at_lat_before</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_atom_lattice_two_sublattices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">no_added_atoms</span> <span class="o">=</span> <span class="n">count_atoms_in_sublattice_list</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">sublattice_list</span><span class="o">=</span><span class="n">at_lat_before</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.count_element_in_pandas_df">
<code class="descclassname">temul.model_creation.</code><code class="descname">count_element_in_pandas_df</code><span class="sig-paren">(</span><em>element</em>, <em>dataframe</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.count_element_in_pandas_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of a single element in a dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>element</strong> (<em>string</em>) – element symbol</li>
<li><strong>dataframe</strong> (<em>pandas dataframe</em>) – The dataframe must have column headers as elements or element
configurations</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Counter object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">count_element_in_pandas_df</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Se_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;S_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">counts</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span> <span class="o">=</span> <span class="n">count_element_in_pandas_df</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="s1">&#39;Se&#39;</span><span class="p">,</span> <span class="n">dataframe</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Se_count</span>
<span class="go">Counter({0: 9, 1: 8})</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.create_dataframe_for_cif">
<code class="descclassname">temul.model_creation.</code><code class="descname">create_dataframe_for_cif</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>element_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.create_dataframe_for_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs a dataframe from the inputted sublattice(s), which can then be
input to temul.io.write_cif_from_dataframe().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </li>
<li><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.find_middle_and_edge_intensities">
<code class="descclassname">temul.model_creation.</code><code class="descname">find_middle_and_edge_intensities</code><span class="sig-paren">(</span><em>sublattice, element_list, standard_element, scaling_exponent, largest_element_intensity=None, split_symbol=['_', '.']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a list which represents the peak points of the
intensity distribution for each atom.</p>
<p>works for nanoparticles as well, doesn’t matter what
scaling_exponent you use for nanoparticle. Figure this out!</p>
<p>If the max_element_intensity is set, then the program assumes
that the standard element is the largest available element
combination, and scales the middle and limit intensity lists
so that the middle_intensity_list[-1] == max_element_intensity</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.find_middle_and_edge_intensities_for_background">
<code class="descclassname">temul.model_creation.</code><code class="descname">find_middle_and_edge_intensities_for_background</code><span class="sig-paren">(</span><em>elements_from_sub1</em>, <em>elements_from_sub2</em>, <em>sub1_mode</em>, <em>sub2_mode</em>, <em>element_list_sub1</em>, <em>element_list_sub2</em>, <em>middle_intensity_list_sub1</em>, <em>middle_intensity_list_sub2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.find_middle_and_edge_intensities_for_background" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_max_number_atoms_z">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_max_number_atoms_z</code><span class="sig-paren">(</span><em>sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_max_number_atoms_z" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_most_common_sublattice_element">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_most_common_sublattice_element</code><span class="sig-paren">(</span><em>sublattice</em>, <em>info='element'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_most_common_sublattice_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the most common element configuration in a sublattice.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Most common element configuration in the sublattice</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">get_most_common_sublattice_element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_3&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6, 0.9&#39;</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Ti_2&#39;</span>
<span class="gp">... </span>        <span class="n">atom</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.3, 0.6&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;element&#39;</span><span class="p">)</span>
<span class="go">&#39;Ti_2&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_most_common_sublattice_element</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s1">&#39;z_height&#39;</span><span class="p">)</span>
<span class="go">&#39;0.3, 0.6&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.get_positions_from_sublattices">
<code class="descclassname">temul.model_creation.</code><code class="descname">get_positions_from_sublattices</code><span class="sig-paren">(</span><em>sublattice_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.get_positions_from_sublattices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_intensity">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_intensity</code><span class="sig-paren">(</span><em>sublattice</em>, <em>sim_image</em>, <em>element_list</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>change_sublattice=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the differences in a sublattice’s atom_position intensities.
Change the elements of these atom_positions depending on this difference of
intensities.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – Elements of this sublattice will be refined</li>
<li><strong>sim_image</strong> (<em>HyperSpy 2D signal</em>) – The image you wish to refine with, usually an image simulation of the
sublattice.image</li>
<li><strong>element_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – list of element configurations, used for refinement</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>change_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If change_sublattice is set to True, all incorrect element assignments
will be corrected inplace.</li>
<li><strong>verbose</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True then atom warnings will be printed as output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
<p>with some image noise and plotting the images</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_intensity</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">element_list</span><span class="o">=</span><span class="n">element_list</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_position">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_position</code><span class="sig-paren">(</span><em>sublattice</em>, <em>sim_image</em>, <em>pixel_threshold</em>, <em>comparison_sublattice_list=None</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>num_peaks=5</em>, <em>inplace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Changes the sublattice inplace using change_sublattice_pseudo_inplace.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.
See also image_difference_intensity function and the Model_Refiner class.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap sublattice object</em>) – </li>
<li><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </li>
<li><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</li>
<li><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</li>
<li><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</li>
<li><strong>inplace</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the input <cite>sublattice</cite> will be changed inplace and the
sublattice returned. If set to False, these changes will be output only
to a new sublattice.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li>Atomap Sublattice object if <cite>inplace=False</cite>. See the <cite>inplace</cite> parameter</li>
<li><em>for details.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="p">(</span><span class="n">image_difference_position</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">change_sublattice_pseudo_inplace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">397</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">image_difference_position</span><span class="p">(</span><span class="n">sublattice</span><span class="o">=</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">3 new atoms found! Adding new atom positions.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)</span>
<span class="go">400</span>
</pre></div>
</div>
<p>One can now sort these atom positions into elements.</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.image_difference_position_new_sub">
<code class="descclassname">temul.model_creation.</code><code class="descname">image_difference_position_new_sub</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>sim_image</em>, <em>pixel_threshold</em>, <em>filename=None</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>num_peaks=5</em>, <em>add_sublattice=False</em>, <em>sublattice_name='sub_new'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.image_difference_position_new_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of atomap sublattice objects</em>) – </li>
<li><strong>sim_image</strong> (<em>simulated image used for comparison with sublattice image</em>) – </li>
<li><strong>pixel_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – minimum pixel distance from current sublattice atoms. If the new atomic
coordinates are greater than this distance, they will be created.
Choose a pixel_threshold that will not create new atoms in unrealistic
positions.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>num_peaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – number of new atoms to add</li>
<li><strong>add_sublattice</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – If set to True, a new sublattice will be created and returned.
The reason it is set to False is so that one can check if new atoms
would be added with the given parameters.</li>
<li><strong>sublattice_name</strong> (<em>string</em><em>, </em><em>default 'sub_new'</em>) – the outputted sublattice object name and sublattice.name the new
sublattice will be given</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># import atomap.dummy_data as dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Check without adding a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a new sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># if you have problems with mask_radius, increase it!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Just a gaussian fitting issue, could turn it off!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.print_sublattice_elements">
<code class="descclassname">temul.model_creation.</code><code class="descname">print_sublattice_elements</code><span class="sig-paren">(</span><em>sublattice</em>, <em>number_of_lines='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.print_sublattice_elements" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.model_creation.return_xyz_coordinates">
<code class="descclassname">temul.model_creation.</code><code class="descname">return_xyz_coordinates</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>z_thickness</em>, <em>z_bond_length</em>, <em>number_atoms_z=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_xyz_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce xyz coordinates for an xy coordinate given the z-dimension
information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>x</em><em>,</em>) – atom position coordinates.</li>
<li><strong>other parameters see return_z_coordinates</strong><strong>(</strong><strong>)</strong> (<em>for</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D numpy array with columns x, y, z</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_xyz_coordinates
# &gt;&gt;&gt; x, y = 2, 3
# &gt;&gt;&gt; atom_coords = return_xyz_coordinates(x, y,
# …                         z_thickness=10,
# …                         z_bond_length=1.5,
# …                         number_atoms_z=5)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.return_z_coordinates">
<code class="descclassname">temul.model_creation.</code><code class="descname">return_z_coordinates</code><span class="sig-paren">(</span><em>z_thickness</em>, <em>z_bond_length</em>, <em>number_atoms_z=None</em>, <em>max_number_atoms_z=None</em>, <em>fractional_coordinates=True</em>, <em>atom_layout='bot'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.return_z_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce fractional z-dimension coordinates for a given thickness and bond
length.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z_thickness</strong> (<em>number</em>) – Size (Angstrom) of the z-dimension.</li>
<li><strong>z_bond_length</strong> (<em>number</em>) – Size (Angstrom) of the bond length between adjacent atoms in the
z-dimension.</li>
<li><strong>number_atoms_z</strong> (<em>integer</em><em>, </em><em>default None</em>) – number of atoms in the z-dimension. If this is set to an interger
value, it will override the use of z_thickness.</li>
<li><strong>centered_atoms</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the z_coordinates will be centered about 0.5.
If set to False, the z_coordinate will start at 0.0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">1D numpy array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p># &gt;&gt;&gt; from temul.model_creation import return_z_coordinates
# &gt;&gt;&gt; Au_NP_z_coord = return_z_coordinates(z_thickness=20,
#       z_bond_length=1.5)</p>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.scaling_z_contrast">
<code class="descclassname">temul.model_creation.</code><code class="descname">scaling_z_contrast</code><span class="sig-paren">(</span><em>numerator_sublattice</em>, <em>numerator_element</em>, <em>denominator_sublattice</em>, <em>denominator_element</em>, <em>intensity_type</em>, <em>method</em>, <em>remove_background_method</em>, <em>background_sublattice</em>, <em>num_points</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>split_symbol='_'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.scaling_z_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Find new atomic coordinates by comparing experimental to simulated image.
Create a new sublattice to store the new atomic coordinates.</p>
<p>The aim is to change the sublattice elements so that the experimental image
agrees with the simulated image in a realistic manner.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>numerator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the numerator intensity will be calculated
according to Reference [1].</li>
<li><strong>numerator_element</strong> (<em>string</em>) – Element from which the numerator atomic number will be taken
according to Reference [1].</li>
<li><strong>denominator_sublattice</strong> (<em>Sublattice object</em>) – Sublattice from which the denominator intensity will be calculated
according to Reference [1].</li>
<li><strong>denominator_element</strong> (<em>string</em>) – Element from which the denominator atomic number will be taken
according to Reference [1].</li>
<li><strong>intensity_type</strong> (<em>string</em>) – Determines the method used to find the sublattice intensities.
The available methods are “max”, “mean”, “min”, “total” and
“all”.</li>
<li><strong>method</strong> (<em>string</em>) – Method used to calculate the intensity of the sublattices. Options are
“mean” or “mode”.</li>
<li><strong>remove_background_method</strong> (<em>string</em>) – Determines the method used to remove the background_sublattice
intensities from the image. Options are “average” and “local”.</li>
<li><strong>background_sub</strong> (<em>Sublattice object</em>) – The sublattice to be used if remove_background_method is used.</li>
<li><strong>num_points</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – If remove_background_method=”local”, num_points is the number
of nearest neighbour values averaged from background_sublattice.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Radius of the atomic column in pixels. If chosen, <cite>percent_to_nn</cite> must
be None.</li>
<li><strong>split_symbol</strong> (<em>string</em><em>, </em><em>default '_'</em>) – The symbols used to split the element into its name
and count.
The first string ‘_’ is used to split the name and count
of the element.
The second string has not been implemented within this function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Four floats</em></li>
<li><em>scaling_ratio, scaling_exponent, sublattice0_intensity_method,</em></li>
<li><em>sublattice1_intensity_method</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Reference: Krivanek et al. Nature 464, 10.1038/nature08879, (2010)</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.model_creation</span> <span class="kn">import</span> <span class="n">image_difference_position</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_with_vacancies_sublattice</span><span class="p">(</span>
<span class="gp">... </span>                                            <span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sim_image</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
</pre></div>
</div>
<p>Check without adding a new sublattice</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_difference_position_new_sub</span><span class="p">(</span><span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                          <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">percent_to_nn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">mask_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Add a new sublattice</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_new</span> <span class="o">=</span> <span class="n">image_difference_position_new_sub</span><span class="p">(</span>
<span class="gp">... </span>                                  <span class="n">sublattice_list</span><span class="o">=</span><span class="p">[</span><span class="n">sublattice</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">sim_image</span><span class="o">=</span><span class="n">sim_image</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">pixel_threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">num_peaks</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">add_sublattice</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">New Atoms Found! Adding to a new sublattice</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.model_creation.sort_sublattice_intensities">
<code class="descclassname">temul.model_creation.</code><code class="descname">sort_sublattice_intensities</code><span class="sig-paren">(</span><em>sublattice</em>, <em>intensity_type='max'</em>, <em>element_list=[]</em>, <em>scalar_method='mode'</em>, <em>middle_intensity_list=None</em>, <em>limit_intensity_list=None</em>, <em>remove_background_method=None</em>, <em>background_sublattice=None</em>, <em>num_points=3</em>, <em>intensity_list_real=False</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.model_creation.sort_sublattice_intensities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-temul.simulations">
<span id="image-simulation-functions"></span><h3>Image Simulation Functions<a class="headerlink" href="#module-temul.simulations" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.simulations.image_refine_via_intensity_loop">
<code class="descclassname">temul.simulations.</code><code class="descname">image_refine_via_intensity_loop</code><span class="sig-paren">(</span><em>atom_lattice</em>, <em>change_sublattice</em>, <em>calibration_separation</em>, <em>calibration_area</em>, <em>percent_to_nn</em>, <em>mask_radius</em>, <em>element_list</em>, <em>image_sampling</em>, <em>iterations</em>, <em>delta_image_filter</em>, <em>image_size_x_nm</em>, <em>image_size_y_nm</em>, <em>image_size_z_nm</em>, <em>simulation_filename</em>, <em>filename</em>, <em>intensity_type</em>, <em>intensity_refine_name='intensity_refine_'</em>, <em>folder_name='refinement_of_intensity'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.image_refine_via_intensity_loop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.simulations.image_refine_via_position_loop">
<code class="descclassname">temul.simulations.</code><code class="descname">image_refine_via_position_loop</code><span class="sig-paren">(</span><em>image</em>, <em>sublattice_list</em>, <em>filename</em>, <em>xyz_filename</em>, <em>add_sublattice</em>, <em>pixel_threshold</em>, <em>num_peaks</em>, <em>image_size_x_nm</em>, <em>image_size_y_nm</em>, <em>image_size_z_nm</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>element_list</em>, <em>element_list_new_sub</em>, <em>middle_intensity_list</em>, <em>limit_intensity_list</em>, <em>delta_image_filter=0.5</em>, <em>intensity_type='max'</em>, <em>scalar_method='mode'</em>, <em>remove_background_method=None</em>, <em>background_sublattice=None</em>, <em>num_points=3</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>iterations=10</em>, <em>max_sigma=10</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.image_refine_via_position_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Image Position Loop</p>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_and_calibrate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_and_calibrate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>scalebar_true=False</em>, <em>probeStep=None</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_and_calibrate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with the PyPrismatic fast simulation
software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz_filename</strong> (<em>string</em>) – filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>reference_image</strong> (<em>hyperspy signal 2D</em>) – image from which calibration information is taken, such
as sampling, pixel height and pixel width</li>
<li><strong>calibration_area</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – xy pixel coordinates of the image area to be used to calibrate
the intensity. In the form [[0,0], [512,512]]
See calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>calibration_separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – pixel separation used for the intensity calibration.
See calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>scalebar_true</strong> (<em>refine</em><em>,</em>) – See function calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>E0 ... etc.</strong> (<em>probeStep</em><em>,</em>) – See function simulate_with_prismatic()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_and_filter_and_calibrate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_and_filter_and_calibrate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image</em>, <em>calibration_area</em>, <em>calibration_separation</em>, <em>delta_image_filter=0.1</em>, <em>max_sigma=6</em>, <em>percent_to_nn=0.4</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>scalebar_true=False</em>, <em>probeStep=None</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_and_filter_and_calibrate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with the PyPrismatic fast simulation
software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz_filename</strong> (<em>string</em>) – filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>reference_image</strong> (<em>hyperspy signal 2D</em>) – image from which calibration information is taken, such
as sampling, pixel height and pixel width</li>
<li><strong>calibration_area</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – xy pixel coordinates of the image area to be used to calibrate
the intensity. In the form [[0,0], [512,512]]
See calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>calibration_separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – pixel separation used for the intensity calibration.
See calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.40</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – Radius of the mask around each atom. If this is not set,
the radius will be the distance to the nearest atom in the
same sublattice times the <cite>percent_to_nn</cite> value.
Note: if <cite>mask_radius</cite> is not specified, the Atom_Position objects
must have a populated nearest_neighbor_list.</li>
<li><strong>scalebar_true</strong> (<em>refine</em><em>,</em>) – See function calibrate_intensity_distance_with_sublattice_roi()</li>
<li><strong>E0 ... etc.</strong> (<em>probeStep</em><em>,</em>) – See function simulate_with_prismatic()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.simulations.simulate_with_prismatic">
<code class="descclassname">temul.simulations.</code><code class="descname">simulate_with_prismatic</code><span class="sig-paren">(</span><em>xyz_filename</em>, <em>filename</em>, <em>reference_image=None</em>, <em>probeStep=1.0</em>, <em>E0=60000.0</em>, <em>integrationAngleMin=0.085</em>, <em>integrationAngleMax=0.186</em>, <em>detectorAngleStep=0.001</em>, <em>interpolationFactor=16</em>, <em>realspacePixelSize=0.0654</em>, <em>numFP=1</em>, <em>cellDimXYZ=None</em>, <em>tileXYZ=None</em>, <em>probeSemiangle=0.03</em>, <em>alphaBeamMax=0.032</em>, <em>scanWindowMin=0.0</em>, <em>scanWindowMax=1.0</em>, <em>algorithm='prism'</em>, <em>numThreads=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.simulations.simulate_with_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate an xyz coordinate model with pyprismatic
fast simulation software.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz_filename</strong> (<em>string</em>) – filename of the xyz coordinate model. Must be in the prismatic format.
See <a class="reference external" href="http://prism-em.com/docs-inputs/">http://prism-em.com/docs-inputs/</a> for more information.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – name with which the image will be saved</li>
<li><strong>reference_image</strong> (<em>hyperspy signal 2D</em>) – image from which calibration information is taken, such
as sampling, pixel height and pixel width</li>
<li><strong>probeStep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 1.0</em>) – Should be the sampling of the image, where
sampling = length (in angstrom)/pixels
If you want the probeStep to be calculated from the reference image,
set this to None.</li>
<li><strong>numThreads etc.</strong><strong>,</strong> (<em>E0</em><em>,</em>) – See <a class="reference external" href="http://prism-em.com/docs-params/">http://prism-em.com/docs-params/</a></li>
<li><strong>cellDimXYZ</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><em>default None</em>) – A tuple of length 3. Example (2.3, 4.5, 5.6).
If this is set to None, the cell dimension values from the .xyz file
will be used (default). If it is specified, it will overwrite the .xyz
file values.</li>
<li><strong>tileXYZ</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><em>default None</em>) – A tuple of length 3. Example (5, 5, 2) would multiply the model in x
and y by 5, and z by 2.
Default of None is just set to (1, 1, 1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Simulated image as a 2D .mrc file</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.simulations</span> <span class="kn">import</span> <span class="n">simulate_with_prismatic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_path</span> <span class="o">=</span> <span class="n">path_to_example_data_MoS2_hex_prismatic</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulate_with_prismatic</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">xyz_filename</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;prismatic_simulation&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">probeStep</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">reference_image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">E0</span><span class="o">=</span><span class="mf">60e3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">integrationAngleMin</span><span class="o">=</span><span class="mf">0.085</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">integrationAngleMax</span><span class="o">=</span><span class="mf">0.186</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">interpolationFactor</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">realspacePixelSize</span><span class="o">=</span><span class="mf">0.0654</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">numFP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">probeSemiangle</span><span class="o">=</span><span class="mf">0.030</span><span class="p">,</span> <span class="n">alphaBeamMax</span><span class="o">=</span><span class="mf">0.032</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">scanWindowMin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scanWindowMax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;prism&quot;</span><span class="p">,</span> <span class="n">numThreads</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.signal_processing">
<span id="signal-processing"></span><h3>Signal Processing<a class="headerlink" href="#module-temul.signal_processing" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi">
<code class="descclassname">temul.signal_processing.</code><code class="descname">calibrate_intensity_distance_with_sublattice_roi</code><span class="sig-paren">(</span><em>image</em>, <em>cropping_area</em>, <em>separation</em>, <em>reference_image=None</em>, <em>scalebar_true=False</em>, <em>percent_to_nn=0.2</em>, <em>mask_radius=None</em>, <em>refine=True</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.calibrate_intensity_distance_with_sublattice_roi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrates the intensity of an image by using the brightest sublattice.
The mean intensity of that sublattice is set to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to calibrate.</li>
<li><strong>cropping_area</strong> (<em>list of 2 floats</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</li>
<li><strong>separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – Pixel separation between atoms as used by Atomap.</li>
<li><strong>reference_image</strong> (<em>Hyperspy Signal2D</em>) – Image with which <cite>image</cite> is compared.</li>
<li><strong>scalebar_true</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the function assumes that <cite>image.axes_manager</cite> is
calibrated to a unit other than pixel.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.2</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>refine</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the atom positions found for the calibration will be
refined.</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the image will be saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Nothing, but the mean intensity of the brightest sublattice is set to 1.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_a</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">choose_points_on_image</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="c1">#  manually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span> <span class="c1">#  use above line if trying yourself!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># tml.calibrate_intensity_distance_with_sublattice_roi(image, crop_a, 10)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image.plot()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.choose_mask_coordinates">
<code class="descclassname">temul.signal_processing.</code><code class="descname">choose_mask_coordinates</code><span class="sig-paren">(</span><em>image</em>, <em>norm='log'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.choose_mask_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the mask locations for an FFT. See get_masked_ifft() for examples and
commit 5ba307b5af0b598bedc0284aa989d44e23fdde4d on Atomap for more details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>Hyperspy 2D Signal</em>) – </li>
<li><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;log&quot;</em>) – How to scale the intensity value for the displayed image.
Options are “linear” and “log”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of pixel coordinates</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.compare_two_image_and_create_filtered_image">
<code class="descclassname">temul.signal_processing.</code><code class="descname">compare_two_image_and_create_filtered_image</code><span class="sig-paren">(</span><em>image_to_filter, reference_image, delta_image_filter, max_sigma=6, cropping_area=[[0, 0], [50, 50]], separation=8, filename=None, percent_to_nn=0.4, mask_radius=None, refine=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.compare_two_image_and_create_filtered_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian blur an image for comparison with a reference image.
Good for finding the best gaussian blur for a simulation by
comparing to an experimental image.
See measure_image_errors() and load_and_compare_images().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_to_filter</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to automatically filter.</li>
<li><strong>reference_image</strong> (<em>Hyperspy Signal2D</em>) – Image with which <cite>image_to_filter</cite> is compared.</li>
<li><strong>delta_image_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The increment of the Gaussian sigma used.</li>
<li><strong>max_sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 6</em>) – The largest (limiting) Gaussian sigma used.</li>
<li><strong>cropping_area</strong> (<em>list of 2 floats</em><em>, </em><em>default</em><em> [</em><em>[</em><em>0</em><em>,</em><em>0</em><em>]</em><em>, </em><em>[</em><em>50</em><em>,</em><em>50</em><em>]</em><em>]</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</li>
<li><strong>separation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 8</em>) – Pixel separation between atoms as used by Atomap.</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the plotted and filtered image will be saved.</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.4</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask. If set, then set <cite>percent_to_nn=None</cite>.</li>
<li><strong>refine</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the <cite>calibrate_intensity_distance_with_sublattice_roi</cite>
calibration will refine the atom positions for each calibration. May
make the function very slow depending on the size of <cite>image_to_filter</cite>
and <cite>cropping_area</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Hyperspy Signal2D (filtered image) and float (ideal Gaussian sigma)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.filters</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">compare_two_image_and_create_filtered_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span> <span class="c1"># example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">experiment</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">simulation</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
</pre></div>
</div>
<dl class="docutils">
<dt>filt_image, ideal_sigma = compare_two_image_and_create_filtered_image(</dt>
<dd>simulation, experiment, 0.25, cropping_area=[[5,5], [200, 200]],
separation=11, mask_radius=4, percent_to_nn=None, max_sigma=10)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.crop_image_hs">
<code class="descclassname">temul.signal_processing.</code><code class="descname">crop_image_hs</code><span class="sig-paren">(</span><em>image</em>, <em>cropping_area</em>, <em>scalebar_true=True</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.crop_image_hs" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop a Hyperspy Signal2D by providing the <cite>cropping_area</cite>. See the example
below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image you wish to crop</li>
<li><strong>cropping_area</strong> (<em>list of 2 floats</em>) – The best method of choosing the area is by using the function
“choose_points_on_image(image.data)”. Choose two points on the
image. First point is top left of area, second point is bottom right.</li>
<li><strong>scalebar_true</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If set to True, the function assumes that <cite>image.axes_manager</cite> is
calibrated to a unit other than pixel.</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the images and cropping variables will be saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Choose two points on the image, top left and bottom right of crop</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cropping_area</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">choose_points_on_image</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropping_area</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">]]</span> <span class="c1"># use above line if trying yourself!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image_cropped = tml.crop_image_hs(image, cropping_area, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># image_cropped.plot()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.distance_vector">
<code class="descclassname">temul.signal_processing.</code><code class="descname">distance_vector</code><span class="sig-paren">(</span><em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.distance_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_processing.double_gaussian_fft_filter">
<code class="descclassname">temul.signal_processing.</code><code class="descname">double_gaussian_fft_filter</code><span class="sig-paren">(</span><em>image</em>, <em>fwhm_neg</em>, <em>fwhm_pos</em>, <em>neg_min=0.9</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.double_gaussian_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter an image with a bandpass-like filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image</strong> (<em>Hyperspy Signal2D</em>) – </li>
<li><strong>fwhm_pos</strong> (<em>fwhm_neg</em><em>,</em>) – Initial guess in pixels of full width at half maximum (fwhm) of
inner (negative) and outer (positive) Gaussian to be applied to fft,
respectively.
Use the visualise_dg_filter function to find the optimium values.</li>
<li><strong>neg_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.9</em>) – Effective amplitude of the negative Gaussian.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.example_data</span> <span class="kn">import</span> <span class="n">load_Se_implanted_MoS2_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
</pre></div>
</div>
<p>Use the visualise_dg_filter to find suitable FWHMs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">visualise_dg_filter</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>then use these values to carry out the double_gaussian_fft_filter</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">double_gaussian_fft_filter</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.double_gaussian_fft_filter_optimised">
<code class="descclassname">temul.signal_processing.</code><code class="descname">double_gaussian_fft_filter_optimised</code><span class="sig-paren">(</span><em>image</em>, <em>d_inner</em>, <em>d_outer</em>, <em>delta=0.05</em>, <em>sampling=None</em>, <em>units=None</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.double_gaussian_fft_filter_optimised" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter an image with an double Gaussian (band-pass) filter. The function
will automatically find the optimum magnitude of the negative inner
Gaussian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>Hyperspy Signal2D</em>) – Image to be filtered.</li>
<li><strong>d_inner</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Inner diameter of the FFT spots. Effectively the diameter of the
negative Gaussian.</li>
<li><strong>d_outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Outer diameter of the FFT spots. Effectively the diameter of the
positive Gaussian.</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.05</em>) – Increment of the automatic filtering with the negative Gaussian.
Setting this very small will slow down the function, but too high will
not allow the function to calculate negative Gaussians near zero.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – image sampling in units/pixel. If set to None, the image.axes_manager
will be used.</li>
<li><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Real space units. <cite>sampling</cite> should then be the value of
these units/pixel. If set to None, the image.axes_manager
will be used.</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the following files will be plotted and saved:
negative Gaussian optimumisation, negative Gaussian, positive Gaussian,
double Gaussian, FFT and double Gaussian convolution, filtered image,
filtered variables table.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Hyperspy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">double_gaussian_fft_filter</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">7.48</span><span class="p">,</span> <span class="mf">14.96</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.fit_1D_gaussian_to_data">
<code class="descclassname">temul.signal_processing.</code><code class="descname">fit_1D_gaussian_to_data</code><span class="sig-paren">(</span><em>xdata</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.fit_1D_gaussian_to_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitting function for a single 1D gaussian distribution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xdata</strong> (<em>numpy 1D array</em>) – values input as the x coordinates of the gaussian distribution</li>
<li><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – amplitude of the gaussian in y-axis</li>
<li><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – mean value of the gaussianin x-axis, corresponding to y-axis
amplitude.</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – standard deviation of the gaussian distribution</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">gaussian distibution of xdata array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_xydata_from_list_of_intensities</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fit_1D_gaussian_to_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gauss_fit_01</span> <span class="o">=</span> <span class="n">fit_1D_gaussian_to_data</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_cell_image">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_cell_image</code><span class="sig-paren">(</span><em>s</em>, <em>points_x</em>, <em>points_y</em>, <em>method='Voronoi'</em>, <em>max_radius='Auto'</em>, <em>reduce_func=&lt;function amin&gt;</em>, <em>show_progressbar=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_cell_image" title="Permalink to this definition">¶</a></dt>
<dd><p>The same as atomap’s integrate, except instead of summing the
region around an atom, it removes the value from all pixels in
that region.
For example, with this you can remove the local background intensity
by setting reduce_func=np.min.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>reduce_func</strong> (<em>ufunc</em><em>, </em><em>default np.min</em>) – function used to reduce the pixel values around each atom
to a float.</li>
<li><strong>the other parameters see Atomap's integrate function.</strong> (<em>For</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Numpy array with the same shape as s</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">get_cell_image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span> <span class="o">=</span> <span class="n">get_cell_image</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">image</span><span class="p">,</span> <span class="n">sublattice</span><span class="o">.</span><span class="n">x_position</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">y_position</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the <cite>cell_image</cite> which shows, in this case, the background intensity</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cell_image</span><span class="p">)</span>
</pre></div>
</div>
<p>Convert it to a Hyperspy Signal2D object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">signals</span><span class="o">.</span><span class="n">Signal2D</span><span class="p">(</span><span class="n">cell_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cell_image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_fitting_tools_for_plotting_gaussians">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_fitting_tools_for_plotting_gaussians</code><span class="sig-paren">(</span><em>element_list</em>, <em>scaled_middle_intensity_list</em>, <em>scaled_limit_intensity_list</em>, <em>fit_bright_first=True</em>, <em>gaussian_amp=5</em>, <em>gauss_sigma_division=100</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_fitting_tools_for_plotting_gaussians" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a list of parameters and details for fitting the intensities of a
sublattice with multiple Gaussians.</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_masked_ifft">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_masked_ifft</code><span class="sig-paren">(</span><em>image</em>, <em>mask_coords</em>, <em>mask_radius=10</em>, <em>image_space='real'</em>, <em>keep_masked_area=True</em>, <em>plot_masked_fft=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_masked_ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an inverse fast Fourier transform (iFFT) from an image and mask
coordinates. Use <cite>choose_mask_coordinates</cite> to manually choose mask
coordinates in the FFT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>Hyperspy 2D Signal</em>) – </li>
<li><strong>mask_coords</strong> (<em>list of pixel coordinates</em>) – Pixel coordinates of the masking locations. See the example below for
two simple coordinates found using <cite>choose_mask_coordinates</cite>.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 10</em>) – Radius in pixels of the mask.</li>
<li><strong>image_space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default &quot;real&quot;</em>) – If the input image is in Fourier/diffraction/reciprocal space already,
set space=”fourier”.</li>
<li><strong>keep_masked_area</strong> (<em>Bool</em><em>, </em><em>default True</em>) – If True, this will set the mask at the mask_coords.
If False, this will set the mask as everything other than the
mask_coords. Can be thought of as inversing the mask.</li>
<li><strong>plot_masked_fft</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If True, the mask used to filter the FFT will be plotted. Good for
checking that the mask is doing what you want. Can fail sometimes due
to matplotlib plotting issues.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Inverse FFT as a Hyperspy 2D Signal</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_coords</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">choose_mask_coordinates</span><span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="c1">#  manually</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_coords</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">170.2</span><span class="p">,</span> <span class="mf">170.8</span><span class="p">],[</span><span class="mf">129.8</span><span class="p">,</span> <span class="mi">130</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the masked fft:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use unmasked fft area and plot the masked fft:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span> <span class="n">plot_masked_fft</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_masked_area</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If the input image is already a Fourier transform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fft_image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">get_masked_ifft</span><span class="p">(</span><span class="n">fft_image</span><span class="p">,</span> <span class="n">mask_coords</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">image_space</span><span class="o">=</span><span class="s1">&#39;fourier&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_scaled_middle_limit_intensity_list">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_scaled_middle_limit_intensity_list</code><span class="sig-paren">(</span><em>sublattice</em>, <em>middle_intensity_list</em>, <em>limit_intensity_list</em>, <em>sublattice_scalar</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_scaled_middle_limit_intensity_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the middle and limit lists scaled to the actual intensities in the
sublattice. Useful for get_fitting_tools_for_plotting_gaussians().</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.get_xydata_from_list_of_intensities">
<code class="descclassname">temul.signal_processing.</code><code class="descname">get_xydata_from_list_of_intensities</code><span class="sig-paren">(</span><em>sublattice_intensity_list</em>, <em>hist_bins=100</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.get_xydata_from_list_of_intensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Output x and y data for a histogram of intensities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_intensity_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – See get_subattice_intensity() for more information</li>
<li><strong>hist_bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 100</em>) – number of bins to sort the intensities into
must be a better way of doing this? maybe automate the binning choice</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Two numpy 1D arrays corressponding to the x and y values of a histogram</em></li>
<li><em>of the sublattice intensities.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">get_xydata_from_list_of_intensities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.load_and_compare_images">
<code class="descclassname">temul.signal_processing.</code><code class="descname">load_and_compare_images</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.load_and_compare_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Load two images with hyperspy and compare their mean square error and
structural simularity index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imageB</strong> (<em>imageA</em><em>,</em>) – filename of the images to be loaded and compared</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – name with which the image will be saved</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Two floats (mean standard error and structural simularity index)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.make_gaussian">
<code class="descclassname">temul.signal_processing.</code><code class="descname">make_gaussian</code><span class="sig-paren">(</span><em>size</em>, <em>fwhm</em>, <em>center=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.make_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a square gaussian kernel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The length of a side of the square</li>
<li><strong>fwhm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The full-width-half-maximum of the Gaussian, which can be thought of as
an effective radius.</li>
<li><strong>center</strong> (<em>array</em><em>, </em><em>default None</em>) – The location of the center of the Gaussian. None will set it to the
center of the array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2D Numpy array</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="n">make_gaussian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">make_gaussian</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.make_gaussian_pos_neg">
<code class="descclassname">temul.signal_processing.</code><code class="descname">make_gaussian_pos_neg</code><span class="sig-paren">(</span><em>size</em>, <em>fwhm_neg</em>, <em>fwhm_pos</em>, <em>neg_min=0.9</em>, <em>center=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.make_gaussian_pos_neg" title="Permalink to this definition">¶</a></dt>
<dd><p>See double_gaussian_fft_filter for details</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.mean_and_std_nearest_neighbour_distances">
<code class="descclassname">temul.signal_processing.</code><code class="descname">mean_and_std_nearest_neighbour_distances</code><span class="sig-paren">(</span><em>sublattice</em>, <em>nearest_neighbours=5</em>, <em>sampling=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mean_and_std_nearest_neighbour_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates mean and standard deviation of the distance from each atom to
its nearest neighbours.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>nearest_neighbours</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 5</em>) – The number of nearest neighbours used to calculate the mean distance
from an atom. As in atomap, choosing 5 gets the 4 nearest
neighbours.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The image sampling in units/pixel. If set to None then the values
returned are given in pixels.
This may be changed in future versions if Atomap’s Sublattice pixel
attribute is updated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Two lists</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of mean distances, list of standard deviations.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sublattice</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_scaled</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mean_and_std_nearest_neighbour_distances</span><span class="p">(</span><span class="n">sublattice</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sampling</span><span class="o">=</span><span class="mf">0.0123</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.measure_image_errors">
<code class="descclassname">temul.signal_processing.</code><code class="descname">measure_image_errors</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.measure_image_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the Mean Squared Error (mse) and Structural Similarity Index (ssm)
between two images.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>imageB</strong> (<em>imageA</em><em>,</em>) – Two images between which to measure mse and ssm</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – name with which the image will be saved</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">two floats (mse_number, ssm_number)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span> <span class="o">=</span> <span class="n">measure_image_errors</span><span class="p">(</span><span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">)</span>
</pre></div>
</div>
<p>Showing the ideal case of both images being exactly equal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">imageA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span> <span class="o">=</span> <span class="n">measure_image_errors</span><span class="p">(</span><span class="n">imageA</span><span class="p">,</span> <span class="n">imageA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MSE: </span><span class="si">{}</span><span class="s2"> and SSM: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mse_number</span><span class="p">,</span> <span class="n">ssm_number</span><span class="p">))</span>
<span class="go">MSE: 0.0 and SSM: 1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.mse">
<code class="descclassname">temul.signal_processing.</code><code class="descname">mse</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.mse" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure the mean squared error between two images of the same shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>imageB</strong> (<em>imageA</em><em>,</em>) – The images must be the same shape.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Mean squared error</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.plot_gaussian_fit">
<code class="descclassname">temul.signal_processing.</code><code class="descname">plot_gaussian_fit</code><span class="sig-paren">(</span><em>xdata</em>, <em>ydata</em>, <em>function</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em>, <em>gauss_art='r--'</em>, <em>gauss_label='Gauss Fit'</em>, <em>plot_data=True</em>, <em>data_art='ko'</em>, <em>data_label='Data Points'</em>, <em>plot_fill=False</em>, <em>facecolor='r'</em>, <em>alpha=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fit" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">plot_gaussian_fit</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">return_fitting_of_1D_gaussian</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt_gauss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">return_fitting_of_1D_gaussian</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_gaussian_fit</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">amp</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="n">popt_gauss</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>          <span class="n">gauss_art</span><span class="o">=</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">gauss_label</span><span class="o">=</span><span class="s1">&#39;Gauss Fit&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_art</span><span class="o">=</span><span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s1">&#39;Data Points&#39;</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">plot_fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.plot_gaussian_fitting_for_multiple_fits">
<code class="descclassname">temul.signal_processing.</code><code class="descname">plot_gaussian_fitting_for_multiple_fits</code><span class="sig-paren">(</span><em>sub_ints_all, fitting_tools_all_subs, element_list_all_subs, marker_list, hist_bins=150, plotting_style='hist', filename='Fit of Intensities', mpl_cmaps_list=['viridis']</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.plot_gaussian_fitting_for_multiple_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>plots Gaussian distributions for intensities of a sublattice, over the
given parameters (fitting tools).</p>
<p class="rubric">Examples</p>
<p>sub_ints_all = [sub1_ints, sub2_ints]
marker_list = [[‘Sub1’, ‘.’],[‘Sub2’, ‘x’]]</p>
<dl class="docutils">
<dt>middle_intensity_list_real_sub1, limit_intensity_list_real_sub1 =         make_middle_limit_intensity_list_real(</dt>
<dd>sublattice=sub1,
middle_intensity_list=middle_intensity_list_sub1,
limit_intensity_list=limit_intensity_list_sub1,
method=method,
sublattice_scalar=sub1_mode)</dd>
<dt>middle_intensity_list_real_sub2, limit_intensity_list_real_sub2 =         make_middle_limit_intensity_list_real(</dt>
<dd>sublattice=sub2,
middle_intensity_list=middle_intensity_list_sub2,
limit_intensity_list=limit_intensity_list_sub2,
method=method,
sublattice_scalar=sub2_mode)</dd>
</dl>
<p>element_list_all_subs = [element_list_sub1, element_list_sub2]</p>
<dl class="docutils">
<dt>fitting_tools_all_subs = [</dt>
<dd><dl class="first last docutils">
<dt>get_fitting_tools_for_plotting_gaussians(</dt>
<dd>element_list_sub1,
middle_intensity_list_real_sub1,
limit_intensity_list_real_sub1),</dd>
<dt>get_fitting_tools_for_plotting_gaussians(</dt>
<dd>element_list_sub2,
middle_intensity_list_real_sub2,
limit_intensity_list_real_sub2)
]</dd>
</dl>
</dd>
<dt>plot_gaussian_fitting_for_multiple_fits(sub_ints_all,</dt>
<dd>fitting_tools_all_subs,
element_list_all_subs,
marker_list,
hist_bins=500,
filename=’Fit of Intensities900’)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.remove_image_intensity_in_data_slice">
<code class="descclassname">temul.signal_processing.</code><code class="descname">remove_image_intensity_in_data_slice</code><span class="sig-paren">(</span><em>atom</em>, <em>image_data</em>, <em>percent_to_nn=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.remove_image_intensity_in_data_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove intensity from the area around an atom in a
sublattice</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.return_fitting_of_1D_gaussian">
<code class="descclassname">temul.signal_processing.</code><code class="descname">return_fitting_of_1D_gaussian</code><span class="sig-paren">(</span><em>function</em>, <em>xdata</em>, <em>ydata</em>, <em>amp</em>, <em>mu</em>, <em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.return_fitting_of_1D_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Use the initially found centre (mean/mode) value of a sublattice
histogram (e.g., Mo_1 in an Mo sublattice) as an input mean for a
gaussian fit of the data.</p>
<p>xdata, ydata : see scipy.optimize.curve_fit
amp, mu, sigma : see fit_1D_gaussian_to_data() for more details</p>
<p>optimised parameters (popt) and estimated covariance (pcov) of the
fitted gaussian function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.signal_processing</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_xydata_from_list_of_intensities</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">return_fitting_of_1D_gaussian</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">fit_1D_gaussian_to_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub1_inten</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">get_xydata_from_list_of_intensities</span><span class="p">(</span><span class="n">sub1_inten</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">hist_bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">popt_gauss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">return_fitting_of_1D_gaussian</span><span class="p">(</span>
<span class="gp">... </span>                    <span class="n">fit_1D_gaussian_to_data</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">amp</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<p># print(“Calculated Mean: ” + str(round(np.mean(xdata),3))
# + “</p>
</div></blockquote>
<p>Fitted Mean: ” + str(round(popt_gauss[1],3)))</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.sine_wave_function_strain_gradient">
<code class="descclassname">temul.signal_processing.</code><code class="descname">sine_wave_function_strain_gradient</code><span class="sig-paren">(</span><em>x</em>, <em>a</em>, <em>b</em>, <em>c</em>, <em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.sine_wave_function_strain_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_processing.toggle_atom_refine_position_automatically">
<code class="descclassname">temul.signal_processing.</code><code class="descname">toggle_atom_refine_position_automatically</code><span class="sig-paren">(</span><em>sublattice</em>, <em>min_cut_off_percent</em>, <em>max_cut_off_percent</em>, <em>range_type='internal'</em>, <em>method='mode'</em>, <em>percent_to_nn=0.05</em>, <em>mask_radius=None</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.toggle_atom_refine_position_automatically" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the ‘refine_position’ attribute of each Atom Position in a
sublattice using a range of intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice</strong> (<em>Atomap Sublattice object</em>) – </li>
<li><strong>min_cut_off_percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The lower end of the intensity range is defined as
<cite>min_cut_off_percent</cite> * <cite>method</cite> value of max intensity list of
<cite>sublattice</cite>.</li>
<li><strong>max_cut_off_percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default None</em>) – The upper end of the intensity range is defined as
<cite>max_cut_off_percent</cite> * <cite>method</cite> value of max intensity list of
<cite>sublattice</cite>.</li>
<li><strong>range_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default 'internal'</em>) – “internal” provides the <cite>refine_position</cite> attribute for each
<cite>Atom Position</cite> as True if the intensity of that Atom Position
lies between the lower and upper limits defined by
<cite>min_cut_off_percent</cite> and <cite>max_cut_off_percent</cite>.
“external” provides the <cite>refine_position</cite> attribute for each
<cite>Atom Position</cite> as True if the intensity of that Atom Position
lies outside the lower and upper limits defined by
<cite>min_cut_off_percent</cite> and <cite>max_cut_off_percent</cite>.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default 'mode'</em>) – The method used to aggregate the intensity of the sublattice positions
max intensity list. Options are “mode” and “mean”</li>
<li><strong>percent_to_nn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.05</em>) – Determines the boundary of the area surrounding each atomic
column, as fraction of the distance to the nearest neighbour.</li>
<li><strong>mask_radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – Radius in pixels of the mask.</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>default None</em>) – If set to a string, the Atomap <cite>refine_position</cite> image will be saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of the <cite>AtomPosition.refine_position=False</cite> attribute.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice_positions_on_vac</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">find_nearest_neighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">min_cut_off_percent</span> <span class="o">=</span> <span class="mf">0.75</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_cut_off_percent</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">false_list_sublattice</span> <span class="o">=</span>  <span class="n">tml</span><span class="o">.</span><span class="n">toggle_atom_refine_position_automatically</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">sublattice</span><span class="p">,</span> <span class="n">min_cut_off_percent</span><span class="p">,</span> <span class="n">max_cut_off_percent</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">range_type</span><span class="o">=</span><span class="s1">&#39;internal&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mode&#39;</span><span class="p">,</span> <span class="n">percent_to_nn</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">false_list_sublattice</span><span class="p">)</span> <span class="c1"># check how many atoms will not be refined</span>
<span class="go">12</span>
</pre></div>
</div>
<p>Visually check which atoms will not be refined (red dots)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">toggle_atom_refine_position_with_gui</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_processing.visualise_dg_filter">
<code class="descclassname">temul.signal_processing.</code><code class="descname">visualise_dg_filter</code><span class="sig-paren">(</span><em>image</em>, <em>d_inner=7.7</em>, <em>d_outer=21</em>, <em>slider_min=0.1</em>, <em>slider_max=300</em>, <em>slider_step=0.1</em>, <em>plot_lims=(0</em>, <em>1)</em>, <em>figsize=(15</em>, <em>7)</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_processing.visualise_dg_filter" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image</strong> (<em>Hyperspy Signal2D</em>) – This image.axes_manager scale should be calibrated.</li>
<li><strong>d_inner</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 7.7</em>) – Initial ‘guess’ of full width at half maximum (fwhm) of
inner (negative) gaussian to be applied to fft.
Can be changed with sliders during visualisation.</li>
<li><strong>d_outer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 14</em>) – Initial ‘guess’ of full width at half maximum (fwhm) of
outer (positive) gaussian to be applied to fft.
Can be changed with sliders during visualisation.</li>
<li><strong>slider_min</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.1</em>) – Minimum value on sliders</li>
<li><strong>slider_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 300</em>) – Maximum value on sliders</li>
<li><strong>slider_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0.1</em>) – Step size on sliders</li>
<li><strong>plot_lims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><em>default</em><em> (</em><em>0</em><em>, </em><em>1</em><em>)</em>) – Used to plot a smaller section of the FFT image, which can be useful if
the information is very small (far away!). Default plots the whole
image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.example_data</span> <span class="kn">import</span> <span class="n">load_Se_implanted_MoS2_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">visualise_dg_filter</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-temul.signal_plotting">
<span id="signal-plotting"></span><h3>Signal Plotting<a class="headerlink" href="#module-temul.signal_plotting" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity">
<em class="property">class </em><code class="descclassname">temul.signal_plotting.</code><code class="descname">Sublattice_Hover_Intensity</code><span class="sig-paren">(</span><em>image</em>, <em>sublattice</em>, <em>sublattice_positions</em>, <em>background_sublattice</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity" title="Permalink to this definition">¶</a></dt>
<dd><p>User can hover over sublattice overlaid on STEM image to display the
x,y location and intensity of that point.</p>
<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.scaled">
<code class="descname">scaled</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.scaled" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation">
<code class="descname">setup_annotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.setup_annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw and hide the annotation box.</p>
</dd></dl>

<dl class="method">
<dt id="temul.signal_plotting.Sublattice_Hover_Intensity.snap">
<code class="descname">snap</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.Sublattice_Hover_Intensity.snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value in self.tree closest to x, y.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.choose_points_on_image">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">choose_points_on_image</code><span class="sig-paren">(</span><em>image</em>, <em>norm='linear'</em>, <em>distance_threshold=4</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.choose_points_on_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.color_palettes">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">color_palettes</code><span class="sig-paren">(</span><em>pallette</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.color_palettes" title="Permalink to this definition">¶</a></dt>
<dd><p>Color sequences that are useful for creating matplotlib colormaps.
Info on “zesty” and other options:
venngage.com/blog/color-blind-friendly-palette/
Info on “r_safe”:
Google: r-plot-color-combinations-that-are-colorblind-accessible</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Options are “zesty” (4 colours), and “r_safe” (12 colours).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of hex colours</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_one_image">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_one_image</code><span class="sig-paren">(</span><em>image</em>, <em>line_profile_positions</em>, <em>linewidth=1</em>, <em>sampling='Auto'</em>, <em>units='pix'</em>, <em>arrow=None</em>, <em>linetrace=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_one_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on one image with the line profile intensities
in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image</strong> (<em>2D Hyperspy signal</em>) – </li>
<li><strong>line_profile_positions</strong> (<em>list of lists</em>) – two line profile coordinates. Use atomap’s am.add_atoms_with_gui()
function to get these. The first two dots will trace the first line
profile etc.
Could be extended to n positions with a basic loop.</li>
<li><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'Auto'</em>) – <dl class="docutils">
<dt>if set to ‘Auto’ the function will attempt to find the sampling of</dt>
<dd>image from image.axes_manager[0].scale.</dd>
<dt>arrow <span class="classifier-delimiter">:</span> <span class="classifier">string, default None</span></dt>
<dd>If set, arrows will be plotting on the image. Options are ‘h’ and
‘v’ for horizontal and vertical arrows, respectively.</dd>
</dl>
</li>
<li><strong>linetrace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default None</em>) – If set, the line profile will be plotted on the image.
The thickness of the linetrace will be linewidth*linetrace.
Name could be improved maybe.</li>
<li><strong>kwargs</strong> (<em>Matplotlib keyword arguments passed to imshow</em><em>(</em><em>)</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.compare_images_line_profile_two_images">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">compare_images_line_profile_two_images</code><span class="sig-paren">(</span><em>imageA</em>, <em>imageB</em>, <em>line_profile_positions</em>, <em>reduce_func=&lt;function mean&gt;</em>, <em>filename=None</em>, <em>linewidth=1</em>, <em>sampling='auto'</em>, <em>units='nm'</em>, <em>crop_offset=20</em>, <em>title='Intensity Profile'</em>, <em>imageA_title='Experiment'</em>, <em>imageB_title='Simulation'</em>, <em>marker_A='v'</em>, <em>marker_B='o'</em>, <em>arrow_markersize=10</em>, <em>figsize=(10</em>, <em>3)</em>, <em>imageB_intensity_offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.compare_images_line_profile_two_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two line profiles on two images separately with the line
profile intensities in a subfigure.
See skimage PR PinkShnack for details on implementing profile_line
in skimage: <a class="reference external" href="https://github.com/scikit-image/scikit-image/pull/4206">https://github.com/scikit-image/scikit-image/pull/4206</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imageB</strong> (<em>imageA</em><em>,</em>) – </li>
<li><strong>line_profile_positions</strong> (<em>list of lists</em>) – one line profile coordinate. Use atomap’s am.add_atoms_with_gui()
function to get these. The two dots will trace the line profile.
See Examples below for example.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default None</em>) – If this is set to a name (string), the image will be saved with that
name.</li>
<li><strong>reduce_func</strong> (<em>ufunc</em><em>, </em><em>default np.mean</em>) – See skimage’s <cite>profile_line</cite> reduce_func parameter for details.</li>
<li><strong>linewidth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 1</em>) – see profile_line for parameter details.</li>
<li><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 'auto'</em>) – if set to ‘auto’ the function will attempt to find the sampling of
image from image.axes_manager[0].scale.</li>
<li><strong>units</strong> (<em>string</em><em>, </em><em>default 'nm'</em>) – </li>
<li><strong>crop_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – number of pixels away from the <cite>line_profile_positions</cite> coordinates the
image crop will be taken.</li>
<li><strong>title</strong> (<em>string</em><em>, </em><em>default &quot;Intensity Profile&quot;</em>) – Title of the plot</li>
<li><strong>marker_B</strong> (<em>marker_A</em><em>,</em>) – </li>
<li><strong>arrow_markersize</strong> (<em>Matplotlib markersize</em>) – </li>
<li><strong>figsize</strong> (<em>see Matplotlib for details</em>) – </li>
<li><strong>imageB_intensity_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>default 0</em>) – Adds a y axis offset for comparison purposes.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">(</span><span class="n">image_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># line_profile_positions = tml.choose_points_on_image(imageA)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">81.58</span><span class="p">,</span> <span class="mf">69.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">193.10</span><span class="p">,</span> <span class="mf">184.08</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>To use the new skimage functionality try the <cite>reduce_func</cite> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span> <span class="c1"># can be any ufunc!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reduce_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="n">reduce_func</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">crop_offset</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Offseting the y axis of the second image can sometimes be useful:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">imageA</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imageB</span> <span class="o">=</span> <span class="n">imageA</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line_profile_positions</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">301.42</span><span class="p">,</span> <span class="mf">318.9</span><span class="p">],</span> <span class="p">[</span><span class="mf">535.92</span><span class="p">,</span> <span class="mf">500.82</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tml</span><span class="o">.</span><span class="n">compare_images_line_profile_two_images</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">imageA</span><span class="p">,</span> <span class="n">imageB</span><span class="p">,</span> <span class="n">line_profile_positions</span><span class="p">,</span> <span class="n">reduce_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">imageB_intensity_offset</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.expand_palette">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">expand_palette</code><span class="sig-paren">(</span><em>palette</em>, <em>expand_list</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.expand_palette" title="Permalink to this definition">¶</a></dt>
<dd><p>Essentially multiply the palette so that it has the number of instances of
each color that you want.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>palette</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Color palette in hex, rgb or dec</li>
<li><strong>expand_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of integers that will be used to duplicate colours in the palette.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List of expanded palette</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_palette</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">expand_palette</span><span class="p">(</span><span class="n">zest</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.get_cropping_area">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">get_cropping_area</code><span class="sig-paren">(</span><em>line_profile_positions</em>, <em>crop_offset=20</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.get_cropping_area" title="Permalink to this definition">¶</a></dt>
<dd><p>By inputting the top-left and bottom-right coordinates of a rectangle, this
function will add a border buffer (<cite>crop_offset</cite>) which can be used for
cropping of regions in a plot.
See <cite>compare_images_line_profile_two_images</cite> for use-case</p>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.hex_to_rgb">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">hex_to_rgb</code><span class="sig-paren">(</span><em>hex_values</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.hex_to_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Change from hexidecimal color values to rgb color values.
Grabs starting two, middle two, last two values in hex, multiplies by
16^1 and 16^0 for the first and second, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – A list of hexidecimal color values as strings e.g., ‘#F5793A’</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of tuples</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.signal_plotting</span> <span class="k">as</span> <span class="nn">tmlplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="go">[(245, 121, 58), (169, 90, 161), (133, 192, 249), (15, 32, 128)]</span>
</pre></div>
</div>
<p>Create a matplotlib cmap from a palette with the help of
matplotlib.colors.from_levels_and_colors()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">from_levels_and_colors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span> <span class="o">=</span> <span class="n">tmlplot</span><span class="o">.</span><span class="n">hex_to_rgb</span><span class="p">(</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">color_palettes</span><span class="p">(</span><span class="s1">&#39;zesty&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># make the top and bottom colour the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">from_levels_and_colors</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="n">tmlplot</span><span class="o">.</span><span class="n">rgb_to_dec</span><span class="p">(</span><span class="n">zest</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.plot_atom_energies">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">plot_atom_energies</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>image=None</em>, <em>vac_or_implants=None</em>, <em>elements_dict_other=None</em>, <em>filename='energy_map'</em>, <em>cmap='plasma'</em>, <em>levels=20</em>, <em>colorbar_fontsize=16</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.plot_atom_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to plot the energies of atomic column configurations above 0 as
calculated by DFT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattices</em>) – </li>
<li><strong>image</strong> (<em>array-like</em><em>, </em><em>default None</em>) – The first sublattice image is used if <cite>image=None</cite>.</li>
<li><strong>vac_or_implants</strong> (<em>string</em><em>, </em><em>default None</em>) – <cite>vac_or_implants</cite> options are “implants” and “vac”.</li>
<li><strong>elements_dict_other</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>default None</em>) – A dictionary of {element_config1: energy1, element_config2: energy2, }
The default is Se antisites in monolayer MoS2.</li>
<li><strong>filename</strong> (<em>string</em><em>, </em><em>default &quot;energy_map&quot;</em>) – Name with which to save the plot.</li>
<li><strong>cmap</strong> (<em>Matplotlib colormap</em><em>, </em><em>default &quot;plasma&quot;</em>) – </li>
<li><strong>levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 20</em>) – Number of Matplotlib contour map levels.</li>
<li><strong>colorbar_fontsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 16</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>The x and y coordinates of the atom positions and the</em></li>
<li><em>atom energy.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.signal_plotting.rgb_to_dec">
<code class="descclassname">temul.signal_plotting.</code><code class="descname">rgb_to_dec</code><span class="sig-paren">(</span><em>rgb_values</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.signal_plotting.rgb_to_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Change RGB color values to decimal color values (between 0 and 1).
Required for use with matplotlib. See Example in <cite>hex_to_rgb</cite> below.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rgb_values</strong> (<em>list of tuples</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Decimal color values (RGB but scaled from 0 to 1 rather than 0 to 255)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.io">
<span id="input-output-io"></span><h3>Input/Output (io)<a class="headerlink" href="#module-temul.io" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.io.batch_convert_emd_to_image">
<code class="descclassname">temul.io.</code><code class="descname">batch_convert_emd_to_image</code><span class="sig-paren">(</span><em>extension_to_save</em>, <em>top_level_directory</em>, <em>glob_search='**/*'</em>, <em>overwrite=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.batch_convert_emd_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert all .emd files to the chosen extension_to_save file format in the
specified directory and all subdirectories.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>extension_to_save</strong> (<em>string</em>) – the image file extension to be used for saving the image.
See Hyperspy documentation for information on file writing extensions
available: <a class="reference external" href="http://hyperspy.org/hyperspy-doc/current/user_guide/io.html">http://hyperspy.org/hyperspy-doc/current/user_guide/io.html</a></li>
<li><strong>top_level_directory</strong> (<em>string</em>) – The top-level directory in which the emd files exist. The default
glob_search will search this directory and all subdirectories.</li>
<li><strong>glob_search</strong> (string, default “<a href="#id5"><span class="problematic" id="id6">**</span></a>/<a href="#id7"><span class="problematic" id="id8">*</span></a>”) – Glob search string, see glob for more details:
<a class="reference external" href="https://docs.python.org/2/library/glob.html">https://docs.python.org/2/library/glob.html</a>
Default will search this directory and all subdirectories.</li>
<li><strong>overwrite</strong> (<em>Bool</em><em>, </em><em>default True</em>) – Overwrite if the extension_to_save file already exists.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.convert_vesta_xyz_to_prismatic_xyz">
<code class="descclassname">temul.io.</code><code class="descname">convert_vesta_xyz_to_prismatic_xyz</code><span class="sig-paren">(</span><em>vesta_xyz_filename, prismatic_xyz_filename, delimiter='   |    |  ', header=None, skiprows=[0, 1], engine='python', occupancy=1.0, rms_thermal_vib=0.05, edge_padding=None, header_comment=&quot;Let's make a file!&quot;, save=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.convert_vesta_xyz_to_prismatic_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from Vesta outputted xyz file format to the prismatic-style xyz
format.
Lose some information from the .cif or .vesta file but okay for now.
Develop your own converter if you need rms and occupancy! Lots to do.</p>
<p>delimiter=’      |       |  ‘ # ase xyz
delimiter=’   |    |  ‘ # vesta xyz</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vesta_xyz_filename</strong> (<em>string</em>) – name of the vesta outputted xyz file. See vesta &gt; export &gt; xyz</li>
<li><strong>prismatic_xyz_filename</strong> (<em>string</em>) – name to be given to the outputted prismatic xyz file</li>
<li><strong>header</strong><strong>, </strong><strong>skiprows</strong><strong>, </strong><strong>engine</strong> (<em>delimiter</em><em>,</em>) – See pandas.read_csv for documentation
Note that the delimiters here are only available if you use
engine=’python’</li>
<li><strong>rms_thermal_vib</strong> (<em>occupancy</em><em>,</em>) – if you want a file format that will retain these atomic attributes,
use a format other than vesta xyz. Maybe .cif or .vesta keeps these?</li>
<li><strong>header_comment</strong> (<em>string</em>) – header comment for the file.</li>
<li><strong>save</strong> (<em>Bool</em><em>, </em><em>default True</em>) – whether to output the file as a prismatic formatted xyz file with the
name of the file given by “prismatic_xyz_filename”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The converted file format as a pandas dataframe</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See example_data for the vesta xyz file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="kn">import</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prismatic_xyz</span> <span class="o">=</span> <span class="n">convert_vesta_xyz_to_prismatic_xyz</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/example_MoS2_vesta_xyz.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s1">&#39;temul/example_data/prismatic/MoS2_hex_prismatic.xyz&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;   |    |  &#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span> <span class="n">occupancy</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">rms_thermal_vib</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">header_comment</span><span class="o">=</span><span class="s2">&quot;Let&#39;s do this!&quot;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.create_dataframe_for_xyz">
<code class="descclassname">temul.io.</code><code class="descname">create_dataframe_for_xyz</code><span class="sig-paren">(</span><em>sublattice_list</em>, <em>element_list</em>, <em>x_size</em>, <em>y_size</em>, <em>z_size</em>, <em>filename</em>, <em>header_comment='top_level_comment'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.create_dataframe_for_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Pandas Dataframe and a .xyz file (usable with Prismatic) from the
inputted sublattice(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublattice_list</strong> (<em>list of Atomap Sublattice objects</em>) – </li>
<li><strong>element_list</strong> (<em>list of strings</em>) – Each string must be an element symbol from the periodic table.</li>
<li><strong>y_size</strong><strong>, </strong><strong>z_size</strong> (<em>x_size</em><em>,</em>) – Dimensions of the x,y,z axes in Angstrom.</li>
<li><strong>filename</strong> (<em>string</em>) – Name with which the .xyz file will be saved.</li>
<li><strong>header_comment</strong> (<em>string</em><em>, </em><em>default 'top_level_comment'</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.external.atomap_devel_012.dummy_data</span> <span class="k">as</span> <span class="nn">dummy_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="s1">&#39;Mo_1&#39;</span>
<span class="gp">... </span>    <span class="n">sublattice</span><span class="o">.</span><span class="n">atom_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z_height</span> <span class="o">=</span> <span class="s1">&#39;0.5&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">element_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mo_0&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mo_2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_size</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataframe</span> <span class="o">=</span> <span class="n">create_dataframe_for_xyz</span><span class="p">([</span><span class="n">sublattice</span><span class="p">],</span> <span class="n">element_list</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">x_size</span><span class="p">,</span> <span class="n">y_size</span><span class="p">,</span> <span class="n">z_size</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;dataframe&#39;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">header_comment</span><span class="o">=</span><span class="s1">&#39;Here is an Example&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.dm3_stack_to_tiff_stack">
<code class="descclassname">temul.io.</code><code class="descname">dm3_stack_to_tiff_stack</code><span class="sig-paren">(</span><em>loading_file</em>, <em>loading_file_extension='.dm3'</em>, <em>saving_file_extension='.tif'</em>, <em>crop=False</em>, <em>crop_start=20.0</em>, <em>crop_end=80.0</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.dm3_stack_to_tiff_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an image stack filetype to a different filetype, e.g., dm3 to tiff.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>string</em>) – Name of the image stack file</li>
<li><strong>loading_file_extension</strong> (<em>string</em>) – file extension of the filename</li>
<li><strong>saving_file_extension</strong> (<em>string</em>) – file extension you wish to save as</li>
<li><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – if True, the image will be cropped in the navigation space,
defined by the frames given in crop_start and crop_end</li>
<li><strong>crop_end</strong> (<em>crop_start</em><em>,</em>) – the start and end frame of the crop</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.load_data_and_sampling">
<code class="descclassname">temul.io.</code><code class="descname">load_data_and_sampling</code><span class="sig-paren">(</span><em>filename</em>, <em>file_extension=None</em>, <em>invert_image=False</em>, <em>save_image=True</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_data_and_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.io.load_prismatic_mrc_with_hyperspy">
<code class="descclassname">temul.io.</code><code class="descname">load_prismatic_mrc_with_hyperspy</code><span class="sig-paren">(</span><em>prismatic_mrc_filename</em>, <em>save_name='calibrated_data_'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.load_prismatic_mrc_with_hyperspy" title="Permalink to this definition">¶</a></dt>
<dd><p>We are aware this is currently producing errors with new versions of
Prismatic.</p>
<p>Open a prismatic .mrc file and save as a hyperspy object.
Also plots saves a png.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prismatic_mrc_filename</strong> (<em>string</em>) – name of the outputted prismatic .mrc file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Hyperspy Signal 2D</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.io</span> <span class="kn">import</span> <span class="n">load_prismatic_mrc_with_hyperspy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">load_prismatic_mrc_with_hyperspy</span><span class="p">(</span><span class="s2">&quot;temul/example_data/prismatic/&quot;</span>
<span class="gp">... </span>        <span class="s2">&quot;prism_2Doutput_prismatic_simulation.mrc&quot;</span><span class="p">)</span>
<span class="go">&lt;Signal2D, title: , dimensions: (|1182, 773)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.io.save_individual_images_from_image_stack">
<code class="descclassname">temul.io.</code><code class="descname">save_individual_images_from_image_stack</code><span class="sig-paren">(</span><em>image_stack</em>, <em>output_folder='individual_images'</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.save_individual_images_from_image_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Save each image in an image stack. The images are saved in a new folder.
Useful for after running an image series through Rigid Registration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>image_stack</strong> (<em>rigid registration image stack object</em>) – </li>
<li><strong>output_folder</strong> (<em>string</em>) – Name of the folder in which all individual images from
the stack will be saved.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="temul.io.write_cif_from_dataframe">
<code class="descclassname">temul.io.</code><code class="descname">write_cif_from_dataframe</code><span class="sig-paren">(</span><em>dataframe</em>, <em>filename</em>, <em>chemical_name_common</em>, <em>cell_length_a</em>, <em>cell_length_b</em>, <em>cell_length_c</em>, <em>cell_angle_alpha=90</em>, <em>cell_angle_beta=90</em>, <em>cell_angle_gamma=90</em>, <em>space_group_name_H_M_alt='P 1'</em>, <em>space_group_IT_number=1</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.io.write_cif_from_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a cif file from a Pandas Dataframe. This Dataframe can be created
with temul.model_creation.create_dataframe_for_cif().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dataframe</strong> (<em>dataframe object</em>) – pandas dataframe containing rows of atomic position information</li>
<li><strong>chemical_name_common</strong> (<em>string</em>) – name of chemical</li>
<li><strong>_cell_length_b</strong><strong>, </strong><strong>_cell_length_c</strong> (<em>cell_length_a</em><em>,</em>) – lattice dimensions in angstrom</li>
<li><strong>cell_angle_beta</strong><strong>, </strong><strong>cell_angle_gamma</strong> (<em>cell_angle_alpha</em><em>,</em>) – lattice angles in degrees</li>
<li><strong>space_group_name_H-M_alt</strong> (<em>string</em>) – space group name</li>
<li><strong>space_group_IT_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-temul.dummy_data">
<span id="dummy-data"></span><h3>Dummy Data<a class="headerlink" href="#module-temul.dummy_data" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.dummy_data.get_distorted_cubic_signal_adjustable">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_distorted_cubic_signal_adjustable</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>y_offset=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_signal_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a distorted cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</li>
<li><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">HyperSpy Signal2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_signal_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">get_distorted_cubic_signal_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_distorted_cubic_sublattice_adjustable">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_distorted_cubic_sublattice_adjustable</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>y_offset=2</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_distorted_cubic_sublattice_adjustable" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a distorted cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</li>
<li><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>default 2</em>) – The magnitude of distortion of the cubic signal.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_distorted_cubic_sublattice_adjustable</span><span class="p">(</span><span class="n">y_offset</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_polarisation_dummy_dataset">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_polarisation_dummy_dataset</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarisation_dummy_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an Atom Lattice with two sublattices resembling a perovskite film.</p>
<p>Similar to a perovskite oxide thin film, where the B cations
are shifted in the film.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>default False</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>simple_atom_lattice</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Atom_Lattice object</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_polarisation_dummy_dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">get_polarisation_dummy_dataset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeB</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">za0</span><span class="p">,</span> <span class="n">za1</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">zones_axis_average_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span> <span class="o">=</span> <span class="n">sublatticeA</span><span class="o">.</span><span class="n">get_polarization_from_second_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">za0</span><span class="p">,</span> <span class="n">za1</span><span class="p">,</span> <span class="n">sublatticeB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_p</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vector_list</span> <span class="o">=</span> <span class="n">s_p</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">vector_list</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">vector_list</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>You can they use the plot_polarisation_vectors function to visualise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.polarisation</span> <span class="kn">import</span> <span class="n">plot_polarisation_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_polarisation_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="n">sublatticeA</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">unit_vector</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_style</span><span class="o">=</span><span class="s2">&quot;vector&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor_dpi</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_polarisation_dummy_dataset_bora">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_polarisation_dummy_dataset_bora</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarisation_dummy_dataset_bora" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_polarised_single_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_polarised_single_sublattice</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarised_single_sublattice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_polarised_single_sublattice_rotated">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_polarised_single_sublattice_rotated</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>rotation=45</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_polarised_single_sublattice_rotated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_signal">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_signal</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test image signal of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</li>
<li><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</li>
<li><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>signal</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">HyperSpy 2D</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">dummy_data</span><span class="o">.</span><span class="n">get_simple_cubic_signal</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_sublattice</code><span class="sig-paren">(</span><em>image_noise=False</em>, <em>amplitude=1</em>, <em>with_vacancies=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a test sublattice of a simple cubic atomic structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image_noise</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, will add Gaussian noise to the image.</li>
<li><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>list of ints</em><em>, </em><em>default 1</em>) – If amplitude is set to an int, that int will be applied to all atoms in
the sublattice.
If amplitude is set to a list, the atoms will be a distribution set by
np.random.randint between the min and max int.</li>
<li><strong>with_vacancies</strong> (<em>Bool</em><em>, </em><em>default False</em>) – If set to True, the returned signal or sublattice will have some
vacancies.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Atomap Sublattice object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">get_simple_cubic_sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>If you want different atom amplitudes, use <cite>amplitude</cite></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>Do not set <cite>amplitude</cite> to two consecutive numbers, as only amplitudes of
the lower number (2 below) will be set, see numpy.random.randint for info.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice</span> <span class="o">=</span> <span class="n">get_simple_cubic_sublattice</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">amplitude</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac">
<code class="descclassname">temul.dummy_data.</code><code class="descname">get_simple_cubic_sublattice_positions_on_vac</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.get_simple_cubic_sublattice_positions_on_vac" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a simple cubic structure similar to <cite>get_simple_cubic_sublattice</cite>
above but the atom positions are also overlaid on the vacancy positions.</p>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.make_polarised_sublattice_bora_return">
<code class="descclassname">temul.dummy_data.</code><code class="descname">make_polarised_sublattice_bora_return</code><span class="sig-paren">(</span><em>image_noise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.make_polarised_sublattice_bora_return" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="temul.dummy_data.polarisation_colorwheel_test_dataset">
<code class="descclassname">temul.dummy_data.</code><code class="descname">polarisation_colorwheel_test_dataset</code><span class="sig-paren">(</span><em>cmap=&lt;matplotlib.colors.LinearSegmentedColormap object&gt;</em>, <em>plot_XY=True</em>, <em>degrees=False</em>, <em>normalise=False</em><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.polarisation_colorwheel_test_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Check how the arrows will be plotted on a colorwheel.
Note that for STEM images, the y axis is reversed. This is taken into
account in the plot_polarisation_vectors function, but not here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image_noise</strong> (<em>default False</em>) – If True, will add Gaussian noise to the image.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">temul.dummy_data</span> <span class="kn">import</span> <span class="n">polarisation_colorwheel_test_dataset</span>
</pre></div>
</div>
<p>Use a cyclic colormap for better understanding of vectors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more cyclic colormap options (and better colormaps), use colorcet</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">colorcet</span> <span class="k">as</span> <span class="nn">cc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">colorwheel</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot with degrees rather than the default radians</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the top and bottom arrows as “diverging” the middle of the
colormap should be the same as the edges, such as colorcet’s CET_C4.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4</span><span class="p">)</span>
</pre></div>
</div>
<p>To just plot the left and right arrows as “diverging” the halfway points of
the colormap should be the same as the edges, such as colorcet’s CET_C4s.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">polarisation_colorwheel_test_dataset</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">CET_C4s</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.dummy_data.sine_wave_sublattice">
<code class="descclassname">temul.dummy_data.</code><code class="descname">sine_wave_sublattice</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.dummy_data.sine_wave_sublattice" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-temul.example_data">
<span id="example-data"></span><h3>Example Data<a class="headerlink" href="#module-temul.example_data" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="temul.example_data.load_Se_implanted_MoS2_data">
<code class="descclassname">temul.example_data.</code><code class="descname">load_Se_implanted_MoS2_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an ADF image of Se implanted monolayer MoS2.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_Se_implanted_MoS2_simulation">
<code class="descclassname">temul.example_data.</code><code class="descname">load_Se_implanted_MoS2_simulation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_Se_implanted_MoS2_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the simulated image of an MoS2 monolayer</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_Se_implanted_MoS2_simulation</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_example_Au_nanoparticle">
<code class="descclassname">temul.example_data.</code><code class="descname">load_example_Au_nanoparticle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Au_nanoparticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the emd STEM image of an example Au nanoparticle</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Au_nanoparticle</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.load_example_Cu_nanoparticle_sim">
<code class="descclassname">temul.example_data.</code><code class="descname">load_example_Cu_nanoparticle_sim</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.load_example_Cu_nanoparticle_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hspy simulated image of an example Cu nanoparticle</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">load_example_Cu_nanoparticle_sim</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.path_to_example_data_MoS2_hex_prismatic">
<code class="descclassname">temul.example_data.</code><code class="descname">path_to_example_data_MoS2_hex_prismatic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_hex_prismatic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the xyz file for monolayer MoS2</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_xyz_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_hex_prismatic</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="temul.example_data.path_to_example_data_MoS2_vesta_xyz">
<code class="descclassname">temul.example_data.</code><code class="descname">path_to_example_data_MoS2_vesta_xyz</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#temul.example_data.path_to_example_data_MoS2_vesta_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the path of the vesta xyz file for bilayer MoS2</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.example_data</span> <span class="k">as</span> <span class="nn">example_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_vesta_file</span> <span class="o">=</span> <span class="n">example_data</span><span class="o">.</span><span class="n">path_to_example_data_MoS2_vesta_xyz</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="dg_visualiser_tutorial.html" class="btn btn-neutral float-left" title="Interactive Image Filtering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Eoghan O&#39;Connell

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>