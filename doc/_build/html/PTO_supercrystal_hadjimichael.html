

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Calculation of Atom Plane Curvature &mdash; TEMUL Toolkit v0.1.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Analysis of PTO Domain Wall Junction" href="PTO_Junction_moore.html" />
    <link rel="prev" title="Plot Lattice Structure Maps" href="structure_map_tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> TEMUL Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                Version 0.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_temul.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Analysis Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html">Finding Polarisation Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="polarisation_vectors_tutorial.html#plotting-polarisation-and-movement-vectors">Plotting Polarisation and Movement Vectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_map_tutorial.html">Plot Lattice Structure Maps</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Calculation of Atom Plane Curvature</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#import-the-modules-and-load-the-data">Import the Modules and Load the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#set-up-the-parameters">Set up the Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculate-the-curvature-of-atom-planes">Calculate the Curvature of Atom Planes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PTO_Junction_moore.html">Analysis of PTO Domain Wall Junction</a></li>
<li class="toctree-l1"><a class="reference internal" href="masked_fft_tutorial.html">Masked FFT and iFFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="line_profile_tutorial.html">Line Intensity Profile Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="dg_visualiser_tutorial.html">Interactive Image Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_doc.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TEMUL Toolkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Calculation of Atom Plane Curvature</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/PTO_supercrystal_hadjimichael.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="calculation-of-atom-plane-curvature">
<span id="pto-supercrystal-hadjimichael"></span><h1>Calculation of Atom Plane Curvature<a class="headerlink" href="#calculation-of-atom-plane-curvature" title="Permalink to this headline">¶</a></h1>
<p>This tutorial follows the python scripts and jupyter notebooks found in the
“publication_examples/PTO_supercrystal_hadjimichael” folder in the
<a class="reference external" href="https://github.com/PinkShnack/TEMUL">TEMUL repository</a>. The data and scripts
used below can be downloaded from there. You can also interact with the data
without needing any downloads. Just click this button and navigate to that same folder,
where you will find the python scripts and interactive python notebooks:</p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/PinkShnack/TEMUL/master"><img alt="https://mybinder.org/badge_logo.svg" src="https://mybinder.org/badge_logo.svg" /></a>
<p>The <code class="code python docutils literal notranslate"><span class="name"><span class="pre">calculate_atom_plane_curvature</span></span></code> function has been adapted from the
MATLAB script written by Dr. Marios Hadjimichael for the publication
M. Hadjimichael, Y. Li <em>et al</em>, <a class="reference external" href="https://www.nature.com/articles/s41563-020-00864-6">Metal-ferroelectric supercrystals with periodically
curved metallic layers, Nature Materials 2020</a>.
This MATLAB script can also be found in the same folder.</p>
<p>The <code class="code python docutils literal notranslate"><span class="name"><span class="pre">calculate_atom_plane_curvature</span></span></code> function in the
<code class="code python docutils literal notranslate"><span class="name"><span class="pre">temul</span></span><span class="operator"><span class="pre">.</span></span><span class="name"><span class="pre">lattice_structure_tools</span></span></code> module can be used to find the curvature of the
displacement of atoms along an atom plane in a sublattice. Using the default
parameter <code class="code python docutils literal notranslate"><span class="name"><span class="pre">func</span></span><span class="operator"><span class="pre">=</span></span><span class="literal string single"><span class="pre">’strain_grad’</span></span></code>, the function will approximate the
curvature as the strain gradient, as in cases where the first derivative is
negligible. See “Landau and Lifshitz, Theory of Elasticity, Vol 7, pp 47-49, 1981”
for more details. One can use any <code class="code python docutils literal notranslate"><span class="name"><span class="pre">func</span></span></code> input that can be used by
<code class="code python docutils literal notranslate"><span class="name"><span class="pre">scipy</span></span><span class="operator"><span class="pre">.</span></span><span class="name"><span class="pre">optimize</span></span><span class="operator"><span class="pre">.</span></span><span class="name"><span class="pre">curve_fit</span></span></code>.</p>
<div class="section" id="import-the-modules-and-load-the-data">
<h2>Import the Modules and Load the Data<a class="headerlink" href="#import-the-modules-and-load-the-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">temul.api</span> <span class="k">as</span> <span class="nn">tml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">atomap.api</span> <span class="k">as</span> <span class="nn">am</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hyperspy.api</span> <span class="k">as</span> <span class="nn">hs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path_to_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
<span class="gp">... </span>            <span class="s2">&quot;publication_examples/PTO_supercrystal_hadjimichael/data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path_to_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Open the PTO/SRO dataset</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hs</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;Cropped_PTO-SRO_Aligned.hspy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span> <span class="c1">#  nm/pix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">units</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">axes_manager</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Cropped_PTO-SRO_Aligned.png"><img alt="_images/Cropped_PTO-SRO_Aligned.png" src="_images/Cropped_PTO-SRO_Aligned.png" style="width: 631.05px; height: 198.79999999999998px;" /></a>
<p>Open the pre-made PTO-SRO atom lattice.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span> <span class="o">=</span> <span class="n">am</span><span class="o">.</span><span class="n">load_atom_lattice_from_hdf5</span><span class="p">(</span><span class="s2">&quot;Atom_Lattice_crop.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice1</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#  Pb-Sr Sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice2</span> <span class="o">=</span> <span class="n">atom_lattice</span><span class="o">.</span><span class="n">sublattice_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#  Ti-Ru Sublattice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_lattice</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Atom_Lattice_crop.png"><img alt="_images/Atom_Lattice_crop.png" src="_images/Atom_Lattice_crop.png" style="width: 654.0px; height: 182.0px;" /></a>
</div>
<div class="section" id="set-up-the-parameters">
<h2>Set up the Parameters<a class="headerlink" href="#set-up-the-parameters" title="Permalink to this headline">¶</a></h2>
<p>Plot the sublattice planes to see which <code class="code python docutils literal notranslate"><span class="name"><span class="pre">zone_vector_index</span></span></code> we use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublattice2</span><span class="o">.</span><span class="n">construct_zone_axes</span><span class="p">(</span><span class="n">atom_plane_tolerance</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># sublattice2.plot_planes()</span>
</pre></div>
</div>
<p>Set up parameters for <code class="code python docutils literal notranslate"><span class="name"><span class="pre">calculate_atom_plane_curvature</span></span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zone_vector_index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom_planes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="c1">#  chooses the starting and ending atom planes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;bwr&#39;</span> <span class="c1">#  see matplotlib and colorcet for more colormaps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Curvature Map&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1">#  Set to a string if you want to save the map</span>
</pre></div>
</div>
<p>Set the extra initial fitting parameters</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">173</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;p0&#39;</span><span class="p">:</span> <span class="n">p0</span><span class="p">,</span> <span class="s1">&#39;maxfev&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-curvature-of-atom-planes">
<h2>Calculate the Curvature of Atom Planes<a class="headerlink" href="#calculate-the-curvature-of-atom-planes" title="Permalink to this headline">¶</a></h2>
<p>We want to see the curvature in the SRO Sublattice</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">curvature_map</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">calculate_atom_plane_curvature</span><span class="p">(</span><span class="n">sublattice2</span><span class="p">,</span> <span class="n">zone_vector_index</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">atom_planes</span><span class="o">=</span><span class="n">atom_planes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/Curvature_Map_Example.png"><img alt="_images/Curvature_Map_Example.png" src="_images/Curvature_Map_Example.png" style="width: 619.2px; height: 153.0px;" /></a>
<p>When using <code class="code python docutils literal notranslate"><span class="name"><span class="pre">plot_and_return_fits</span></span><span class="operator"><span class="pre">=</span></span><span class="keyword constant"><span class="pre">True</span></span></code>, the function will return the curve
fittings, and plot each plane (plots not displayed).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">curvature_map</span><span class="p">,</span> <span class="n">fittings</span> <span class="o">=</span> <span class="n">tml</span><span class="o">.</span><span class="n">calculate_atom_plane_curvature</span><span class="p">(</span><span class="n">sublattice2</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">zone_vector_index</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">atom_planes</span><span class="o">=</span><span class="n">atom_planes</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">plot_and_return_fits</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="PTO_Junction_moore.html" class="btn btn-neutral float-right" title="Analysis of PTO Domain Wall Junction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="structure_map_tutorial.html" class="btn btn-neutral float-left" title="Plot Lattice Structure Maps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Eoghan O&#39;Connell.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>